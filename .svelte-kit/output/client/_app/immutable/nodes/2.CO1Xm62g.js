import{b as ca,d as Oa,f as F,a as A,c as gt}from"../chunks/Dj8On0Xh.js";import"../chunks/Bnc7oL5D.js";import{F as Ht,i as at,x as Dt,C as jt,j as Vt,M as Ha,g as n,aI as Je,aA as Ua,O as Wa,a5 as da,aj as Nt,B as St,N as Sa,ao as ja,a2 as va,ax as Ct,P as Jt,az as Na,am as na,w as Ia,I as ua,at as N,aO as Ya,aP as Xa,aQ as Ga,aR as ht,ay as za,R as Ra,aS as Yt,ah as Ba,aT as Qa,al as Va,a3 as Ja,aU as Ea,L as Pa,aV as Za,t as J,A as Ka,aW as $a,ap as en,ai as tn,aX as an,aY as nn,aZ as on,a_ as rn,a$ as ln,b0 as sn,av as cn,b as m,J as dn,b1 as vn,p as Me,n as De,s as u,k as f,l as g,aq as z,b2 as Ne,b3 as pt,e as Le,a4 as _t,m as je,b4 as ga,b5 as La}from"../chunks/c1y374w_.js";import{p as h,b as ft,i as $,s as it,a as Rt,_ as un}from"../chunks/DZfZzOi_.js";import{i as Te}from"../chunks/CBwOI1Gw.js";import{e as p,s as Ue}from"../chunks/8R3vFiuv.js";import{c as gn,o as Bt,d as ia,w as bt,a as oa}from"../chunks/pj8eKBGp.js";function dt(i,a){return a}function hn(i,a,e){for(var t=[],o=a.length,r,d=a.length,c=0;c<o;c++){let k=a[c];Ra(k,()=>{if(r){if(r.pending.delete(k),r.done.add(k),r.pending.size===0){var S=i.outrogroups;Zt(na(r.done)),S.delete(r),S.size===0&&(i.outrogroups=null)}}else d-=1},!1)}if(d===0){var s=t.length===0&&e!==null;if(s){var v=e,b=v.parentNode;Va(b),b.append(v),i.items.clear()}Zt(a,!s)}else r={pending:new Set(a),done:new Set},(i.outrogroups??=new Set).add(r)}function Zt(i,a=!0){for(var e=0;e<i.length;e++)Ja(i[e],a)}var ha;function vt(i,a,e,t,o,r=null){var d=i,c=new Map,s=(a&Ea)!==0;if(s){var v=i;d=at?Ht(Dt(v)):v.appendChild(jt())}at&&Vt();var b=null,k=Je(()=>{var w=e();return Ia(w)?w:w==null?[]:na(w)}),S,x=!0;function y(){l.fallback=b,fn(l,S,d,a,t),b!==null&&(S.length===0?(b.f&ht)===0?za(b):(b.f^=ht,Tt(b,null,d)):Ra(b,()=>{b=null}))}var R=Ha(()=>{S=n(k);var w=S.length;let M=!1;if(at){var E=Ua(d)===Wa;E!==(w===0)&&(d=da(),Ht(d),Nt(!1),M=!0)}for(var L=new Set,T=Ct,I=Na(),C=0;C<w;C+=1){at&&St.nodeType===Sa&&St.data===ja&&(d=St,M=!0,Nt(!1));var P=S[C],U=t(P,C),Y=x?null:c.get(U);Y?(Y.v&&va(Y.v,P),Y.i&&va(Y.i,C),I&&T.skipped_effects.delete(Y.e)):(Y=bn(c,x?d:ha??=jt(),P,U,C,o,a,e),x||(Y.e.f|=ht),c.set(U,Y)),L.add(U)}if(w===0&&r&&!b&&(x?b=Jt(()=>r(d)):(b=Jt(()=>r(ha??=jt())),b.f|=ht)),at&&w>0&&Ht(da()),!x)if(I){for(const[ee,me]of c)L.has(ee)||T.skipped_effects.add(me.e);T.oncommit(y),T.ondiscard(()=>{})}else y();M&&Nt(!0),n(k)}),l={effect:R,items:c,outrogroups:null,fallback:b};x=!1,at&&(d=St)}function Pt(i){for(;i!==null&&(i.f&Qa)===0;)i=i.next;return i}function fn(i,a,e,t,o){var r=(t&Za)!==0,d=a.length,c=i.items,s=Pt(i.effect.first),v,b=null,k,S=[],x=[],y,R,l,w;if(r)for(w=0;w<d;w+=1)y=a[w],R=o(y,w),l=c.get(R).e,(l.f&ht)===0&&(l.nodes?.a?.measure(),(k??=new Set).add(l));for(w=0;w<d;w+=1){if(y=a[w],R=o(y,w),l=c.get(R).e,i.outrogroups!==null)for(const Y of i.outrogroups)Y.pending.delete(l),Y.done.delete(l);if((l.f&ht)!==0)if(l.f^=ht,l===s)Tt(l,null,e);else{var M=b?b.next:s;l===i.effect.last&&(i.effect.last=l.prev),l.prev&&(l.prev.next=l.next),l.next&&(l.next.prev=l.prev),xt(i,b,l),xt(i,l,M),Tt(l,M,e),b=l,S=[],x=[],s=Pt(b.next);continue}if((l.f&Yt)!==0&&(za(l),r&&(l.nodes?.a?.unfix(),(k??=new Set).delete(l))),l!==s){if(v!==void 0&&v.has(l)){if(S.length<x.length){var E=x[0],L;b=E.prev;var T=S[0],I=S[S.length-1];for(L=0;L<S.length;L+=1)Tt(S[L],E,e);for(L=0;L<x.length;L+=1)v.delete(x[L]);xt(i,T.prev,I.next),xt(i,b,T),xt(i,I,E),s=E,b=I,w-=1,S=[],x=[]}else v.delete(l),Tt(l,s,e),xt(i,l.prev,l.next),xt(i,l,b===null?i.effect.first:b.next),xt(i,b,l),b=l;continue}for(S=[],x=[];s!==null&&s!==l;)(v??=new Set).add(s),x.push(s),s=Pt(s.next);if(s===null)continue}(l.f&ht)===0&&S.push(l),b=l,s=Pt(l.next)}if(i.outrogroups!==null){for(const Y of i.outrogroups)Y.pending.size===0&&(Zt(na(Y.done)),i.outrogroups?.delete(Y));i.outrogroups.size===0&&(i.outrogroups=null)}if(s!==null||v!==void 0){var C=[];if(v!==void 0)for(l of v)(l.f&Yt)===0&&C.push(l);for(;s!==null;)(s.f&Yt)===0&&s!==i.fallback&&C.push(s),s=Pt(s.next);var P=C.length;if(P>0){var U=(t&Ea)!==0&&d===0?e:null;if(r){for(w=0;w<P;w+=1)C[w].nodes?.a?.measure();for(w=0;w<P;w+=1)C[w].nodes?.a?.fix()}hn(i,C,U)}}r&&Pa(()=>{if(k!==void 0)for(l of k)l.nodes?.a?.apply()})}function bn(i,a,e,t,o,r,d,c){var s=(d&Xa)!==0?(d&Ga)===0?N(e,!1,!1):ua(e):null,v=(d&Ya)!==0?ua(o):null;return{v:s,i:v,e:Jt(()=>(r(a,s??e,v??o,c),()=>{i.delete(t)}))}}function Tt(i,a,e){if(i.nodes)for(var t=i.nodes.start,o=i.nodes.end,r=a&&(a.f&ht)===0?a.nodes.start:e;t!==null;){var d=Ba(t);if(r.before(t),t===o)return;t=d}}function xt(i,a,e){a===null?i.effect.first=e:a.next=e,e===null?i.effect.last=a:e.prev=a}function fa(i,a,e=!1,t=!1,o=!1){var r=i,d="";J(()=>{var c=Ka;if(d===(d=a()??"")){at&&Vt();return}if(c.nodes!==null&&($a(c.nodes.start,c.nodes.end),c.nodes=null),d!==""){if(at){St.data;for(var s=Vt(),v=s;s!==null&&(s.nodeType!==Sa||s.data!=="");)v=s,s=Ba(s);if(s===null)throw en(),tn;ca(St,v),r=Ht(s);return}var b=d+"";e?b=`<svg>${b}</svg>`:t&&(b=`<math>${b}</math>`);var k=Oa(b);if((e||t)&&(k=Dt(k)),ca(Dt(k),k.lastChild),e||t)for(;Dt(k);)r.before(Dt(k));else r.before(k)}})}const ba=[...` 	
\r\fÂ \v\uFEFF`];function mn(i,a,e){var t=i==null?"":""+i;if(e){for(var o in e)if(e[o])t=t?t+" "+o:o;else if(t.length)for(var r=o.length,d=0;(d=t.indexOf(o,d))>=0;){var c=d+r;(d===0||ba.includes(t[d-1]))&&(c===t.length||ba.includes(t[c]))?t=(d===0?"":t.substring(0,d))+t.substring(c+1):d=c}}return t===""?null:t}function pn(i,a){return i==null?null:String(i)}function ue(i,a,e,t,o,r){var d=i.__className;if(at||d!==e||d===void 0){var c=mn(e,t,r);(!at||c!==i.getAttribute("class"))&&(c==null?i.removeAttribute("class"):i.className=c),i.__className=e}else if(r&&o!==r)for(var s in r){var v=!!r[s];(o==null||v!==!!o[s])&&i.classList.toggle(s,v)}return r}function we(i,a,e,t){var o=i.__style;if(at||o!==a){var r=pn(a);(!at||r!==i.getAttribute("style"))&&(r==null?i.removeAttribute("style"):i.style.cssText=r),i.__style=a}return t}const wn=Symbol("is custom element"),xn=Symbol("is html");function Ft(i){if(at){var a=!1,e=()=>{if(!a){if(a=!0,i.hasAttribute("value")){var t=i.value;_e(i,"value",null),i.value=t}if(i.hasAttribute("checked")){var o=i.checked;_e(i,"checked",null),i.checked=o}}};i.__on_r=e,Pa(e),ln()}}function qt(i,a){var e=ra(i);e.value===(e.value=a??void 0)||i.value===a&&(a!==0||i.nodeName!=="PROGRESS")||(i.value=a??"")}function _n(i,a){var e=ra(i);e.checked!==(e.checked=a??void 0)&&(i.checked=a)}function _e(i,a,e,t){var o=ra(i);at&&(o[a]=i.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&i.nodeName==="LINK")||o[a]!==(o[a]=e)&&(a==="loading"&&(i[an]=e),e==null?i.removeAttribute(a):typeof e!="string"&&yn(i).includes(a)?i[a]=e:i.setAttribute(a,e))}function ra(i){return i.__attributes??={[wn]:i.nodeName.includes("-"),[xn]:i.namespaceURI===nn}}var ma=new Map;function yn(i){var a=i.getAttribute("is")||i.nodeName,e=ma.get(a);if(e)return e;ma.set(a,e=[]);for(var t,o=i,r=Element.prototype;r!==o;){t=rn(o);for(var d in t)t[d].set&&e.push(d);o=on(o)}return e}function kn(i,a,e=a){var t=new WeakSet;sn(i,"input",async o=>{var r=o?i.defaultValue:i.value;if(r=Xt(i)?Gt(r):r,e(r),Ct!==null&&t.add(Ct),await cn(),r!==(r=a())){var d=i.selectionStart,c=i.selectionEnd,s=i.value.length;if(i.value=r??"",c!==null){var v=i.value.length;d===c&&c===s&&v>s?(i.selectionStart=v,i.selectionEnd=v):(i.selectionStart=d,i.selectionEnd=Math.min(c,v))}}}),(at&&i.defaultValue!==i.value||m(a)==null&&i.value)&&(e(Xt(i)?Gt(i.value):i.value),Ct!==null&&t.add(Ct)),dn(()=>{var o=a();if(i===document.activeElement){var r=vn??Ct;if(t.has(r))return}Xt(i)&&o===Gt(i.value)||i.type==="date"&&!o&&!i.value||o!==i.value&&(i.value=o??"")})}function Xt(i){var a=i.type;return a==="number"||a==="range"}function Gt(i){return i===""?null:+i}function st(i){return function(...a){var e=a[0];return e.stopPropagation(),i?.apply(this,a)}}function Kt(i,a){var e=i.$$events?.[a.type],t=Ia(e)?e.slice():e==null?[]:[e];for(var o of t)o.call(this,a)}var Cn=F('<header class="header svelte-hv3zzy"><img src="/logos/logo-picflam-logotype.png" alt="PicFlam" class="header-logo svelte-hv3zzy"/> <nav class="header-nav svelte-hv3zzy"><button aria-label="Crop tab"><img src="/icons/icon-crop.svg" alt="" class="nav-icon svelte-hv3zzy"/></button> <button aria-label="AI tab"><img src="/icons/icon-ai.svg" alt="" class="nav-icon svelte-hv3zzy"/></button> <button aria-label="Design tab"><img src="/icons/icon-design.svg" alt="" class="nav-icon svelte-hv3zzy"/></button></nav></header>');function Sn(i,a){Me(a,!1);let e=h(a,"activeTab",8,"crop"),t=h(a,"onTabChange",8);Te();var o=Cn(),r=u(f(o),2),d=f(r);let c;var s=u(d,2);let v;var b=u(s,2);let k;g(r),g(o),J(()=>{c=ue(d,1,"nav-btn svelte-hv3zzy",null,c,{active:e()==="crop"}),v=ue(s,1,"nav-btn svelte-hv3zzy",null,v,{active:e()==="ai"}),k=ue(b,1,"nav-btn svelte-hv3zzy",null,k,{active:e()==="design"})}),p("click",d,()=>t()("crop")),p("click",s,()=>t()("ai")),p("click",b,()=>t()("design")),A(i,o),De()}function Ma(i){return new Promise((a,e)=>{const t=new FileReader;t.onload=o=>a(o.target.result),t.onerror=e,t.readAsDataURL(i)})}function mt(i){return new Promise((a,e)=>{const t=new Image;t.onload=()=>a(t),t.onerror=e,t.src=i})}async function Ut(i){const a=await mt(i);return{width:a.naturalWidth,height:a.naturalHeight}}function pa(i,a=2048){return new Promise(async e=>{const t=await mt(i),{naturalWidth:o,naturalHeight:r}=t;if(o<=a&&r<=a){e(i);return}const d=document.createElement("canvas"),c=d.getContext("2d");let s,v;o>r?(s=a,v=r/o*a):(v=a,s=o/r*a),d.width=s,d.height=v,c.drawImage(t,0,0,s,v),e(d.toDataURL("image/jpeg",.92))})}async function In(){try{const i=await navigator.clipboard.read();for(const a of i)for(const e of a.types)if(e.startsWith("image/")){const t=await a.getType(e);return await Ma(t)}return null}catch(i){return console.error("Failed to paste from clipboard:",i),null}}async function $t(i){try{const e=await(await fetch(i)).blob();return await navigator.clipboard.write([new ClipboardItem({[e.type]:e})]),!0}catch(a){return console.error("Failed to copy to clipboard:",a),!1}}function ea(i,a="picflam-export.png"){const e=document.createElement("a");e.href=i,e.download=a,document.body.appendChild(e),e.click(),document.body.removeChild(e)}async function Da(i,a,e,t){const o=await mt(i),r=document.createElement("canvas"),d=r.getContext("2d"),c=a.x/100*e,s=a.y/100*t,v=a.width/100*e,b=a.height/100*t;return r.width=v,r.height=b,d.drawImage(o,c,s,v,b,0,0,v,b),r.toDataURL("image/png")}async function zn(i,a){const e=await mt(i),t=document.createElement("canvas"),o=t.getContext("2d");return t.width=e.naturalHeight,t.height=e.naturalWidth,o.translate(t.width/2,t.height/2),o.rotate(a*Math.PI/180),o.drawImage(e,-e.naturalWidth/2,-e.naturalHeight/2),t.toDataURL("image/png")}async function Rn(i,a){const e=await mt(i),t=document.createElement("canvas"),o=t.getContext("2d");return t.width=e.naturalWidth,t.height=e.naturalHeight,o.translate(t.width,0),o.scale(-1,1),o.drawImage(e,0,0),t.toDataURL("image/png")}async function Bn(i,a,e){const t=await mt(i),o=document.createElement("canvas"),r=o.getContext("2d");if(o.width=t.naturalWidth,o.height=t.naturalHeight,a&&a!=="none"&&(r.filter=a),r.drawImage(t,0,0),r.filter="none",e&&Array.isArray(e)&&e.length>0)if(e.some(c=>c.invert)){const s=.5+e.reduce((l,w)=>l+(w.strength||50),0)/e.length/100*9.5,v=document.createElement("canvas");v.width=o.width,v.height=o.height;const b=v.getContext("2d");b.filter=`blur(${s}px)`,a&&a!=="none"&&(b.filter=`blur(${s}px) ${a}`),b.drawImage(t,0,0);const k=document.createElement("canvas");k.width=o.width,k.height=o.height;const S=k.getContext("2d");S.fillStyle="white",S.fillRect(0,0,k.width,k.height);for(const l of e){if(!l.invert)continue;const w=(l.soften||50)/100,M=S.createRadialGradient(l.x,l.y,0,l.x,l.y,l.radius);M.addColorStop(0,"rgba(0,0,0,1)"),M.addColorStop(.5+w*.3,"rgba(0,0,0,0.5)"),M.addColorStop(1,"rgba(0,0,0,0)"),S.fillStyle=M,S.beginPath(),S.arc(l.x,l.y,l.radius,0,Math.PI*2),S.fill()}const x=r.getImageData(0,0,o.width,o.height),y=b.getImageData(0,0,o.width,o.height),R=S.getImageData(0,0,o.width,o.height);for(let l=0;l<x.data.length;l+=4){const w=R.data[l]/255;x.data[l]=x.data[l]*w+y.data[l]*(1-w),x.data[l+1]=x.data[l+1]*w+y.data[l+1]*(1-w),x.data[l+2]=x.data[l+2]*w+y.data[l+2]*(1-w)}r.putImageData(x,0,0)}else for(const c of e){const s=c.strength||50,v=(c.soften||50)/100,b=.5+s/100*9.5,k=document.createElement("canvas");k.width=o.width,k.height=o.height;const S=k.getContext("2d");S.filter=`blur(${b}px)`,a&&a!=="none"&&(S.filter=`blur(${b}px) ${a}`),S.drawImage(t,0,0);const x=document.createElement("canvas");x.width=o.width,x.height=o.height;const y=x.getContext("2d"),R=y.createRadialGradient(c.x,c.y,0,c.x,c.y,c.radius);R.addColorStop(0,"rgba(255,255,255,1)"),R.addColorStop(.5+v*.3,"rgba(255,255,255,0.5)"),R.addColorStop(1,"rgba(255,255,255,0)"),y.fillStyle=R,y.beginPath(),y.arc(c.x,c.y,c.radius,0,Math.PI*2),y.fill();const l=r.getImageData(0,0,o.width,o.height),w=S.getImageData(0,0,o.width,o.height),M=y.getImageData(0,0,o.width,o.height);for(let E=0;E<l.data.length;E+=4){const L=M.data[E]/255;l.data[E]=l.data[E]*(1-L)+w.data[E]*L,l.data[E+1]=l.data[E+1]*(1-L)+w.data[E+1]*L,l.data[E+2]=l.data[E+2]*(1-L)+w.data[E+2]*L}r.putImageData(l,0,0)}return o.toDataURL("image/png")}var En=F('<div role="button" tabindex="0"><p class="import-title svelte-f1bndr"> </p> <img src="/icons/icon-upload.svg" alt="" class="import-icon svelte-f1bndr"/> <p class="import-hint svelte-f1bndr"> </p> <button class="btn-paste svelte-f1bndr">Paste</button> <input type="file" accept="image/*" class="sr-only"/></div>');function Ta(i,a){Me(a,!1);let e=h(a,"title",8,"Import an image"),t=h(a,"hint",8,"Import, drag or paste an image"),o=h(a,"onImageImport",8,I=>{}),r=N(!1),d=N();async function c(I){if(!I||!I.type.startsWith("image/"))return;const C=await Ma(I),P=await pa(C,2048);o()(P)}function s(I){const C=I.target.files?.[0];C&&c(C)}function v(I){I.preventDefault(),z(r,!1);const C=I.dataTransfer?.files?.[0];C&&c(C)}function b(I){I.preventDefault(),z(r,!0)}function k(){z(r,!1)}async function S(){const I=await In();if(I){const C=await pa(I,2048);o()(C)}}function x(){n(d)?.click()}Te();var y=En();let R;var l=f(y),w=f(l,!0);g(l);var M=u(l,4),E=f(M,!0);g(M);var L=u(M,2),T=u(L,2);ft(T,I=>z(d,I),()=>n(d)),g(y),J(()=>{R=ue(y,1,"import-area svelte-f1bndr",null,R,{dragging:n(r)}),Ue(w,e()),Ue(E,t())}),p("click",L,st(S)),p("change",T,s),p("click",y,x),p("drop",y,v),p("dragover",y,b),p("dragleave",y,k),p("keypress",y,I=>I.key==="Enter"&&x()),A(i,y),De()}var Pn=F('<div class="action-bar svelte-96zw02"><div class="action-group svelte-96zw02"><button class="action-btn svelte-96zw02" aria-label="Undo"><img src="/icons/icon-undo.svg" alt="" class="action-icon svelte-96zw02"/></button> <button class="action-btn svelte-96zw02" aria-label="Redo"><img src="/icons/icon-redo.svg" alt="" class="action-icon svelte-96zw02"/></button></div> <div class="action-group svelte-96zw02"><button class="action-btn svelte-96zw02" aria-label="Start again"><img src="/icons/icon-startagain.svg" alt="" class="action-icon svelte-96zw02"/></button> <button class="action-btn svelte-96zw02" aria-label="Copy to clipboard"><img src="/icons/icon-copy.svg" alt="" class="action-icon svelte-96zw02"/></button> <button class="action-btn svelte-96zw02" aria-label="Export"><img src="/icons/icon-export.svg" alt="" class="action-icon svelte-96zw02"/></button></div></div>');function la(i,a){let e=h(a,"canUndo",8,!1),t=h(a,"canRedo",8,!1),o=h(a,"onUndo",8,()=>{}),r=h(a,"onRedo",8,()=>{}),d=h(a,"onStartAgain",8,()=>{}),c=h(a,"onCopy",8,()=>{}),s=h(a,"onExport",8,()=>{});var v=Pn(),b=f(v),k=f(b),S=u(k,2);g(b);var x=u(b,2),y=f(x),R=u(y,2),l=u(R,2);g(x),g(v),J(()=>{k.disabled=!e(),S.disabled=!t()}),p("click",k,function(...w){o()?.apply(this,w)}),p("click",S,function(...w){r()?.apply(this,w)}),p("click",y,function(...w){d()?.apply(this,w)}),p("click",R,function(...w){c()?.apply(this,w)}),p("click",l,function(...w){s()?.apply(this,w)}),A(i,v)}var Ln=F("<button> </button>"),Mn=F('<div class="sub-menu-tabs svelte-tv6tw8"></div>');function sa(i,a){Me(a,!1);let e=h(a,"tabs",24,()=>[]),t=h(a,"activeTab",8,""),o=h(a,"onTabChange",8,d=>{});Te();var r=Mn();vt(r,5,e,dt,(d,c)=>{var s=Ln();let v;var b=f(s,!0);g(s),J(()=>{v=ue(s,1,"sub-menu-tab svelte-tv6tw8",null,v,{active:t()===n(c).id}),Ue(b,(n(c),m(()=>n(c).label)))}),p("click",s,()=>o()(n(c).id)),A(d,s)}),g(r),A(i,r),De()}var Dn=F('<div class="modal-overlay svelte-qik81a" role="dialog" aria-modal="true" tabindex="-1"><div class="modal svelte-qik81a" role="document"><p class="modal-message svelte-qik81a"> </p> <div class="modal-actions svelte-qik81a"><button class="btn-text svelte-qik81a"> </button> <button class="btn-text btn-confirm svelte-qik81a"> </button></div></div></div>');function ta(i,a){Me(a,!1);let e=h(a,"message",8,""),t=h(a,"confirmText",8,"Yes"),o=h(a,"cancelText",8,"Cancel"),r=h(a,"onConfirm",8,()=>{}),d=h(a,"onCancel",8,()=>{});Te();var c=Dn(),s=f(c),v=f(s),b=f(v,!0);g(v);var k=u(v,2),S=f(k),x=f(S,!0);g(S);var y=u(S,2),R=f(y,!0);g(y),g(k),g(s),g(c),J(()=>{Ue(b,e()),Ue(x,o()),Ue(R,t())}),p("click",S,function(...l){d()?.apply(this,l)}),p("click",y,function(...l){r()?.apply(this,l)}),p("click",s,st(function(l){Kt.call(this,a,l)})),p("keydown",s,st(function(l){Kt.call(this,a,l)})),p("click",c,function(...l){d()?.apply(this,l)}),p("keydown",c,l=>l.key==="Escape"&&d()()),A(i,c),De()}var Tn=F('<canvas class="blur-canvas svelte-pjowa5"></canvas>'),An=F('<div class="blur-brush-indicator svelte-pjowa5"></div>'),Fn=F('<div class="blur-brush-preview svelte-pjowa5"></div>'),qn=F('<div class="crop-overlay svelte-pjowa5"><div class="overlay-top svelte-pjowa5"></div> <div class="overlay-bottom svelte-pjowa5"></div> <div class="overlay-left svelte-pjowa5"></div> <div class="overlay-right svelte-pjowa5"></div> <div class="crop-box svelte-pjowa5" role="button" aria-label="Drag to move crop area" tabindex="0"><div class="crop-border svelte-pjowa5"></div> <div class="corner-handle top-left svelte-pjowa5" role="button" aria-label="Resize top-left corner" tabindex="0"></div> <div class="corner-handle top-right svelte-pjowa5" role="button" aria-label="Resize top-right corner" tabindex="0"></div> <div class="corner-handle bottom-left svelte-pjowa5" role="button" aria-label="Resize bottom-left corner" tabindex="0"></div> <div class="corner-handle bottom-right svelte-pjowa5" role="button" aria-label="Resize bottom-right corner" tabindex="0"></div></div></div>'),On=F('<div class="crop-canvas svelte-pjowa5" role="application" aria-label="Image crop canvas"><div class="image-wrapper svelte-pjowa5"><img alt="Crop preview" class="canvas-image svelte-pjowa5" draggable="false"/> <!></div> <!> <!> <!></div>');function Hn(i,a){Me(a,!1);const e=N(),t=N(),o=N(),r=N();let d=h(a,"imageSrc",8,""),c=h(a,"cropBox",24,()=>({x:10,y:10,width:80,height:80})),s=h(a,"isCropping",8,!1),v=h(a,"scale",8,1),b=h(a,"offsetX",8,0),k=h(a,"offsetY",8,0),S=h(a,"imageWidth",8,0),x=h(a,"imageHeight",8,0),y=h(a,"editFilters",8,""),R=h(a,"blurEnabled",8,!1),l=h(a,"blurBrushSize",8,50),w=h(a,"blurStrength",8,50),M=h(a,"blurSoften",8,50),E=h(a,"blurInvert",8,!1),L=h(a,"blurMask",24,()=>[]),T=h(a,"showBrushPreview",8,!1);const I=gn();let C=N(),P=N(),U=N({width:0,height:0}),Y=!1,ee=null,me=0,oe=0,K=null,fe=0,q=1,W=!1,se=N({x:0,y:0,visible:!1}),ge=N(null),Be=N("");async function ye(){z(Be,d());const B=new Image;B.crossOrigin="anonymous",B.onload=()=>{z(ge,B)},B.src=d()}function Ke(B){const Z=document.createElement("canvas");Z.width=n(ge).naturalWidth,Z.height=n(ge).naturalHeight;const ce=Z.getContext("2d");return ce.filter=`blur(${B}px)`,ce.drawImage(n(ge),0,0),Z}function H(){if(!n(P)||!n(ge)||!L())return;const B=n(P).getContext("2d"),Z=n(P).width,ce=n(P).height;if(B.clearRect(0,0,Z,ce),L().length===0)return;const Q=Z/S(),le=ce/x();if(L().some(ne=>ne.invert)){const ne=L().reduce((j,ie)=>j+(ie.strength||50),0)/L().length;L().reduce((j,ie)=>j+(ie.soften||50),0)/L().length;const _=.5+ne/100*9.5,D=Ke(_);B.drawImage(D,0,0,Z,ce),B.globalCompositeOperation="destination-out";for(const j of L()){if(!j.invert)continue;const ie=j.x*Q,V=j.y*le,xe=j.radius*Math.min(Q,le),Ce=(j.soften||50)/100,Se=Math.max(0,.3-Ce*.3),Re=.3+(1-Ce)*.4,Pe=B.createRadialGradient(ie,V,0,ie,V,xe);Pe.addColorStop(Se,"rgba(0,0,0,1)"),Pe.addColorStop(Re,`rgba(0,0,0,${.5+Ce*.3})`),Pe.addColorStop(1,"rgba(0,0,0,0)"),B.fillStyle=Pe,B.beginPath(),B.arc(ie,V,xe,0,Math.PI*2),B.fill()}B.globalCompositeOperation="source-over"}else for(const ne of L()){const _=ne.x*Q,D=ne.y*le,j=ne.radius*Math.min(Q,le),ie=ne.strength||50,V=(ne.soften||50)/100,xe=.5+ie/100*9.5,Ce=Ke(xe);B.save();const Se=Math.max(0,.2-V*.2),Re=.2+(1-V)*.5,Pe=B.createRadialGradient(_,D,0,_,D,j);Pe.addColorStop(Se,"rgba(255,255,255,1)"),Pe.addColorStop(Re,`rgba(255,255,255,${.4+V*.3})`),Pe.addColorStop(1,"rgba(255,255,255,0)"),B.beginPath(),B.arc(_,D,j,0,Math.PI*2),B.clip(),B.drawImage(Ce,0,0,Z,ce),B.restore()}}Bt(()=>(X(),window.addEventListener("resize",X),()=>window.removeEventListener("resize",X)));function X(){if(n(C)){const B=n(C).getBoundingClientRect();z(U,{width:B.width,height:B.height})}}function te(B){return B.touches&&B.touches.length>0?{x:B.touches[0].clientX,y:B.touches[0].clientY}:{x:B.clientX,y:B.clientY}}function be(B){if(B.touches&&B.touches.length>=2){const Z=B.touches[0].clientX-B.touches[1].clientX,ce=B.touches[0].clientY-B.touches[1].clientY;return Math.sqrt(Z*Z+ce*ce)}return 0}function de(B,Z="move"){if(!s())return;if(B.touches&&B.touches.length>=2){fe=be(B),q=v(),ee="pinch";return}B.preventDefault(),Y=!0,ee=Z;const ce=te(B);me=ce.x,oe=ce.y,K={...c()}}function ze(B){if(!s())return;if(ee==="pinch"&&B.touches&&B.touches.length>=2){const ke=be(B),ne=q*(ke/fe);I("scaleChange",{scale:Math.max(.5,Math.min(3,ne))});return}if(!Y||!K)return;B.preventDefault();const Z=te(B),ce=(Z.x-me)/n(e)*100,Q=(Z.y-oe)/n(t)*100;let le={...K};if(ee==="move")le.x=Math.max(0,Math.min(100-K.width,K.x+ce)),le.y=Math.max(0,Math.min(100-K.height,K.y+Q));else if(ee.includes("corner")){if(ee.includes("left")){const ne=K.x+ce,_=K.width-ce;_>=10&&ne>=0&&(le.x=ne,le.width=_)}if(ee.includes("right")){const ne=K.width+ce;ne>=10&&K.x+ne<=100&&(le.width=ne)}if(ee.includes("top")){const ne=K.y+Q,_=K.height-Q;_>=10&&ne>=0&&(le.y=ne,le.height=_)}if(ee.includes("bottom")){const ne=K.height+Q;ne>=10&&K.y+ne<=100&&(le.height=ne)}}I("cropChange",{cropBox:le})}function Ee(){Y=!1,ee=null,K=null,W&&(W=!1)}function Fe(B){R()&&(B.preventDefault(),W=!0,Qe(B))}function qe(B){if(!R())return;const Z=n(C).getBoundingClientRect(),ce=te(B);z(se,{x:ce.x-Z.left,y:ce.y-Z.top,visible:!0}),W&&Qe(B)}function Ge(){z(se,{...n(se),visible:!1}),W&&(W=!1)}function Qe(B){const Z=n(C).getBoundingClientRect(),ce=te(B),Q=(ce.x-Z.left)/n(e)*S(),le=(ce.y-Z.top)/n(t)*x(),ke=l()/100*Math.min(S(),x())*.15;I("blurPaint",{point:{x:Q,y:le,radius:ke,strength:w(),soften:M(),invert:E()}})}Ne(()=>n(U),()=>{z(e,n(U).width)}),Ne(()=>(Le(x()),Le(S()),n(e)),()=>{z(t,x()&&S()?n(e)*x()/S():0)}),Ne(()=>(Le(l()),n(e),n(t)),()=>{z(o,l()/100*Math.min(n(e),n(t))*.3)}),Ne(()=>(Le(d()),n(P),n(Be)),()=>{d()&&n(P)&&d()!==n(Be)&&ye()}),Ne(()=>(Le(L()),n(P),n(ge)),()=>{L()&&Array.isArray(L())&&L().length>0&&n(P)&&n(ge)&&H()}),Ne(()=>(Le(c()),n(e),n(t)),()=>{z(r,{x:c().x/100*n(e),y:c().y/100*n(t),width:c().width/100*n(e),height:c().height/100*n(t)})}),pt(),Te();var he=On(),Oe=f(he),O=f(Oe),He=u(O,2);{var nt=B=>{var Z=Tn();ft(Z,ce=>z(P,ce),()=>n(P)),J(()=>{_e(Z,"width",n(e)),_e(Z,"height",n(t)),we(Z,`filter: ${y()??""};`)}),A(B,Z)};$(He,B=>{R()&&n(e)>0&&n(t)>0&&B(nt)})}g(Oe);var ae=u(Oe,2);{var re=B=>{var Z=An();J(()=>we(Z,`
				left: ${n(se),m(()=>n(se).x)??""}px;
				top: ${n(se),m(()=>n(se).y)??""}px;
				width: ${n(o)??""}px;
				height: ${n(o)??""}px;
			`)),A(B,Z)};$(ae,B=>{Le(R()),n(se),m(()=>R()&&n(se).visible)&&B(re)})}var Ie=u(ae,2);{var We=B=>{var Z=Fn();J(()=>we(Z,`
				left: ${n(e)/2}px;
				top: ${n(t)/2}px;
				width: ${n(o)??""}px;
				height: ${n(o)??""}px;
			`)),A(B,Z)};$(Ie,B=>{T()&&n(e)>0&&n(t)>0&&B(We)})}var Ve=u(Ie,2);{var Ae=B=>{var Z=qn(),ce=f(Z),Q=u(ce,2),le=u(Q,2),ke=u(le,2),ne=u(ke,2),_=u(f(ne),2),D=u(_,2),j=u(D,2),ie=u(j,2);g(ne),g(Z),J(()=>{we(ce,`height: ${n(r),m(()=>n(r).y)??""}px;`),we(Q,`top: ${n(r),m(()=>n(r).y+n(r).height)??""}px; height: ${n(t),n(r),m(()=>n(t)-n(r).y-n(r).height)??""}px;`),we(le,`top: ${n(r),m(()=>n(r).y)??""}px; height: ${n(r),m(()=>n(r).height)??""}px; width: ${n(r),m(()=>n(r).x)??""}px;`),we(ke,`top: ${n(r),m(()=>n(r).y)??""}px; height: ${n(r),m(()=>n(r).height)??""}px; left: ${n(r),m(()=>n(r).x+n(r).width)??""}px; width: ${n(e),n(r),m(()=>n(e)-n(r).x-n(r).width)??""}px;`),we(ne,`left: ${n(r),m(()=>n(r).x)??""}px; top: ${n(r),m(()=>n(r).y)??""}px; width: ${n(r),m(()=>n(r).width)??""}px; height: ${n(r),m(()=>n(r).height)??""}px;`)}),p("mousedown",_,st(V=>de(V,"corner-top-left"))),p("touchstart",_,st(V=>de(V,"corner-top-left"))),p("mousedown",D,st(V=>de(V,"corner-top-right"))),p("touchstart",D,st(V=>de(V,"corner-top-right"))),p("mousedown",j,st(V=>de(V,"corner-bottom-left"))),p("touchstart",j,st(V=>de(V,"corner-bottom-left"))),p("mousedown",ie,st(V=>de(V,"corner-bottom-right"))),p("touchstart",ie,st(V=>de(V,"corner-bottom-right"))),p("mousedown",ne,V=>de(V,"move")),p("touchstart",ne,V=>de(V,"move")),A(B,Z)};$(Ve,B=>{s()&&n(t)>0&&B(Ae)})}g(he),ft(he,B=>z(C,B),()=>n(C)),J(()=>{we(Oe,`transform: scale(${v()??""}) translate(${b()??""}px, ${k()??""}px);`),_e(O,"src",d()),we(O,`filter: ${y()??""};`)}),p("mousemove",he,function(...B){(R()?qe:ze)?.apply(this,B)}),p("mouseup",he,Ee),p("mouseleave",he,function(...B){(R()?Ge:Ee)?.apply(this,B)}),p("touchmove",he,function(...B){(R()?qe:ze)?.apply(this,B)}),p("touchend",he,Ee),p("mousedown",he,function(...B){(R()?Fe:null)?.apply(this,B)}),p("touchstart",he,function(...B){(R()?Fe:null)?.apply(this,B)}),A(i,he),De()}var Un=F('<img alt="" class="toggle-icon svelte-1gdqxne"/>'),Wn=F('<span class="toggle-label svelte-1gdqxne"> </span>'),jn=F("<div><button><!></button> <!></div>"),Nn=F("<div></div>");function Aa(i,a){Me(a,!1);let e=h(a,"options",24,()=>[]),t=h(a,"value",8,""),o=h(a,"onChange",8,v=>{}),r=h(a,"showLabels",8,!0),d=h(a,"centered",8,!1);Te();var c=Nn();let s;vt(c,5,e,dt,(v,b)=>{var k=jn();let S;var x=f(k);let y;var R=f(x);{var l=E=>{var L=Un();J(()=>_e(L,"src",`/icons/${n(b),m(()=>n(b).icon)??""}.svg`)),A(E,L)};$(R,E=>{n(b),m(()=>n(b).icon)&&E(l)})}g(x);var w=u(x,2);{var M=E=>{var L=Wn(),T=f(L,!0);g(L),J(()=>Ue(T,(n(b),m(()=>n(b).label)))),A(E,L)};$(w,E=>{Le(r()),n(b),m(()=>r()&&n(b).label)&&E(M)})}g(k),J(()=>{S=ue(k,1,"toggle-item svelte-1gdqxne",null,S,{active:t()===n(b).id}),y=ue(x,1,"toggle-btn svelte-1gdqxne",null,y,{active:t()===n(b).id}),_e(x,"aria-label",(n(b),m(()=>n(b).label)))}),p("click",x,()=>o()(n(b).id)),A(v,k)}),g(c),J(()=>s=ue(c,1,"toggle-group svelte-1gdqxne",null,s,{centered:d()})),A(i,c),De()}var Yn=F('<label class="input-label svelte-1r47u3b"> <input class="input svelte-1r47u3b"/></label>'),Xn=F('<input class="input svelte-1r47u3b"/>'),Gn=F('<div class="input-field svelte-1r47u3b"><!></div>');function wa(i,a){Me(a,!1);let e=h(a,"label",8,""),t=h(a,"value",12,""),o=h(a,"type",8,"text"),r=h(a,"placeholder",8,""),d=h(a,"disabled",8,!1),c=h(a,"onChange",8,x=>{});function s(x){t(x.target.value),c()(t())}Te();var v=Gn(),b=f(v);{var k=x=>{var y=Yn(),R=f(y),l=u(R);Ft(l),g(y),J(()=>{Ue(R,`${e()??""} `),_e(l,"type",o()),qt(l,t()),_e(l,"placeholder",r()),l.disabled=d()}),p("input",l,s),A(x,y)},S=x=>{var y=Xn();Ft(y),J(()=>{_e(y,"type",o()),qt(y,t()),_e(y,"placeholder",r()),y.disabled=d()}),p("input",y,s),A(x,y)};$(b,x=>{e()?x(k):x(S,!1)})}g(v),A(i,v),De()}var Qn=F('<span class="slider-value svelte-jchife"> </span>'),Vn=F('<div class="slider-header svelte-jchife"><span class="slider-label svelte-jchife"> </span> <!></div>'),Jn=F('<div class="slider-container svelte-jchife"><!> <input type="range" class="slider svelte-jchife"/></div>');function Ze(i,a){Me(a,!1);let e=h(a,"label",8,""),t=h(a,"min",8,0),o=h(a,"max",8,100),r=h(a,"value",8,50),d=h(a,"step",8,1),c=h(a,"showValue",8,!1),s=h(a,"onChange",8,M=>{}),v=h(a,"onInteractionStart",8,()=>{}),b=h(a,"onInteractionEnd",8,()=>{});function k(M){const E=Number(M.target.value);s()(E)}function S(){v()()}function x(){b()()}Te();var y=Jn(),R=f(y);{var l=M=>{var E=Vn(),L=f(E),T=f(L,!0);g(L);var I=u(L,2);{var C=P=>{var U=Qn(),Y=f(U,!0);g(U),J(()=>Ue(Y,r())),A(P,U)};$(I,P=>{c()&&P(C)})}g(E),J(()=>Ue(T,e())),A(M,E)};$(R,M=>{e()&&M(l)})}var w=u(R,2);Ft(w),g(y),J(()=>{_e(w,"min",t()),_e(w,"max",o()),_e(w,"step",d()),qt(w,r())}),p("input",w,k),p("mousedown",w,S),p("touchstart",w,S),p("mouseup",w,x),p("touchend",w,x),A(i,y),De()}var Zn=F('<div class="apply-row svelte-17iy3mz"><button class="btn-apply svelte-17iy3mz">Apply</button></div>'),Kn=F('<div class="crop-controls svelte-17iy3mz"><!> <div class="dimensions-row svelte-17iy3mz"><div class="dimension-input svelte-17iy3mz"><!></div> <button class="icon-btn svelte-17iy3mz"><img alt="" class="icon-btn-img svelte-17iy3mz"/></button> <div class="dimension-input svelte-17iy3mz"><!></div> <button class="icon-btn svelte-17iy3mz" aria-label="Flip horizontal"><img src="/icons/icon-flip-horizontal.svg" alt="" class="icon-btn-img svelte-17iy3mz"/></button> <button class="icon-btn svelte-17iy3mz" aria-label="Rotate"><img src="/icons/icon-rotate.svg" alt="" class="icon-btn-img svelte-17iy3mz"/></button></div> <!> <!></div>');function $n(i,a){Me(a,!1);let e=h(a,"aspectRatio",8,"9:16"),t=h(a,"cropWidth",8,1080),o=h(a,"cropHeight",8,1920),r=h(a,"ratioLocked",8,!0),d=h(a,"scale",8,100),c=h(a,"cropPending",8,!1),s=h(a,"onRatioChange",8,q=>{}),v=h(a,"onDimensionsChange",8,({width:q,height:W})=>{}),b=h(a,"onLockToggle",8,()=>{}),k=h(a,"onFlip",8,()=>{}),S=h(a,"onRotate",8,()=>{}),x=h(a,"onScaleChange",8,q=>{}),y=h(a,"onApply",8,()=>{});const R=[{id:"9:16",label:"9:16",icon:"icon-vertical"},{id:"1:1",label:"1:1",icon:"icon-square"},{id:"16:9",label:"16:9",icon:"icon-horizontal"},{id:"custom",label:"Custom",icon:"icon-custom"}];function l(q){const W=parseInt(q)||0;v()({width:W,height:o()})}function w(q){const W=parseInt(q)||0;v()({width:t(),height:W})}Te();var M=Kn(),E=f(M);Aa(E,{get options(){return R},get value(){return e()},get onChange(){return s()},showLabels:!0});var L=u(E,2),T=f(L),I=f(T);{let q=Je(()=>(Le(t()),m(()=>t().toString())));wa(I,{label:"Width",type:"number",get value(){return n(q)},onChange:l})}g(T);var C=u(T,2),P=f(C);g(C);var U=u(C,2),Y=f(U);{let q=Je(()=>(Le(o()),m(()=>o().toString())));wa(Y,{label:"Height",type:"number",get value(){return n(q)},onChange:w})}g(U);var ee=u(U,2),me=u(ee,2);g(L);var oe=u(L,2);Ze(oe,{label:"Scale",min:50,max:200,get value(){return d()},step:1,showValue:!0,get onChange(){return x()}});var K=u(oe,2);{var fe=q=>{var W=Zn(),se=f(W);g(W),p("click",se,function(...ge){y()?.apply(this,ge)}),A(q,W)};$(K,q=>{c()&&q(fe)})}g(M),J(()=>{_e(C,"aria-label",r()?"Unlock aspect ratio":"Lock aspect ratio"),_e(P,"src",`/icons/${r()?"icon-lock":"icon-unlock"}.svg`)}),p("click",C,function(...q){b()?.apply(this,q)}),p("click",ee,function(...q){k()?.apply(this,q)}),p("click",me,function(...q){S()?.apply(this,q)}),A(i,M),De()}var ei=F("<button> </button>"),ti=F("<button> </button>"),ai=F('<div class="blur-controls svelte-1e1k0ax"><div class="blur-control-row svelte-1e1k0ax"><!> <label class="invert-checkbox svelte-1e1k0ax"><input type="checkbox" class="svelte-1e1k0ax"/> <span class="checkbox-label svelte-1e1k0ax">Invert</span></label></div> <div class="slider-row svelte-1e1k0ax"><div class="slider-track svelte-1e1k0ax"><!></div> <button class="reset-btn svelte-1e1k0ax" aria-label="Reset"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-1e1k0ax"/></button></div> <div class="zoom-row svelte-1e1k0ax"><span class="zoom-label svelte-1e1k0ax">Zoom in</span> <div class="zoom-slider-row svelte-1e1k0ax"><div class="slider-track svelte-1e1k0ax"><!></div> <button class="reset-btn svelte-1e1k0ax" aria-label="Reset zoom"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-1e1k0ax"/></button></div></div> <div class="nudge-row svelte-1e1k0ax"><button class="nudge-btn svelte-1e1k0ax" aria-label="Nudge up"><img src="/icons/icon-nudge-up.svg" alt="" class="svelte-1e1k0ax"/></button> <button class="nudge-btn svelte-1e1k0ax" aria-label="Nudge down"><img src="/icons/icon-nudge-down.svg" alt="" class="svelte-1e1k0ax"/></button> <button class="nudge-btn svelte-1e1k0ax" aria-label="Nudge left"><img src="/icons/icon-nudge-left.svg" alt="" class="svelte-1e1k0ax"/></button> <button class="nudge-btn svelte-1e1k0ax" aria-label="Nudge right"><img src="/icons/icon-nudge-right.svg" alt="" class="svelte-1e1k0ax"/></button></div></div>'),ni=F('<div class="edit-controls svelte-1e1k0ax"><div class="enhancement-row svelte-1e1k0ax"></div> <div class="slider-row svelte-1e1k0ax"><div class="slider-track svelte-1e1k0ax"><!></div> <button class="reset-btn svelte-1e1k0ax" aria-label="Reset"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-1e1k0ax"/></button></div> <div class="blur-section svelte-1e1k0ax"><div class="blur-header svelte-1e1k0ax"><button class="chevron-btn svelte-1e1k0ax"><img alt=""/></button> <span class="blur-label svelte-1e1k0ax">Blur</span> <button><span class="toggle-thumb svelte-1e1k0ax"></span></button></div> <!></div></div>');function ii(i,a){Me(a,!1);const e=N(),t=N(),o=N(),r=N(),d=N(),c=N();let s=h(a,"brightness",8,0),v=h(a,"shadows",8,0),b=h(a,"contrast",8,0),k=h(a,"hdr",8,0),S=h(a,"blurBrushSize",8,50),x=h(a,"blurStrength",8,50),y=h(a,"blurSoften",8,50),R=h(a,"blurInvert",8,!1),l=h(a,"zoomLevel",8,1),w=h(a,"blurEnabled",8,!1),M=h(a,"onBrightnessChange",8,Q=>{}),E=h(a,"onShadowsChange",8,Q=>{}),L=h(a,"onContrastChange",8,Q=>{}),T=h(a,"onHdrChange",8,Q=>{}),I=h(a,"onBlurBrushSizeChange",8,Q=>{}),C=h(a,"onBlurStrengthChange",8,Q=>{}),P=h(a,"onBlurSoftenChange",8,Q=>{}),U=h(a,"onBlurInvertChange",8,Q=>{}),Y=h(a,"onZoomChange",8,Q=>{}),ee=h(a,"onNudge",8,Q=>{}),me=h(a,"onResetZoom",8,()=>{}),oe=h(a,"onBlurToggle",8,Q=>{}),K=h(a,"onBrushPreviewChange",8,Q=>{}),fe=h(a,"onEditEnd",8,()=>{}),q=N("brightness"),W=N(w()),se=N("brushSize");const ge=[{id:"brightness",label:"Brightness"},{id:"shadows",label:"Shadows"},{id:"contrast",label:"Contrast"},{id:"hdr",label:"HDR"}],Be=[{id:"brushSize",label:"Brush size"},{id:"strength",label:"Strength"},{id:"soften",label:"Soften edges"}];function ye(Q){switch(n(q)){case"brightness":M()(Q);break;case"shadows":E()(Q);break;case"contrast":L()(Q);break;case"hdr":T()(Q);break}}function Ke(){ye(0)}function H(Q){switch(n(se)){case"brushSize":I()(Q);break;case"strength":C()(Q);break;case"soften":P()(Q);break}}function X(){H(50)}function te(){const Q=!w();oe()(Q),z(W,Q)}function be(){w()&&z(W,!n(W))}function de(){U()(!R())}function ze(Q){z(q,Q),z(W,!1)}function Ee(Q){z(se,Q)}function Fe(){fe()()}function qe(){n(se)==="brushSize"&&K()(!0)}function Ge(){K()(!1),fe()()}Ne(()=>(n(q),Le(s()),Le(v()),Le(b()),Le(k())),()=>{z(e,(()=>{switch(n(q)){case"brightness":return s();case"shadows":return v();case"contrast":return b();case"hdr":return k();default:return 0}})())}),Ne(()=>n(q),()=>{z(t,n(q)==="hdr"?0:-100)}),Ne(()=>{},()=>{z(o,100)}),Ne(()=>(n(se),Le(S()),Le(x()),Le(y())),()=>{z(r,(()=>{switch(n(se)){case"brushSize":return S();case"strength":return x();case"soften":return y();default:return 50}})())}),Ne(()=>{},()=>{z(d,1)}),Ne(()=>{},()=>{z(c,100)}),pt(),Te();var Qe=ni(),he=f(Qe);vt(he,5,()=>ge,dt,(Q,le)=>{var ke=ei();let ne;var _=f(ke,!0);g(ke),J(()=>{ne=ue(ke,1,"enhancement-btn svelte-1e1k0ax",null,ne,{active:n(q)===n(le).id}),Ue(_,(n(le),m(()=>n(le).label)))}),p("click",ke,()=>ze(n(le).id)),A(Q,ke)}),g(he);var Oe=u(he,2),O=f(Oe),He=f(O);Ze(He,{get min(){return n(t)},get max(){return n(o)},get value(){return n(e)},step:1,onChange:ye,onInteractionEnd:Fe}),g(O);var nt=u(O,2);g(Oe);var ae=u(Oe,2),re=f(ae),Ie=f(re),We=f(Ie);let Ve;g(Ie);var Ae=u(Ie,4);let B;g(re);var Z=u(re,2);{var ce=Q=>{var le=ai(),ke=f(le),ne=f(ke);vt(ne,1,()=>Be,dt,(G,pe)=>{var $e=ti();let tt;var Et=f($e,!0);g($e),J(()=>{tt=ue($e,1,"blur-control-btn svelte-1e1k0ax",null,tt,{active:n(se)===n(pe).id}),Ue(Et,(n(pe),m(()=>n(pe).label)))}),p("click",$e,()=>Ee(n(pe).id)),A(G,$e)});var _=u(ne,2),D=f(_);Ft(D),_t(2),g(_),g(ke);var j=u(ke,2),ie=f(j),V=f(ie);Ze(V,{get min(){return n(d)},get max(){return n(c)},get value(){return n(r)},step:1,onChange:H,onInteractionStart:qe,onInteractionEnd:Ge}),g(ie);var xe=u(ie,2);g(j);var Ce=u(j,2),Se=u(f(Ce),2),Re=f(Se),Pe=f(Re);Ze(Pe,{min:1,max:3,step:.1,get value(){return l()},get onChange(){return Y()}}),g(Re);var ot=u(Re,2);g(Se),g(Ce);var Xe=u(Ce,2),kt=f(Xe),rt=u(kt,2),lt=u(rt,2),yt=u(lt,2);g(Xe),g(le),J(()=>_n(D,R())),p("change",D,de),p("click",xe,X),p("click",ot,function(...G){me()?.apply(this,G)}),p("click",kt,()=>ee()("up")),p("click",rt,()=>ee()("down")),p("click",lt,()=>ee()("left")),p("click",yt,()=>ee()("right")),A(Q,le)};$(Z,Q=>{n(W)&&w()&&Q(ce)})}g(ae),g(Qe),J(()=>{Ie.disabled=!w(),_e(Ie,"aria-label",n(W)?"Collapse":"Expand"),_e(We,"src",`/icons/${n(W)?"icon-collapse":"icon-expand"}.svg`),Ve=ue(We,1,"chevron-icon svelte-1e1k0ax",null,Ve,{disabled:!w()}),B=ue(Ae,1,"toggle-switch svelte-1e1k0ax",null,B,{active:w()}),_e(Ae,"aria-label",w()?"Disable blur":"Enable blur")}),p("click",nt,Ke),p("click",Ie,be),p("click",Ae,te),A(i,Qe),De()}var oi=F('<button><div class="filter-preview svelte-183y0dt"></div> <span> </span></button>'),ri=F('<div class="filter-grid svelte-183y0dt"></div>');function li(i,a){Me(a,!1);let e=h(a,"filters",24,()=>[]),t=h(a,"value",8,"original"),o=h(a,"imageUrl",8,""),r=h(a,"onChange",8,c=>{});Te();var d=ri();vt(d,5,e,dt,(c,s)=>{var v=oi();let b;var k=f(v),S=u(k,2);let x;var y=f(S,!0);g(S),g(v),J(()=>{b=ue(v,1,"filter-card svelte-183y0dt",null,b,{active:t()===n(s).id}),we(k,`
					background-image: url(${o()??""});
					filter: ${n(s),m(()=>n(s).css||"none")??""};
				`),x=ue(S,1,"filter-label svelte-183y0dt",null,x,{active:t()===n(s).id}),Ue(y,(n(s),m(()=>n(s).label)))}),p("click",v,()=>r()(n(s).id)),A(c,v)}),g(d),A(i,d),De()}var si=F('<div class="filter-controls svelte-1274k9v"><!> <div><div class="slider-track svelte-1274k9v"><!></div> <button class="reset-btn svelte-1274k9v" aria-label="Reset filter"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-1274k9v"/></button></div></div>');function ci(i,a){Me(a,!1);const e=N();let t=h(a,"imageUrl",8,""),o=h(a,"activeFilter",8,"original"),r=h(a,"filterStrength",8,50),d=h(a,"onFilterChange",8,w=>{}),c=h(a,"onStrengthChange",8,w=>{}),s=h(a,"onReset",8,()=>{});const v=[{id:"original",label:"Original",css:"none"},{id:"greyscale",label:"Greyscale",css:"grayscale(100%)"},{id:"sepia",label:"Sepia",css:"sepia(100%)"},{id:"sunset",label:"Sunset",css:"sepia(30%) saturate(140%) brightness(110%) hue-rotate(-10deg)"},{id:"azure",label:"Azure",css:"saturate(120%) brightness(105%) hue-rotate(180deg)"},{id:"teal",label:"Teal",css:"saturate(130%) hue-rotate(140deg)"}];Ne(()=>Le(o()),()=>{z(e,o()==="original")}),pt();var b=si(),k=f(b);li(k,{get filters(){return v},get value(){return o()},get imageUrl(){return t()},get onChange(){return d()}});var S=u(k,2);let x;var y=f(S),R=f(y);{let w=Je(()=>n(e)?()=>{}:c());Ze(R,{label:"Strength",min:0,max:100,get value(){return r()},get onChange(){return n(w)}})}g(y);var l=u(y,2);g(S),g(b),J(()=>x=ue(S,1,"slider-row svelte-1274k9v",null,x,{disabled:n(e)})),p("click",l,function(...w){s()?.apply(this,w)}),A(i,b),De()}const xa=[{id:"original",label:"Original",css:"none"},{id:"greyscale",label:"Greyscale",css:"grayscale(100%)"},{id:"sepia",label:"Sepia",css:"sepia(100%)"},{id:"sunset",label:"Sunset",css:"sepia(30%) saturate(140%) brightness(110%) hue-rotate(-10deg)"},{id:"azure",label:"Azure",css:"saturate(120%) brightness(105%) hue-rotate(180deg)"},{id:"teal",label:"Teal",css:"saturate(130%) hue-rotate(140deg)"}];function di(i){const a=[i];let e=0,t=0;const o=bt({canUndo:!1,canRedo:!1}),{subscribe:r,set:d,update:c}=bt(i);function s(){o.set({canUndo:e>t,canRedo:e<a.length-1})}return{subscribe:r,undoState:o,set:v=>{a.splice(e+1),a.push(v),e=a.length-1,d(v),s()},update:v=>{c(b=>{const k=v(b);return a.splice(e+1),a.push(k),e=a.length-1,s(),k})},silentUpdate:v=>{c(v)},setBaseState:()=>{t=e,s()},undo:()=>{e>t&&(e--,d(a[e]),s())},redo:()=>{e<a.length-1&&(e++,d(a[e]),s())},canUndo:()=>e>t,canRedo:()=>e<a.length-1,reset:()=>{a.length=0,a.push(i),e=0,t=0,d(i),s()}}}const vi={originalImage:null,currentImage:null,aspectRatio:"custom",width:0,height:0,ratioLocked:!1,scale:1,offsetX:0,offsetY:0,brightness:0,contrast:0,shadows:0,hdr:0,activeFilter:"original",filterStrength:50,cropBox:{x:0,y:0,width:0,height:0},isCropping:!1,cropPending:!1,imageWidth:0,imageHeight:0,blurEnabled:!1,blurBrushSize:50,blurStrength:50,blurSoften:50,blurInvert:!1,blurMask:null,showBrushPreview:!1,zoomLevel:1,zoomOffsetX:0,zoomOffsetY:0},ve=di(vi),At=bt("none"),ui=ia(ve,i=>i.currentImage!==null);function gi(){ve.reset(),At.set("none")}var hi=F('<div class="controls-panel svelte-c9tnuw"><!></div>'),fi=F('<div class="controls-panel svelte-c9tnuw"><!></div>'),bi=F("<!> <!> <!> <!>",1),mi=F('<div class="crop-tab svelte-c9tnuw"><!> <!> <!></div>');function pi(i,a){Me(a,!1);const e=()=>it(ve,"$cropState",d),t=()=>it(At,"$activeSubMenu",d),o=()=>it(ui,"$hasImage",d),r=()=>it(k,"$undoState",d),[d,c]=Rt(),s=N(),v=N(),b=N(),k=ve.undoState,S=[{id:"crop",label:"Crop"},{id:"edit",label:"Edit"},{id:"filter",label:"Filter"}];let x=N(null),y=null;async function R(_){const D=await Ut(_);ve.set({...e(),originalImage:_,currentImage:_,imageWidth:D.width,imageHeight:D.height,width:D.width,height:D.height,cropBox:{x:0,y:0,width:100,height:100},isCropping:!0,cropPending:!1,aspectRatio:"custom",ratioLocked:!1}),ve.setBaseState(),At.set("crop")}function l(_){if(e().cropPending&&t()==="crop"&&_!=="crop"){y=()=>{At.set(_),ve.silentUpdate(D=>({...D,isCropping:!1}))},z(x,"save");return}_==="crop"?ve.silentUpdate(D=>({...D,isCropping:!0})):ve.silentUpdate(D=>({...D,isCropping:!1})),At.set(t()===_?"none":_)}async function w(){return await Bn(e().currentImage,n(b),e().blurMask)}async function M(){if(e().cropPending){y=async()=>{const _=await w();await $t(_)},z(x,"save");return}if(e().currentImage){const _=await w();await $t(_)}}async function E(){if(e().cropPending){y=async()=>{const _=await w();ea(_,"picflam-export.png")},z(x,"save");return}if(e().currentImage){const _=await w();ea(_,"picflam-export.png")}}function L(){z(x,"startAgain")}function T(){ve.undo()}function I(){ve.redo()}async function C(){z(x,null),await ee(),y&&(await y(),y=null)}function P(){z(x,null),y=null}function U(){z(x,null),gi()}function Y(){z(x,null)}async function ee(){const _=e();if(!_.currentImage||!_.cropPending)return;const D=await Da(_.currentImage,_.cropBox,_.imageWidth,_.imageHeight),j=await Ut(D);ve.set({..._,currentImage:D,imageWidth:j.width,imageHeight:j.height,width:j.width,height:j.height,cropBox:{x:0,y:0,width:100,height:100},cropPending:!1})}function me(_){if(_==="custom"){ve.silentUpdate(xe=>({...xe,aspectRatio:"custom",cropBox:{x:0,y:0,width:100,height:100},ratioLocked:!1,cropPending:!1}));return}const j={"9:16":9/16,"1:1":1,"16:9":16/9}[_],ie=e().imageWidth/e().imageHeight;let V;if(_==="9:16"){const Ce=j/ie*100;if(Ce<=100)V={x:(100-Ce)/2,y:0,width:Ce,height:100};else{const Se=ie/j*100;V={x:0,y:(100-Se)/2,width:100,height:Se}}}else if(_==="16:9"){const Ce=ie/j*100;if(Ce<=100)V={x:0,y:(100-Ce)/2,width:100,height:Ce};else{const Se=j/ie*100;V={x:(100-Se)/2,y:0,width:Se,height:100}}}else if(_==="1:1")if(ie>1){const xe=100/ie;V={x:(100-xe)/2,y:0,width:xe,height:100}}else{const xe=100*ie;V={x:0,y:(100-xe)/2,width:100,height:xe}}ve.silentUpdate(xe=>({...xe,aspectRatio:_,cropBox:V,cropPending:!0,isCropping:!0,ratioLocked:!0}))}function oe({width:_,height:D}){const j=e().imageWidth,ie=e().imageHeight,V=Math.min(Math.max(1,_),j),xe=Math.min(Math.max(1,D),ie),Ce=V/j*100,Se=xe/ie*100;let Re;if(e().ratioLocked){const Pe=n(s)/n(v);if(_!==n(s)){const Xe=V/Pe/ie*100;Re={x:(100-Ce)/2,y:(100-Math.min(100,Xe))/2,width:Ce,height:Math.min(100,Xe)}}else{const Xe=xe*Pe/j*100;Re={x:(100-Math.min(100,Xe))/2,y:(100-Se)/2,width:Math.min(100,Xe),height:Se}}}else Re={x:(100-Ce)/2,y:(100-Se)/2,width:Ce,height:Se};ve.silentUpdate(Pe=>({...Pe,cropBox:Re,cropPending:!0}))}function K(){ve.silentUpdate(_=>({..._,ratioLocked:!_.ratioLocked}))}async function fe(){const _=await Rn(e().currentImage);ve.set({...e(),currentImage:_})}async function q(){const _=await zn(e().currentImage,90),D=await Ut(_);ve.set({...e(),currentImage:_,imageWidth:D.width,imageHeight:D.height,cropBox:{x:0,y:0,width:100,height:100},cropPending:!1})}function W(_){ve.silentUpdate(D=>({...D,scale:_/100}))}function se(_){const D=_.detail.cropBox;if(e().ratioLocked&&e().aspectRatio!=="custom"){const ie={"9:16":.5625,"1:1":1,"16:9":1.7777777777777777}[e().aspectRatio];e().imageWidth/e().imageHeight;const V=D.width*e().imageWidth/(D.height*e().imageHeight);if(Math.abs(V-ie)>.01){const Se=D.width/100*e().imageWidth/ie/e().imageHeight*100;D.height=Math.min(100,Se),D.y+D.height>100&&(D.y=100-D.height)}}ve.silentUpdate(j=>({...j,cropBox:D,cropPending:!0}))}function ge(){ee()}let Be=null;function ye(){Be===null&&(Be={...e()})}function Ke(){Be!==null&&(ve.set(e()),Be=null)}function H(_){ye(),ve.silentUpdate(D=>({...D,brightness:_}))}function X(_){ye(),ve.silentUpdate(D=>({...D,shadows:_}))}function te(_){ye(),ve.silentUpdate(D=>({...D,contrast:_}))}function be(_){ye(),ve.silentUpdate(D=>({...D,hdr:_}))}function de(_){ve.set({...e(),blurEnabled:_})}function ze(_){ye(),ve.silentUpdate(D=>({...D,blurBrushSize:_}))}function Ee(_){ye(),ve.silentUpdate(D=>({...D,blurStrength:_}))}function Fe(_){ye(),ve.silentUpdate(D=>({...D,blurSoften:_}))}function qe(_){ve.set({...e(),blurInvert:_})}function Ge(_){ve.silentUpdate(D=>({...D,showBrushPreview:_}))}function Qe(){Ke()}let he=null,Oe=[],O=null;function He(_){const D=_.detail.point;O===null&&(O=e().blurMask?[...e().blurMask]:[]),Oe.push(D),ve.silentUpdate(j=>({...j,blurMask:[...j.blurMask||[],D]})),he&&clearTimeout(he),he=setTimeout(()=>{if(Oe.length>0){const j=[...O,...Oe];ve.set({...e(),blurMask:j}),Oe=[],O=null}he=null},300)}function nt(_){ve.silentUpdate(D=>({...D,zoomLevel:_}))}function ae(_){ve.silentUpdate(j=>{let{zoomOffsetX:ie,zoomOffsetY:V}=j;switch(_){case"up":V-=20;break;case"down":V+=20;break;case"left":ie-=20;break;case"right":ie+=20;break}return{...j,zoomOffsetX:ie,zoomOffsetY:V}})}function re(){ve.silentUpdate(_=>({..._,zoomLevel:1,zoomOffsetX:0,zoomOffsetY:0}))}function Ie(_){ve.silentUpdate(D=>({...D,activeFilter:_}))}function We(_){ye(),ve.silentUpdate(D=>({...D,filterStrength:_}))}function Ve(){ve.set({...e(),activeFilter:"original",filterStrength:50})}Ne(()=>e(),()=>{z(s,Math.round(e().imageWidth*e().cropBox.width/100))}),Ne(()=>e(),()=>{z(v,Math.round(e().imageHeight*e().cropBox.height/100))}),Ne(()=>(e(),xa),()=>{z(b,(()=>{let _=[];if(e().brightness!==0&&_.push(`brightness(${1+e().brightness/100})`),e().contrast!==0&&_.push(`contrast(${1+e().contrast/100})`),e().shadows!==0){const D=1+e().shadows/200;_.push(`brightness(${D})`)}if(e().hdr!==0){const D=1+e().hdr/100*.3,j=1+e().hdr/100*.2;_.push(`saturate(${D}) contrast(${j})`)}if(e().activeFilter!=="original"){const D=xa.find(j=>j.id===e().activeFilter);if(D&&D.css!=="none"){const j=e().filterStrength/100,ie=D.css.replace(/(\d+)%/g,(V,xe)=>`${Math.round(parseInt(xe)*j)}%`);_.push(ie)}}return _.length>0?_.join(" "):"none"})())}),pt(),Te();var Ae=mi(),B=f(Ae);{var Z=_=>{Ta(_,{title:"Crop, edit and add filters to photos",hint:"Import, drag or paste an image",onImageImport:R})},ce=_=>{var D=bi(),j=je(D);la(j,{get canUndo(){return r(),m(()=>r().canUndo)},get canRedo(){return r(),m(()=>r().canRedo)},onUndo:T,onRedo:I,onStartAgain:L,onCopy:M,onExport:E});var ie=u(j,2);{let Re=Je(()=>(t(),e(),m(()=>t()==="edit"?e().zoomLevel:e().scale))),Pe=Je(()=>(t(),e(),m(()=>t()==="edit"?e().zoomOffsetX:e().offsetX))),ot=Je(()=>(t(),e(),m(()=>t()==="edit"?e().zoomOffsetY:e().offsetY))),Xe=Je(()=>(e(),m(()=>e().blurMask||[])));Hn(ie,{get imageSrc(){return e(),m(()=>e().currentImage)},get cropBox(){return e(),m(()=>e().cropBox)},get isCropping(){return e(),m(()=>e().isCropping)},get scale(){return n(Re)},get offsetX(){return n(Pe)},get offsetY(){return n(ot)},get imageWidth(){return e(),m(()=>e().imageWidth)},get imageHeight(){return e(),m(()=>e().imageHeight)},get editFilters(){return n(b)},get blurEnabled(){return e(),m(()=>e().blurEnabled)},get blurBrushSize(){return e(),m(()=>e().blurBrushSize)},get blurStrength(){return e(),m(()=>e().blurStrength)},get blurSoften(){return e(),m(()=>e().blurSoften)},get blurInvert(){return e(),m(()=>e().blurInvert)},get blurMask(){return n(Xe)},get showBrushPreview(){return e(),m(()=>e().showBrushPreview)},$$events:{cropChange:se,blurPaint:He}})}var V=u(ie,2);sa(V,{get tabs(){return S},get activeTab(){return t()},onTabChange:l});var xe=u(V,2);{var Ce=Re=>{{let Pe=Je(()=>(e(),m(()=>Math.round(e().scale*100))));$n(Re,{get aspectRatio(){return e(),m(()=>e().aspectRatio)},get cropWidth(){return n(s)},get cropHeight(){return n(v)},get ratioLocked(){return e(),m(()=>e().ratioLocked)},get scale(){return n(Pe)},get cropPending(){return e(),m(()=>e().cropPending)},onRatioChange:me,onDimensionsChange:oe,onLockToggle:K,onFlip:fe,onRotate:q,onScaleChange:W,onApply:ge})}},Se=Re=>{var Pe=gt(),ot=je(Pe);{var Xe=rt=>{var lt=hi(),yt=f(lt);ii(yt,{get brightness(){return e(),m(()=>e().brightness)},get shadows(){return e(),m(()=>e().shadows)},get contrast(){return e(),m(()=>e().contrast)},get hdr(){return e(),m(()=>e().hdr)},get blurEnabled(){return e(),m(()=>e().blurEnabled)},get blurBrushSize(){return e(),m(()=>e().blurBrushSize)},get blurStrength(){return e(),m(()=>e().blurStrength)},get blurSoften(){return e(),m(()=>e().blurSoften)},get blurInvert(){return e(),m(()=>e().blurInvert)},get zoomLevel(){return e(),m(()=>e().zoomLevel)},onBrightnessChange:H,onShadowsChange:X,onContrastChange:te,onHdrChange:be,onBlurToggle:de,onBlurBrushSizeChange:ze,onBlurStrengthChange:Ee,onBlurSoftenChange:Fe,onBlurInvertChange:qe,onZoomChange:nt,onNudge:ae,onResetZoom:re,onBrushPreviewChange:Ge,onEditEnd:Qe}),g(lt),A(rt,lt)},kt=rt=>{var lt=gt(),yt=je(lt);{var G=pe=>{var $e=fi(),tt=f($e);ci(tt,{get imageUrl(){return e(),m(()=>e().currentImage)},get activeFilter(){return e(),m(()=>e().activeFilter)},get filterStrength(){return e(),m(()=>e().filterStrength)},onFilterChange:Ie,onStrengthChange:We,onReset:Ve}),g($e),A(pe,$e)};$(yt,pe=>{t()==="filter"&&pe(G)},!0)}A(rt,lt)};$(ot,rt=>{t()==="edit"?rt(Xe):rt(kt,!1)},!0)}A(Re,Pe)};$(xe,Re=>{t()==="crop"?Re(Ce):Re(Se,!1)})}A(_,D)};$(B,_=>{o()?_(ce,!1):_(Z)})}var Q=u(B,2);{var le=_=>{ta(_,{message:"Save changes?",confirmText:"Yes",cancelText:"Cancel",onConfirm:C,onCancel:P})};$(Q,_=>{n(x)==="save"&&_(le)})}var ke=u(Q,2);{var ne=_=>{ta(_,{message:"Start again? Your changes will be lost.",confirmText:"Yes",cancelText:"Cancel",onConfirm:U,onCancel:Y})};$(ke,_=>{n(x)==="startAgain"&&_(ne)})}g(Ae),A(i,Ae),De(),c()}var wi=F('<div class="before-after-container svelte-1i0ztfp" role="slider" aria-label="Before and after comparison" tabindex="0"><div class="before-image svelte-1i0ztfp"><img alt="Before" class="svelte-1i0ztfp"/></div> <div class="after-image svelte-1i0ztfp"><img alt="After" class="svelte-1i0ztfp"/></div> <div class="slider-handle svelte-1i0ztfp" role="presentation"><div class="slider-line svelte-1i0ztfp"></div> <div class="slider-thumb svelte-1i0ztfp"><img src="/icons/icon-ai-slider.svg" alt="" class="slider-icon svelte-1i0ztfp"/></div></div></div>');function xi(i,a){Me(a,!1);let e=h(a,"beforeImage",8,""),t=h(a,"afterImage",8,""),o=h(a,"position",12,50),r=h(a,"onChange",8,()=>{}),d=N(),c=!1;Bt(()=>(window.addEventListener("mousemove",b),window.addEventListener("touchmove",k,{passive:!1}),window.addEventListener("mouseup",S),window.addEventListener("touchend",S),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("touchmove",k),window.removeEventListener("mouseup",S),window.removeEventListener("touchend",S)}));function s(){c=!0}function v(T){T.touches.length===1&&(c=!0)}function b(T){!c||!n(d)||x(T.clientX)}function k(T){!c||!n(d)||T.touches.length!==1||(T.preventDefault(),x(T.touches[0].clientX))}function S(){c=!1}function x(T){const I=n(d).getBoundingClientRect(),C=Math.max(0,Math.min(100,(T-I.left)/I.width*100));o(C),r()(C)}function y(T){if(!n(d))return;const I=n(d).getBoundingClientRect(),C=(T.clientX-I.left)/I.width*100;o(Math.max(0,Math.min(100,C))),r()(o())}Te();var R=wi(),l=f(R),w=f(l);g(l);var M=u(l,2),E=f(M);g(M);var L=u(M,2);g(R),ft(R,T=>z(d,T),()=>n(d)),J(()=>{_e(w,"src",e()),we(M,`clip-path: inset(0 ${100-o()}% 0 0)`),_e(E,"src",t()),we(L,`left: ${o()??""}%`)}),p("mousedown",L,s),p("touchstart",L,v),p("click",R,y),A(i,R),De()}const _a={originalImage:null,currentImage:null,processedImage:null,isProcessing:!1,processingType:null,upscaleFactor:1,showComparison:!1,comparisonPosition:50};function _i(){const{subscribe:i,set:a,update:e}=bt(_a);return{subscribe:i,setImage:t=>e(o=>({...o,originalImage:t,currentImage:t,processedImage:null})),startProcessing:t=>e(o=>({...o,isProcessing:!0,processingType:t})),finishProcessing:t=>e(o=>({...o,isProcessing:!1,processingType:null,processedImage:t,currentImage:t,showComparison:!0})),cancelProcessing:()=>e(t=>({...t,isProcessing:!1,processingType:null})),setUpscaleFactor:t=>e(o=>({...o,upscaleFactor:t})),setComparisonPosition:t=>e(o=>({...o,comparisonPosition:t})),reset:()=>a(_a)}}const et=_i(),ya=bt("enhance"),yi=ia(et,i=>i.currentImage!==null);let Lt=null;async function ki(i,a=4,e){e?.("Uploading image...");const t=await fetch("/api/face-enhance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:i,scale:a,faceEnhance:.5})}),o=await t.json();if(!t.ok)throw new Error(o.error||`API error: ${t.status}`);if(o.status==="succeeded"&&o.output)return e?.("Downloading result..."),await Fa(o.output);if(o.status==="processing"||o.status==="starting")return e?.("Processing with CodeFormer..."),await Ci(o.pollUrl,e);throw new Error("Unexpected response")}async function Ci(i,a,e=60){for(let t=0;t<e;t++){await new Promise(d=>setTimeout(d,2e3));const o=await fetch(`/api/upscale?pollUrl=${encodeURIComponent(i)}`),r=await o.json();if(!o.ok)throw new Error(r.error||`Polling error: ${o.status}`);if(r.status==="succeeded"&&r.output)return a?.("Downloading result..."),await Fa(r.output);if(r.status==="failed")throw new Error(r.error||"Upscaling failed");a?.(`Processing in cloud (${(t+1)*2}s)...`)}throw new Error("Timeout waiting for result")}async function Fa(i){const e=await(await fetch(i)).blob();return new Promise((t,o)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=o,r.readAsDataURL(e)})}async function Si(i){if(Lt)return Lt;console.log("[AI] Loading RMBG background removal model..."),i?.("Downloading model (first time only)...");const{pipeline:a,env:e}=await un(async()=>{const{pipeline:t,env:o}=await import("../chunks/bLAnV4ll.js");return{pipeline:t,env:o}},[],import.meta.url);e.allowLocalModels=!1;try{Lt=await a("image-segmentation","briaai/RMBG-1.4",{device:"webgpu",dtype:"fp32"}),console.log("[AI] RMBG model ready (WebGPU)")}catch(t){console.log("[AI] WebGPU not available, falling back to WASM...",t.message),Lt=await a("image-segmentation","briaai/RMBG-1.4",{dtype:"q8"}),console.log("[AI] RMBG model ready (WASM)")}return Lt}async function Ii(i,a){try{console.log("[AI] Starting background removal...");const e=await Si(a);a?.("Processing image...");const t=await e(i);if(console.log("[AI] Segmentation result:",t),!t||t.length===0)throw new Error("No segmentation result returned");const o=t[0];if(console.log("[AI] Segment keys:",Object.keys(o)),o.mask&&o.mask.toDataURL)return console.log("[AI] Background removal complete (RawImage mask)"),await ka(i,o.mask);if(o.mask&&o.mask.data)return console.log("[AI] Background removal complete (data mask)"),await ka(i,o.mask);if(typeof o=="string"&&o.startsWith("data:"))return console.log("[AI] Background removal complete (direct output)"),o;throw console.log("[AI] Segment structure:",JSON.stringify(o,null,2).substring(0,500)),new Error("Unexpected segmentation result format")}catch(e){throw console.error("[AI] Background removal failed:",e),new Error("Background removal failed: "+e.message)}}async function ka(i,a){return new Promise((e,t)=>{const o=new Image;o.onload=async()=>{try{const r=document.createElement("canvas");r.width=o.width,r.height=o.height;const d=r.getContext("2d");d.drawImage(o,0,0);const c=d.getImageData(0,0,r.width,r.height),s=c.data;let v,b,k;if(a.toDataURL){const x=document.createElement("canvas");x.width=a.width,x.height=a.height;const y=x.getContext("2d"),R=new Image;R.onload=()=>{y.drawImage(R,0,0);const l=y.getImageData(0,0,a.width,a.height);Ca(s,l.data,r.width,r.height,a.width,a.height,!0),d.putImageData(c,0,0),e(r.toDataURL("image/png"))},R.onerror=t,R.src=a.toDataURL();return}else v=a.data,b=a.width,k=a.height;const S=v.length===b*k*4;Ca(s,v,r.width,r.height,b,k,S),d.putImageData(c,0,0),e(r.toDataURL("image/png"))}catch(r){t(r)}},o.onerror=t,o.src=i})}function Ca(i,a,e,t,o,r,d){const c=o/e,s=r/t;for(let v=0;v<t;v++)for(let b=0;b<e;b++){const k=Math.floor(b*c),S=Math.floor(v*s);let x;if(d){const R=(S*o+k)*4;x=a[R]}else{const R=S*o+k;x=a[R]||0}const y=(v*e+b)*4;i[y+3]=x}}var zi=F('<div class="size-display svelte-1rgvkgu"> </div>'),Ri=F('<button class="processing-btn svelte-1rgvkgu" disabled><span class="spinner svelte-1rgvkgu"></span> </button> <button class="cancel-btn svelte-1rgvkgu">Cancel</button>',1),Bi=F('<button class="upscale-btn svelte-1rgvkgu"><img src="/icons/icon-ai.svg" alt="" class="btn-icon svelte-1rgvkgu"/> Upscale image</button> <p class="hint svelte-1rgvkgu">Upscales, sharpens and enhances images</p>',1),Ei=F('<div class="error-message svelte-1rgvkgu"> </div>'),Pi=F('<div class="upscale-controls svelte-1rgvkgu"><div class="controls-content svelte-1rgvkgu"><!> <!> <!></div></div>');function Li(i,a){Me(a,!1);const e=()=>it(et,"$aiState",t),[t,o]=Rt(),r=4;let d=N(!1),c=N(""),s=N(null),v=N(null);async function b(){try{const I=await mt(e().originalImage),C=Math.round(I.naturalWidth*r),P=Math.round(I.naturalHeight*r);z(v,`${C} x ${P}`)}catch(I){console.error("Failed to get image dimensions:",I)}}async function k(){if(e().originalImage)try{z(d,!0),z(s,null),z(c,"Starting..."),et.startProcessing("upscale");const I=await ki(e().originalImage,r,C=>{z(c,C)});et.finishProcessing(I)}catch(I){z(s,I.message||"Upscaling failed"),et.cancelProcessing()}finally{z(d,!1),z(c,"")}}function S(){z(d,!1),z(c,""),z(s,null),et.cancelProcessing()}Ne(()=>e(),()=>{e().originalImage&&b()}),pt(),Te();var x=Pi(),y=f(x),R=f(y);{var l=I=>{var C=zi(),P=f(C);g(C),J(()=>Ue(P,`Output: ${n(v)??""}`)),A(I,C)};$(R,I=>{n(v)&&I(l)})}var w=u(R,2);{var M=I=>{var C=Ri(),P=je(C),U=u(f(P));g(P);var Y=u(P,2);J(()=>Ue(U,` ${n(c)||"Processing..."}`)),p("click",Y,S),A(I,C)},E=I=>{var C=Bi(),P=je(C);_t(2),p("click",P,k),A(I,C)};$(w,I=>{n(d)?I(M):I(E,!1)})}var L=u(w,2);{var T=I=>{var C=Ei(),P=f(C,!0);g(C),J(()=>Ue(P,n(s))),A(I,C)};$(L,I=>{n(s)&&I(T)})}g(y),g(x),A(i,x),De(),o()}var Mi=F('<img alt="Original" class="compare-overlay svelte-1ibkqf6"/>'),Di=F('<div class="brush-indicator svelte-1ibkqf6"></div>'),Ti=F('<div class="brush-preview svelte-1ibkqf6"></div>'),Ai=F('<div class="drawer-overlay svelte-1ibkqf6" role="presentation"><div class="drawer svelte-1ibkqf6" role="dialog"><div class="drawer-header svelte-1ibkqf6"><button class="icon-btn svelte-1ibkqf6" title="Undo"><img src="/icons/icon-undo.svg" alt="Undo" class="svelte-1ibkqf6"/></button> <button class="icon-btn svelte-1ibkqf6" title="Redo"><img src="/icons/icon-redo.svg" alt="Redo" class="svelte-1ibkqf6"/></button> <div class="spacer svelte-1ibkqf6"></div> <button title="Compare"><img src="/icons/icon-compare.svg" alt="Compare" class="svelte-1ibkqf6"/></button></div> <div class="canvas-container svelte-1ibkqf6"><div class="canvas-wrapper svelte-1ibkqf6" role="presentation"><canvas class="svelte-1ibkqf6"></canvas> <!> <!> <!></div></div> <div class="controls-section svelte-1ibkqf6"><div class="button-group svelte-1ibkqf6"><button><img src="/icons/icon-erase.svg" alt="" class="svelte-1ibkqf6"/> Erase</button> <button><img src="/icons/icon-restore.svg" alt="" class="svelte-1ibkqf6"/> Restore</button></div> <div class="control-row svelte-1ibkqf6"><label class="svelte-1ibkqf6">Brush size</label> <div class="control-item svelte-1ibkqf6"><!> <button class="reset-btn svelte-1ibkqf6" title="Reset"><img src="/icons/icon-reset.svg" alt="Reset" class="svelte-1ibkqf6"/></button></div></div> <div class="control-row svelte-1ibkqf6"><label class="svelte-1ibkqf6">Soften edges</label> <div class="control-item svelte-1ibkqf6"><!> <button class="reset-btn svelte-1ibkqf6" title="Reset"><img src="/icons/icon-reset.svg" alt="Reset" class="svelte-1ibkqf6"/></button></div></div> <div class="control-row svelte-1ibkqf6"><label class="svelte-1ibkqf6">Zoom in</label> <div class="control-item svelte-1ibkqf6"><!> <button class="reset-btn svelte-1ibkqf6" title="Reset"><img src="/icons/icon-reset.svg" alt="Reset" class="svelte-1ibkqf6"/></button></div></div> <div class="nudge-buttons svelte-1ibkqf6"><button class="nudge-btn svelte-1ibkqf6">â</button> <button class="nudge-btn svelte-1ibkqf6">â</button> <button class="nudge-btn svelte-1ibkqf6">â</button> <button class="nudge-btn svelte-1ibkqf6">â</button></div> <div class="drawer-footer svelte-1ibkqf6"><button class="btn-cancel svelte-1ibkqf6">Cancel</button> <button class="btn-done svelte-1ibkqf6">Done</button></div></div></div></div>');function Fi(i,a){Me(a,!1);const e=N();let t=h(a,"image",8,""),o=h(a,"originalFullImage",8,""),r=h(a,"onClose",8,()=>{}),d=h(a,"onSave",8,()=>{}),c=N(),s=N(),v,b=N(!0),k=N(20),S=N(50),x=N(1),y=N(0),R=N(0),l=!1,w=[],M=0,E=null,L=N({x:0,y:0,visible:!1}),T=N(!1),I=N(0),C=N(0),P=N(!1);Bt(async()=>{const G=await mt(t());ga(c,n(c).width=G.naturalWidth),ga(c,n(c).height=G.naturalHeight),v=n(c).getContext("2d"),v.drawImage(G,0,0),o()?E=await mt(o()):E=G,U(),Y()});function U(){if(n(s)){const G=n(s).getBoundingClientRect();z(I,G.width),z(C,G.height)}}function Y(){w=w.slice(0,M+1),w.push(n(c).toDataURL()),M=w.length-1}function ee(){M>0&&(M--,oe())}function me(){M<w.length-1&&(M++,oe())}function oe(){const G=new Image;G.onload=()=>{v.clearRect(0,0,n(c).width,n(c).height),v.drawImage(G,0,0)},G.src=w[M]}function K(G){const pe=n(s).getBoundingClientRect(),$e=n(c).width/pe.width,tt=n(c).height/pe.height,Et=(G.clientX-pe.left)*$e,Ot=(G.clientY-pe.top)*tt;return{x:Et,y:Ot}}function fe(G){l=!0;const{x:pe,y:$e}=K(G);ge(pe,$e)}function q(G){const pe=n(s).getBoundingClientRect();if(z(L,{x:G.clientX-pe.left,y:G.clientY-pe.top,visible:!0}),!l)return;const{x:$e,y:tt}=K(G);ge($e,tt)}function W(){l&&(l=!1,Y())}function se(){z(L,{...n(L),visible:!1}),l&&(l=!1,Y())}function ge(G,pe){const $e=n(c).width/n(s).getBoundingClientRect().width,tt=n(e)/2*$e,Et=n(S)/100,Ot=Math.min(tt-.001,tt*(1-Et));v.save();try{if(n(b)){const ut=v.createRadialGradient(G,pe,Ot,G,pe,tt);ut.addColorStop(0,"rgba(0,0,0,1)"),ut.addColorStop(1,"rgba(0,0,0,0)"),v.globalCompositeOperation="destination-out",v.fillStyle=ut,v.beginPath(),v.arc(G,pe,tt,0,Math.PI*2),v.fill()}else{if(!E)return;const ut=document.createElement("canvas");ut.width=n(c).width,ut.height=n(c).height;const wt=ut.getContext("2d"),Wt=wt.createRadialGradient(G,pe,Ot,G,pe,tt);Wt.addColorStop(0,"rgba(0,0,0,1)"),Wt.addColorStop(1,"rgba(0,0,0,0)"),wt.globalCompositeOperation="source-over",wt.drawImage(E,0,0,ut.width,ut.height),wt.globalCompositeOperation="destination-in",wt.fillStyle=Wt,wt.beginPath(),wt.arc(G,pe,tt,0,Math.PI*2),wt.fill(),v.globalCompositeOperation="source-over",v.drawImage(ut,0,0)}}finally{v.restore()}}function Be(){z(k,20)}function ye(){z(S,50)}function Ke(){z(x,1),z(y,0),z(R,0)}function H(G){switch(G){case"up":z(R,n(R)-10);break;case"down":z(R,n(R)+10);break;case"left":z(y,n(y)-10);break;case"right":z(y,n(y)+10);break}}function X(){r()()}function te(){const G=n(c).toDataURL("image/png");d()(G)}Ne(()=>(n(k),n(I),n(C)),()=>{z(e,n(k)/100*Math.min(n(I)||300,n(C)||300)*.5)}),pt(),Te();var be=Ai(),de=f(be),ze=f(de),Ee=f(ze),Fe=u(Ee,2),qe=u(Fe,4);let Ge;g(ze);var Qe=u(ze,2),he=f(Qe),Oe=f(he);ft(Oe,G=>z(c,G),()=>n(c));var O=u(Oe,2);{var He=G=>{var pe=Mi();J(()=>_e(pe,"src",o())),A(G,pe)};$(O,G=>{n(P)&&o()&&G(He)})}var nt=u(O,2);{var ae=G=>{var pe=Di();J(()=>we(pe,`
							left: ${n(L),m(()=>n(L).x)??""}px;
							top: ${n(L),m(()=>n(L).y)??""}px;
							width: ${n(e)??""}px;
							height: ${n(e)??""}px;
						`)),A(G,pe)};$(nt,G=>{n(L),n(I),m(()=>n(L).visible&&n(I)>0)&&G(ae)})}var re=u(nt,2);{var Ie=G=>{var pe=Ti();J(()=>we(pe,`
						left: ${n(I)/2}px;
						top: ${n(C)/2}px;
						width: ${n(e)??""}px;
						height: ${n(e)??""}px;
					`)),A(G,pe)};$(re,G=>{n(T)&&n(I)>0&&n(C)>0&&G(Ie)})}g(he),ft(he,G=>z(s,G),()=>n(s)),g(Qe);var We=u(Qe,2),Ve=f(We),Ae=f(Ve);let B;var Z=u(Ae,2);let ce;g(Ve);var Q=u(Ve,2),le=u(f(Q),2),ke=f(le);Ze(ke,{min:5,max:100,step:1,get value(){return n(k)},onChange:G=>z(k,G),onInteractionStart:()=>{U(),z(T,!0)},onInteractionEnd:()=>z(T,!1)});var ne=u(ke,2);g(le),g(Q);var _=u(Q,2),D=u(f(_),2),j=f(D);Ze(j,{min:0,max:100,step:1,get value(){return n(S)},onChange:G=>z(S,G)});var ie=u(j,2);g(D),g(_);var V=u(_,2),xe=u(f(V),2),Ce=f(xe);Ze(Ce,{min:1,max:3,step:.1,get value(){return n(x)},onChange:G=>z(x,G)});var Se=u(Ce,2);g(xe),g(V);var Re=u(V,2),Pe=f(Re),ot=u(Pe,2),Xe=u(ot,2),kt=u(Xe,2);g(Re);var rt=u(Re,2),lt=f(rt),yt=u(lt,2);g(rt),g(We),g(de),g(be),J(()=>{Ge=ue(qe,1,"icon-btn svelte-1ibkqf6",null,Ge,{active:n(P)}),we(he,`transform: scale(${n(x)??""}) translate(${n(y)??""}px, ${n(R)??""}px)`),B=ue(Ae,1,"mode-btn svelte-1ibkqf6",null,B,{active:n(b)}),ce=ue(Z,1,"mode-btn svelte-1ibkqf6",null,ce,{active:!n(b)})}),p("click",Ee,ee),p("click",Fe,me),p("mousedown",qe,()=>z(P,!0)),p("mouseup",qe,()=>z(P,!1)),p("mouseleave",qe,()=>z(P,!1)),p("touchstart",qe,()=>z(P,!0)),p("touchend",qe,()=>z(P,!1)),p("mousedown",he,fe),p("mousemove",he,q),p("mouseup",he,W),p("mouseleave",he,se),p("click",Ae,()=>z(b,!0)),p("click",Z,()=>z(b,!1)),p("click",ne,Be),p("click",ie,ye),p("click",Se,Ke),p("click",Pe,()=>H("up")),p("click",ot,()=>H("down")),p("click",Xe,()=>H("left")),p("click",kt,()=>H("right")),p("click",lt,X),p("click",yt,te),p("click",de,st(function(G){Kt.call(this,a,G)})),p("click",be,X),A(i,be),De()}var qi=F('<button class="processing-btn svelte-1wdmsm1" disabled><span class="spinner svelte-1wdmsm1"></span> </button> <button class="cancel-btn svelte-1wdmsm1">Cancel</button>',1),Oi=F('<button class="remove-btn svelte-1wdmsm1"><img src="/icons/icon-ai.svg" alt="" class="btn-icon svelte-1wdmsm1"/> Remove background</button> <p class="hint svelte-1wdmsm1">Remove image background with AI</p> <button class="erase-btn svelte-1wdmsm1"><img src="/icons/icon-erase.svg" alt="" class="btn-icon svelte-1wdmsm1"/> Erase and restore</button> <p class="hint svelte-1wdmsm1">Manually clean up background</p>',1),Hi=F('<div class="error-message svelte-1wdmsm1"> </div>'),Ui=F('<div class="background-controls svelte-1wdmsm1"><div class="controls-content svelte-1wdmsm1"><!> <!></div> <!></div>');function Wi(i,a){Me(a,!1);const e=()=>it(et,"$aiState",t),[t,o]=Rt(),r=N();let d=N(!1),c=N(""),s=N(null),v=N(!1);async function b(){if(e().originalImage)try{z(d,!0),z(s,null),z(c,"Starting..."),et.startProcessing("background");const C=await Ii(e().originalImage,P=>{z(c,P)});et.finishProcessing(C)}catch(C){z(s,C.message||"Background removal failed"),et.cancelProcessing()}finally{z(d,!1),z(c,"")}}function k(){z(d,!1),z(c,""),z(s,null),et.cancelProcessing()}function S(){z(v,!0)}function x(){z(v,!1)}Ne(()=>e(),()=>{z(r,e().showComparison&&e().processedImage)}),pt(),Te();var y=Ui(),R=f(y),l=f(R);{var w=C=>{var P=qi(),U=je(P),Y=u(f(U));g(U);var ee=u(U,2);J(()=>Ue(Y,` ${n(c)||"Processing..."}`)),p("click",ee,k),A(C,P)},M=C=>{var P=Oi(),U=je(P),Y=u(U,4);_t(2),J(()=>Y.disabled=!n(r)),p("click",U,b),p("click",Y,S),A(C,P)};$(l,C=>{n(d)?C(w):C(M,!1)})}var E=u(l,2);{var L=C=>{var P=Hi(),U=f(P,!0);g(P),J(()=>Ue(U,n(s))),A(C,P)};$(E,C=>{n(s)&&C(L)})}g(R);var T=u(R,2);{var I=C=>{Fi(C,{get image(){return e(),m(()=>e().processedImage)},get originalFullImage(){return e(),m(()=>e().originalImage)},onClose:x,onSave:P=>{et.finishProcessing(P),z(v,!1)}})};$(T,C=>{n(v)&&C(I)})}g(y),A(i,y),De(),o()}var ji=F('<img alt="Working image" class="working-image svelte-17agwu4"/>'),Ni=F('<!> <div class="image-container svelte-17agwu4"><!></div> <!> <!>',1),Yi=F('<div class="ai-tab svelte-17agwu4"><!></div>');function Xi(i,a){Me(a,!1);const e=()=>it(et,"$aiState",r),t=()=>it(yi,"$hasAiImage",r),o=()=>it(ya,"$activeAiMenu",r),[r,d]=Rt();let c=N(50);function s(M){z(c,M),et.setComparisonPosition(M)}const v=[{id:"upscale",label:"Upscale"},{id:"background",label:"Remove background"}];function b(M){et.setImage(M)}function k(M){ya.set(M)}async function S(){e().currentImage&&await $t(e().currentImage)}function x(){e().currentImage&&ea(e().currentImage,"picflam-ai.png")}Te();var y=Yi(),R=f(y);{var l=M=>{Ta(M,{title:"Upscale and remove backgrounds using AI power",hint:"Import, drag or paste an image",onImageImport:b})},w=M=>{var E=Ni(),L=je(E);la(L,{canUndo:!1,canRedo:!1,onUndo:()=>{},onRedo:()=>{},onStartAgain:()=>et.reset(),onCopy:S,onExport:x});var T=u(L,2),I=f(T);{var C=oe=>{xi(oe,{get beforeImage(){return e().originalImage},get afterImage(){return e().processedImage},get position(){return n(c)},onChange:s})},P=oe=>{var K=ji();J(()=>_e(K,"src",e().currentImage)),A(oe,K)};$(I,oe=>{e().showComparison&&e().processedImage?oe(C):oe(P,!1)})}g(T);var U=u(T,2);sa(U,{get tabs(){return v},get activeTab(){return o()},onTabChange:k});var Y=u(U,2);{var ee=oe=>{Li(oe,{})},me=oe=>{var K=gt(),fe=je(K);{var q=W=>{Wi(W,{})};$(fe,W=>{o()==="background"&&W(q)},!0)}A(oe,K)};$(Y,oe=>{o()==="upscale"?oe(ee):oe(me,!1)})}A(M,E)};$(R,M=>{t()?M(w,!1):M(l)})}g(y),A(i,y),De(),d()}var Gi=F('<div class="size-controls svelte-1l8e210"><!></div>');function Qi(i,a){Me(a,!1);let e=h(a,"canvasSize",8,"1/1"),t=h(a,"onSizeChange",8,s=>{});const o=[{id:"9/16",label:"9:16",icon:"icon-vertical"},{id:"1/1",label:"1:1",icon:"icon-square"},{id:"16/9",label:"16:9",icon:"icon-horizontal"}];function r(s){t()(s)}Te();var d=Gi(),c=f(d);Aa(c,{get options(){return o},get value(){return e()},onChange:r,showLabels:!0,centered:!0}),g(d),A(i,d),De()}var Vi=F("<button></button>"),Ji=F('<div class="color-picker-popover svelte-x97jji"><input type="color" class="svelte-x97jji"/></div>'),Zi=F('<button aria-label="Custom color"></button> <!>',1),Ki=F('<div class="color-swatches svelte-x97jji"><!> <!></div>');function zt(i,a){Me(a,!1);let e=h(a,"colors",24,()=>[]),t=h(a,"value",8,""),o=h(a,"onChange",8,S=>{}),r=h(a,"showRainbow",8,!0),d=N(!1),c=N("#5422b0");Te();var s=Ki(),v=f(s);vt(v,1,e,dt,(S,x)=>{var y=Vi();let R;J(()=>{R=ue(y,1,"swatch svelte-x97jji",null,R,{active:t()===n(x),white:n(x)==="#FFFFFF"}),we(y,`background-color: ${n(x)??""};`),_e(y,"aria-label",`Select color ${n(x)??""}`)}),p("click",y,()=>o()(n(x))),A(S,y)});var b=u(v,2);{var k=S=>{var x=Zi(),y=je(x);let R;var l=u(y,2);{var w=M=>{var E=Ji(),L=f(E);Ft(L),g(E),kn(L,()=>n(c),T=>z(c,T)),p("change",L,()=>o()(n(c))),A(M,E)};$(l,M=>{n(d)&&M(w)})}J(M=>R=ue(y,1,"swatch rainbow svelte-x97jji",null,R,M),[()=>({active:!e().includes(t())&&t()!=="transparent"})]),p("click",y,()=>z(d,!n(d))),A(S,x)};$(b,S=>{r()&&S(k)})}g(s),A(i,s),De()}const It={solids:["#FFFFFF","#000000","#007C1F","#00679D","#B20715"],gradients:["linear-gradient(135deg, #5422b0 0%, #4B0082 100%)","linear-gradient(135deg, #15509B 0%, #20244F 100%)","linear-gradient(135deg, #A8076B 0%, #62045F 100%)","linear-gradient(135deg, #EA5C56 0%, #3C0C40 100%)","linear-gradient(135deg, #0A8F9D 0%, #202B54 100%)","linear-gradient(135deg, #D17A29 0%, #41363C 100%)"]},qa=["Inter","Roboto Slab","Saira Condensed","Lora","Playfair Display","Special Elite"],Mt={up:"to top",down:"to bottom",left:"to left",right:"to right"},$i={canvasSize:"1/1",background:{type:"solid",value:"#FFFFFF",direction:"down",gradientColors:["#5422b0","#4B0082"]},text1:"",text1Font:"Inter",text1Size:5,text1YPosition:3,text1LineSpacing:5,text1Color:"#000000",text1HighlightColor:"transparent",text1IsBold:!0,text1Align:"center",text1QuoteStyle:"none",text1QuoteSize:5,text2:"",text2Font:"Inter",text2Size:3,text2YPosition:8,text2LineSpacing:5,text2Color:"#000000",text2LabelColor:"transparent",text2IsBold:!1,text2Align:"center",overlay:null,overlaySize:50,overlayOpacity:100,overlayX:50,overlayY:50,overlayMask:"none",overlayLayer:"above",overlayBorderWidth:0,overlayBorderColor:"#FFFFFF",overlayNaturalWidth:0,overlayNaturalHeight:0};function eo(i){const a=[JSON.parse(JSON.stringify(i))];let e=0;const{subscribe:t,set:o,update:r}=bt(i);return{subscribe:t,set:d=>{a.splice(e+1),a.push(JSON.parse(JSON.stringify(d))),e=a.length-1,o(d)},update:d=>{r(c=>{const s=d(c);return a.splice(e+1),a.push(JSON.parse(JSON.stringify(s))),e=a.length-1,s})},undo:()=>e>0?(e--,o(JSON.parse(JSON.stringify(a[e]))),!0):!1,redo:()=>e<a.length-1?(e++,o(JSON.parse(JSON.stringify(a[e]))),!0):!1,canUndo:()=>e>0,canRedo:()=>e<a.length-1,reset:()=>{const d=JSON.parse(JSON.stringify(i));a.length=0,a.push(d),e=0,o(d)}}}const Ye=eo($i),aa=bt(!0),ct=bt("none");ia(Ye,i=>i.text1||i.text2||i.overlay||i.background.value!=="#FFFFFF");function to(){Ye.reset(),aa.set(!0),ct.set("none")}var ao=F('<button aria-label="Select gradient"></button>'),no=F('<div class="background-controls svelte-18tfgkp"><div class="section svelte-18tfgkp"><div class="color-row svelte-18tfgkp"><!></div></div> <div class="section svelte-18tfgkp"><div class="gradient-row svelte-18tfgkp"></div></div> <div class="section svelte-18tfgkp"><div class="gradient-preview-row svelte-18tfgkp"><button class="gradient-endpoint svelte-18tfgkp" aria-label="Edit start color"></button> <div class="gradient-preview svelte-18tfgkp"></div> <button class="gradient-endpoint svelte-18tfgkp" aria-label="Edit end color"></button></div></div> <div class="section svelte-18tfgkp"><div><button aria-label="Gradient direction up"><img src="/icons/icon-nudge-up.svg" alt="" class="direction-icon svelte-18tfgkp"/></button> <button aria-label="Gradient direction down"><img src="/icons/icon-nudge-down.svg" alt="" class="direction-icon svelte-18tfgkp"/></button> <button aria-label="Gradient direction left"><img src="/icons/icon-nudge-left.svg" alt="" class="direction-icon svelte-18tfgkp"/></button> <button aria-label="Gradient direction right"><img src="/icons/icon-nudge-right.svg" alt="" class="direction-icon svelte-18tfgkp"/></button></div></div></div>');function io(i,a){Me(a,!1);const e=N();let t=h(a,"background",24,()=>({type:"solid",value:"#FFFFFF",direction:"down",gradientColors:["#5422b0","#4B0082"]})),o=h(a,"onBackgroundChange",8,q=>{});const r=It.gradients.map(q=>{const W=q.match(/#[A-Fa-f0-9]{6}/g);return W?[W[0],W[1]]:["#5422b0","#4B0082"]});function d(q){o()({...t(),type:"solid",value:q})}function c(q){const W=r[q],se=Mt[t().direction]||"to bottom";o()({...t(),type:"gradient",value:`linear-gradient(${se}, ${W[0]} 0%, ${W[1]} 100%)`,gradientColors:W})}function s(q){const W=Mt[q],se=t().gradientColors||["#5422b0","#4B0082"];o()({...t(),direction:q,value:`linear-gradient(${W}, ${se[0]} 0%, ${se[1]} 100%)`})}function v(q,W){const se=[...t().gradientColors||["#5422b0","#4B0082"]];se[q]=W;const ge=Mt[t().direction]||"to bottom";o()({...t(),type:"gradient",value:`linear-gradient(${ge}, ${se[0]} 0%, ${se[1]} 100%)`,gradientColors:se})}Ne(()=>(Le(t()),Mt),()=>{z(e,t().type==="gradient"?`linear-gradient(${Mt[t().direction]||"to bottom"}, ${t().gradientColors?.[0]||"#5422b0"} 0%, ${t().gradientColors?.[1]||"#4B0082"} 100%)`:`linear-gradient(to bottom, ${r[0][0]} 0%, ${r[0][1]} 100%)`)}),pt(),Te();var b=no(),k=f(b),S=f(k),x=f(S);{let q=Je(()=>(Le(t()),m(()=>t().type==="solid"?t().value:"")));zt(x,{get colors(){return Le(It),m(()=>It.solids)},get value(){return n(q)},onChange:d,showRainbow:!0})}g(S),g(k);var y=u(k,2),R=f(y);vt(R,5,()=>r,dt,(q,W,se)=>{var ge=ao();let Be;J(()=>{Be=ue(ge,1,"gradient-swatch svelte-18tfgkp",null,Be,{active:t().type==="gradient"&&t().gradientColors?.[0]===n(W)[0]&&t().gradientColors?.[1]===n(W)[1]}),we(ge,`background: linear-gradient(135deg, ${n(W),m(()=>n(W)[0])??""} 0%, ${n(W),m(()=>n(W)[1])??""} 100%);`)}),p("click",ge,()=>c(se)),A(q,ge)}),g(R),g(y);var l=u(y,2),w=f(l),M=f(w),E=u(M,2),L=u(E,2);g(w),g(l);var T=u(l,2),I=f(T);let C;var P=f(I);let U;var Y=u(P,2);let ee;var me=u(Y,2);let oe;var K=u(me,2);let fe;g(I),g(T),g(b),J(()=>{we(M,`background-color: ${Le(t()),m(()=>t().gradientColors?.[0]||"#5422b0")??""};`),we(E,`background: ${n(e)??""};`),we(L,`background-color: ${Le(t()),m(()=>t().gradientColors?.[1]||"#4B0082")??""};`),C=ue(I,1,"direction-row svelte-18tfgkp",null,C,{inactive:t().type!=="gradient"}),U=ue(P,1,"direction-btn svelte-18tfgkp",null,U,{active:t().direction==="up"}),ee=ue(Y,1,"direction-btn svelte-18tfgkp",null,ee,{active:t().direction==="down"}),oe=ue(me,1,"direction-btn svelte-18tfgkp",null,oe,{active:t().direction==="left"}),fe=ue(K,1,"direction-btn svelte-18tfgkp",null,fe,{active:t().direction==="right"})}),p("click",M,()=>{const q=document.createElement("input");q.type="color",q.value=t().gradientColors?.[0]||"#5422b0",q.addEventListener("input",W=>v(0,W.target.value)),q.click()}),p("click",L,()=>{const q=document.createElement("input");q.type="color",q.value=t().gradientColors?.[1]||"#4B0082",q.addEventListener("input",W=>v(1,W.target.value)),q.click()}),p("click",P,()=>s("up")),p("click",Y,()=>s("down")),p("click",me,()=>s("left")),p("click",K,()=>s("right")),A(i,b),De()}var oo=F("<button> </button>"),ro=F('<div class="font-dropdown-menu svelte-fspusj"></div>'),lo=F('<div class="text1-controls svelte-fspusj"><div class="text-input-container svelte-fspusj"><textarea class="text-input svelte-fspusj" placeholder="How to ==highlight== text"></textarea> <div class="resize-handle svelte-fspusj"></div></div> <div class="font-row svelte-fspusj"><span class="row-label svelte-fspusj">Font</span> <div class="font-dropdown-wrapper svelte-fspusj"><button class="font-dropdown-trigger svelte-fspusj"> <span class="dropdown-arrow svelte-fspusj">â¾</span></button> <!></div> <button aria-label="Bold"><img src="/icons/icon-bold.svg" alt="" class="btn-icon svelte-fspusj"/></button> <button class="icon-btn svelte-fspusj"><img alt="" class="btn-icon svelte-fspusj"/></button></div> <div class="slider-row svelte-fspusj"><!> <button class="reset-btn svelte-fspusj" aria-label="Reset size"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-fspusj"/></button></div> <div class="slider-row svelte-fspusj"><!> <button class="reset-btn svelte-fspusj" aria-label="Reset position"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-fspusj"/></button></div> <div class="slider-row svelte-fspusj"><!> <button class="reset-btn svelte-fspusj" aria-label="Reset line spacing"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-fspusj"/></button></div> <div class="color-section svelte-fspusj"><span class="section-label svelte-fspusj">Text colour</span> <!></div> <div class="color-section svelte-fspusj"><span class="section-label svelte-fspusj">Highlight colour</span> <!></div></div>');function so(i,a){Me(a,!1);let e=h(a,"text1",8,""),t=h(a,"text1Font",8,"Inter"),o=h(a,"text1Size",8,5),r=h(a,"text1YPosition",8,3),d=h(a,"text1LineSpacing",8,5),c=h(a,"text1Color",8,"#000000"),s=h(a,"text1HighlightColor",8,"transparent"),v=h(a,"text1IsBold",8,!0),b=h(a,"text1Align",8,"center"),k=h(a,"onChange",8,(O,He)=>{});const S=It.solids,x=["#FFD700","#000000","#007C1F","#00679D","#B20715"],y=["left","center","right"],R={text1Size:5,text1YPosition:3,text1LineSpacing:5};let l=N(!1),w=N();function M(O){n(w)&&!n(w).contains(O.target)&&z(l,!1)}Bt(()=>{document.addEventListener("click",M)}),oa(()=>{document.removeEventListener("click",M)});function E(O){k()("text1",O.target.value)}function L(O){k()("text1Font",O),z(l,!1)}function T(){k()("text1IsBold",!v())}function I(){const He=(y.indexOf(b())+1)%y.length;k()("text1Align",y[He])}function C(O){k()("text1Color",O)}function P(O){k()("text1HighlightColor",O===s()?"transparent":O)}function U(O){k()(O,R[O])}Te();var Y=lo(),ee=f(Y),me=f(ee);La(me),_t(2),g(ee);var oe=u(ee,2),K=u(f(oe),2),fe=f(K),q=f(fe);_t(),g(fe);var W=u(fe,2);{var se=O=>{var He=ro();vt(He,5,()=>qa,dt,(nt,ae)=>{var re=oo();let Ie;var We=f(re,!0);g(re),J(()=>{Ie=ue(re,1,"font-option svelte-fspusj",null,Ie,{selected:t()===n(ae)}),we(re,`font-family: '${n(ae)??""}'`),Ue(We,n(ae)==="Inter"?"Inter (Default)":n(ae))}),p("click",re,()=>L(n(ae))),A(nt,re)}),g(He),A(O,He)};$(W,O=>{n(l)&&O(se)})}g(K),ft(K,O=>z(w,O),()=>n(w));var ge=u(K,2);let Be;var ye=u(ge,2),Ke=f(ye);g(ye),g(oe);var H=u(oe,2),X=f(H);Ze(X,{label:"Size",min:1,max:10,get value(){return o()},onChange:O=>k()("text1Size",O)});var te=u(X,2);g(H);var be=u(H,2),de=f(be);Ze(de,{label:"Position",min:0,max:10,get value(){return r()},onChange:O=>k()("text1YPosition",O)});var ze=u(de,2);g(be);var Ee=u(be,2),Fe=f(Ee);Ze(Fe,{label:"Line spacing",min:1,max:10,get value(){return d()},onChange:O=>k()("text1LineSpacing",O)});var qe=u(Fe,2);g(Ee);var Ge=u(Ee,2),Qe=u(f(Ge),2);zt(Qe,{get colors(){return S},get value(){return c()},onChange:C,showRainbow:!0}),g(Ge);var he=u(Ge,2),Oe=u(f(he),2);zt(Oe,{get colors(){return x},get value(){return s()},onChange:P,showRainbow:!0}),g(he),g(Y),J(()=>{qt(me,e()),we(fe,`font-family: '${t()??""}'`),Ue(q,`${(t()==="Inter"?"Inter (Default)":t())??""} `),Be=ue(ge,1,"icon-btn svelte-fspusj",null,Be,{active:v()}),_e(ye,"aria-label",`Align ${b()??""}`),_e(Ke,"src",`/icons/icon-align-${b()??""}.svg`)}),p("input",me,E),p("click",fe,()=>z(l,!n(l))),p("click",ge,T),p("click",ye,I),p("click",te,()=>U("text1Size")),p("click",ze,()=>U("text1YPosition")),p("click",qe,()=>U("text1LineSpacing")),A(i,Y),De()}var co=F("<button> </button>"),vo=F('<div class="font-dropdown-menu svelte-n6z268"></div>'),uo=F('<div class="text2-controls svelte-n6z268"><div class="text-input-container svelte-n6z268"><textarea class="text-input svelte-n6z268" placeholder="How to ==highlight== text"></textarea> <div class="resize-handle svelte-n6z268"></div></div> <div class="font-row svelte-n6z268"><span class="row-label svelte-n6z268">Font</span> <div class="font-dropdown-wrapper svelte-n6z268"><button class="font-dropdown-trigger svelte-n6z268"> <span class="dropdown-arrow svelte-n6z268">â¾</span></button> <!></div> <button aria-label="Bold"><img src="/icons/icon-bold.svg" alt="" class="btn-icon svelte-n6z268"/></button> <button class="icon-btn svelte-n6z268"><img alt="" class="btn-icon svelte-n6z268"/></button></div> <div class="slider-row svelte-n6z268"><!> <button class="reset-btn svelte-n6z268" aria-label="Reset size"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-n6z268"/></button></div> <div class="slider-row svelte-n6z268"><!> <button class="reset-btn svelte-n6z268" aria-label="Reset position"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-n6z268"/></button></div> <div class="slider-row svelte-n6z268"><!> <button class="reset-btn svelte-n6z268" aria-label="Reset line spacing"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-n6z268"/></button></div> <div class="color-section svelte-n6z268"><span class="section-label svelte-n6z268">Text colour</span> <!></div> <div class="color-section svelte-n6z268"><span class="section-label svelte-n6z268">Highlight colour</span> <!></div></div>');function go(i,a){Me(a,!1);let e=h(a,"text2",8,""),t=h(a,"text2Font",8,"Inter"),o=h(a,"text2Size",8,3),r=h(a,"text2YPosition",8,8),d=h(a,"text2LineSpacing",8,5),c=h(a,"text2Color",8,"#000000"),s=h(a,"text2LabelColor",8,"transparent"),v=h(a,"text2IsBold",8,!1),b=h(a,"text2Align",8,"center"),k=h(a,"onChange",8,(O,He)=>{});const S=It.solids,x=["#FFD700","#000000","#007C1F","#00679D","#B20715"],y=["left","center","right"],R={text2Size:3,text2YPosition:8,text2LineSpacing:5};let l=N(!1),w=N();function M(O){n(w)&&!n(w).contains(O.target)&&z(l,!1)}Bt(()=>{document.addEventListener("click",M)}),oa(()=>{document.removeEventListener("click",M)});function E(O){k()("text2",O.target.value)}function L(O){k()("text2Font",O),z(l,!1)}function T(){k()("text2IsBold",!v())}function I(){const He=(y.indexOf(b())+1)%y.length;k()("text2Align",y[He])}function C(O){k()("text2Color",O)}function P(O){k()("text2LabelColor",O===s()?"transparent":O)}function U(O){k()(O,R[O])}Te();var Y=uo(),ee=f(Y),me=f(ee);La(me),_t(2),g(ee);var oe=u(ee,2),K=u(f(oe),2),fe=f(K),q=f(fe);_t(),g(fe);var W=u(fe,2);{var se=O=>{var He=vo();vt(He,5,()=>qa,dt,(nt,ae)=>{var re=co();let Ie;var We=f(re,!0);g(re),J(()=>{Ie=ue(re,1,"font-option svelte-n6z268",null,Ie,{selected:t()===n(ae)}),we(re,`font-family: '${n(ae)??""}'`),Ue(We,n(ae)==="Inter"?"Inter (Default)":n(ae))}),p("click",re,()=>L(n(ae))),A(nt,re)}),g(He),A(O,He)};$(W,O=>{n(l)&&O(se)})}g(K),ft(K,O=>z(w,O),()=>n(w));var ge=u(K,2);let Be;var ye=u(ge,2),Ke=f(ye);g(ye),g(oe);var H=u(oe,2),X=f(H);Ze(X,{label:"Size",min:1,max:10,get value(){return o()},onChange:O=>k()("text2Size",O)});var te=u(X,2);g(H);var be=u(H,2),de=f(be);Ze(de,{label:"Position",min:0,max:10,get value(){return r()},onChange:O=>k()("text2YPosition",O)});var ze=u(de,2);g(be);var Ee=u(be,2),Fe=f(Ee);Ze(Fe,{label:"Line spacing",min:1,max:10,get value(){return d()},onChange:O=>k()("text2LineSpacing",O)});var qe=u(Fe,2);g(Ee);var Ge=u(Ee,2),Qe=u(f(Ge),2);zt(Qe,{get colors(){return S},get value(){return c()},onChange:C,showRainbow:!0}),g(Ge);var he=u(Ge,2),Oe=u(f(he),2);zt(Oe,{get colors(){return x},get value(){return s()},onChange:P,showRainbow:!0}),g(he),g(Y),J(()=>{qt(me,e()),we(fe,`font-family: '${t()??""}'`),Ue(q,`${(t()==="Inter"?"Inter (Default)":t())??""} `),Be=ue(ge,1,"icon-btn svelte-n6z268",null,Be,{active:v()}),_e(ye,"aria-label",`Align ${b()??""}`),_e(Ke,"src",`/icons/icon-align-${b()??""}.svg`)}),p("input",me,E),p("click",fe,()=>z(l,!n(l))),p("click",ge,T),p("click",ye,I),p("click",te,()=>U("text2Size")),p("click",ze,()=>U("text2YPosition")),p("click",qe,()=>U("text2LineSpacing")),A(i,Y),De()}var ho=F('<button><img alt="" class="style-icon svelte-4vqdnp"/></button>'),fo=F('<div class="quote-controls svelte-4vqdnp"><div class="style-row svelte-4vqdnp"></div> <div><!> <button class="reset-btn svelte-4vqdnp" aria-label="Reset size"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-4vqdnp"/></button></div></div>');function bo(i,a){Me(a,!1);let e=h(a,"quoteStyle",8,"none"),t=h(a,"quoteSize",8,5),o=h(a,"onChange",8,(R,l)=>{});const r=[{id:"none",icon:"/icons/icon-none.svg",label:"No quote"},{id:"serif",icon:"/icons/icon-quote-serif.svg",label:"Serif quote"},{id:"slab",icon:"/icons/icon-quote-slab.svg",label:"Slab quote"}],d={quoteSize:5};function c(R){o()("text1QuoteStyle",R)}function s(R){o()("text1QuoteSize",d[R])}Te();var v=fo(),b=f(v);vt(b,5,()=>r,dt,(R,l)=>{var w=ho();let M;var E=f(w);g(w),J(()=>{M=ue(w,1,"style-btn svelte-4vqdnp",null,M,{active:e()===n(l).id,"is-none":n(l).id==="none"}),_e(w,"aria-label",(n(l),m(()=>n(l).label))),_e(E,"src",(n(l),m(()=>n(l).icon)))}),p("click",w,()=>c(n(l).id)),A(R,w)}),g(b);var k=u(b,2);let S;var x=f(k);Ze(x,{label:"Size",min:1,max:10,get value(){return t()},onChange:R=>e()!=="none"&&o()("text1QuoteSize",R)});var y=u(x,2);g(k),g(v),J(()=>{S=ue(k,1,"slider-row svelte-4vqdnp",null,S,{disabled:e()==="none"}),y.disabled=e()==="none"}),p("click",y,()=>s("quoteSize")),A(i,v),De()}var mo=F('<div class="import-box svelte-qirtgp" role="button" tabindex="0"><label class="import-area svelte-qirtgp"><input type="file" accept="image/*" class="file-input svelte-qirtgp"/> <img src="/icons/icon-upload.svg" alt="" class="upload-icon svelte-qirtgp"/> <span class="import-text svelte-qirtgp">Import, drag or<br/>paste an image</span></label> <button class="paste-btn svelte-qirtgp">Paste</button></div>'),po=F('<div class="slider-row svelte-qirtgp"><!></div> <div class="slider-row svelte-qirtgp"><!></div> <div class="mask-row svelte-qirtgp"><span class="row-label svelte-qirtgp">Mask</span> <div class="mask-buttons svelte-qirtgp"><button aria-label="No mask"><img src="/icons/icon-none.svg" alt="" class="mask-icon svelte-qirtgp"/></button> <button aria-label="Rounded mask"><img src="/icons/icon-square.svg" alt="" class="mask-icon svelte-qirtgp"/></button> <button aria-label="Circle mask"><div class="circle-icon svelte-qirtgp"></div></button></div> <span class="row-label layer-label svelte-qirtgp">Layers</span> <div class="layer-buttons svelte-qirtgp"><button aria-label="Overlay above text"><img src="/icons/icon-layer-above.svg" alt="" class="layer-icon svelte-qirtgp"/></button> <button aria-label="Overlay below text"><img src="/icons/icon-layer-below.svg" alt="" class="layer-icon svelte-qirtgp"/></button></div></div> <div class="slider-row svelte-qirtgp"><!></div> <div class="color-section svelte-qirtgp"><span class="section-label svelte-qirtgp">Border colour</span> <!></div>',1),wo=F('<div class="overlay-controls svelte-qirtgp"><!></div>');function xo(i,a){Me(a,!1);let e=h(a,"overlay",8,null),t=h(a,"overlaySize",8,50),o=h(a,"overlayOpacity",8,100),r=h(a,"overlayMask",8,"none"),d=h(a,"overlayLayer",8,"above"),c=h(a,"overlayBorderWidth",8,0),s=h(a,"overlayBorderColor",8,"#FFFFFF"),v=h(a,"onChange",8,(T,I)=>{});const b=It.solids,k=[0,1,2,3];function S(T){const I=T.target.files?.[0];if(I&&I.type.startsWith("image/")){const C=new FileReader;C.onload=P=>{v()("overlay",P.target.result)},C.readAsDataURL(I)}T.target.value=""}function x(T){T.preventDefault();const I=T.dataTransfer?.files?.[0];if(I&&I.type.startsWith("image/")){const C=new FileReader;C.onload=P=>{v()("overlay",P.target.result)},C.readAsDataURL(I)}}function y(T){T.preventDefault()}async function R(){try{const T=await navigator.clipboard.read();for(const I of T){const C=I.types.find(P=>P.startsWith("image/"));if(C){const P=await I.getType(C),U=new FileReader;U.onload=Y=>{v()("overlay",Y.target.result)},U.readAsDataURL(P);return}}}catch(T){console.error("Paste failed:",T)}}function l(T){const I=k.reduce((C,P)=>Math.abs(P-T)<Math.abs(C-T)?P:C);v()("overlayBorderWidth",I)}Te();var w=wo(),M=f(w);{var E=T=>{var I=mo(),C=f(I),P=f(C);_t(4),g(C);var U=u(C,2);g(I),p("change",P,S),p("click",U,R),p("drop",I,x),p("dragover",I,y),A(T,I)},L=T=>{var I=po(),C=je(I),P=f(C);Ze(P,{label:"Size",min:10,max:100,get value(){return t()},onChange:ze=>v()("overlaySize",ze)}),g(C);var U=u(C,2),Y=f(U);Ze(Y,{label:"Opacity",min:0,max:100,get value(){return o()},onChange:ze=>v()("overlayOpacity",ze)}),g(U);var ee=u(U,2),me=u(f(ee),2),oe=f(me);let K;var fe=u(oe,2);let q;var W=u(fe,2);let se;g(me);var ge=u(me,4),Be=f(ge);let ye;var Ke=u(Be,2);let H;g(ge),g(ee);var X=u(ee,2),te=f(X);Ze(te,{label:"Border width",min:0,max:3,step:1,get value(){return c()},onChange:l}),g(X);var be=u(X,2),de=u(f(be),2);zt(de,{get colors(){return b},get value(){return s()},onChange:ze=>v()("overlayBorderColor",ze),showRainbow:!0}),g(be),J(()=>{K=ue(oe,1,"mask-btn svelte-qirtgp",null,K,{active:r()==="none"}),q=ue(fe,1,"mask-btn svelte-qirtgp",null,q,{active:r()==="rounded"}),se=ue(W,1,"mask-btn svelte-qirtgp",null,se,{active:r()==="circle"}),ye=ue(Be,1,"layer-btn svelte-qirtgp",null,ye,{active:d()==="above"}),H=ue(Ke,1,"layer-btn svelte-qirtgp",null,H,{active:d()==="below"})}),p("click",oe,()=>v()("overlayMask","none")),p("click",fe,()=>v()("overlayMask","rounded")),p("click",W,()=>v()("overlayMask","circle")),p("click",Be,()=>v()("overlayLayer","above")),p("click",Ke,()=>v()("overlayLayer","below")),A(T,I)};$(M,T=>{e()?T(L,!1):T(E)})}g(w),A(i,w),De()}var _o=F('<button class="template-card svelte-fxk5n4"><div class="template-placeholder svelte-fxk5n4"> </div></button>'),yo=F('<div class="template-picker svelte-fxk5n4"><p class="picker-title svelte-fxk5n4">Create quotes and cards. Start with a template or blank canvas</p> <button class="blank-canvas-btn svelte-fxk5n4"><img src="/icons/icon-add.svg" alt="" class="add-icon svelte-fxk5n4"/></button> <div class="template-grid svelte-fxk5n4"></div></div>'),ko=F('<div class="canvas-quote svelte-fxk5n4">&#8220;</div>'),Co=F('<!> <div class="text1-wrapper svelte-fxk5n4"><div class="canvas-text text1 svelte-fxk5n4"><!></div></div>',1),So=F('<div class="canvas-text text2 svelte-fxk5n4"><!></div>'),Io=F('<div role="button" tabindex="0"><div><button class="delete-btn svelte-fxk5n4" aria-label="Delete overlay"><img src="/icons/icon-close.svg" alt="" class="delete-icon svelte-fxk5n4"/></button> <div><img alt="Overlay" class="overlay-image svelte-fxk5n4" draggable="false"/></div></div></div>'),zo=F('<!> <div class="canvas-container svelte-fxk5n4"><div class="design-canvas svelte-fxk5n4" role="button" tabindex="0"><!> <!> <!></div></div> <!> <div class="controls-panel svelte-fxk5n4"><!></div>',1),Ro=F('<div class="design-tab svelte-fxk5n4"><!></div>');function Bo(i,a){Me(a,!1);const e=()=>it(ct,"$activeDesignMenu",r),t=()=>it(Ye,"$slideState",r),o=()=>it(aa,"$showTemplatePicker",r),[r,d]=Rt(),c=N();let s=N(),v=N(300),b=300,k=N(300),S,x=!1,y=0,R=0,l=0,w=0;Bt(()=>{n(s)&&(S=new ResizeObserver(([H])=>{const{width:X,height:te}=H.contentRect;b=X,z(k,te),z(v,Math.min(X,te))}),S.observe(n(s)))}),oa(()=>{S&&S.disconnect()});const M=[{id:"size",label:"Size"},{id:"background",label:"Background"},{id:"text1",label:"Text 1"},{id:"text2",label:"Text 2"},{id:"quote",label:"Quote"},{id:"overlay",label:"Overlay"}];function E(H){H==="blank"&&Ye.reset(),aa.set(!1)}function L(H){ct.set(e()===H?"none":H)}async function T(){}function I(){}function C(H){Ye.update(X=>({...X,canvasSize:H}))}function P(H){Ye.update(X=>({...X,background:H}))}function U(H,X){Ye.update(te=>({...te,[H]:X}))}function Y(H,X){Ye.update(te=>({...te,[H]:X}))}function ee(H,X){Ye.update(te=>({...te,[H]:X}))}function me(H,X){if(H==="overlay"&&X){const te=new Image;te.onload=()=>{Ye.update(be=>({...be,overlay:X,overlayNaturalWidth:te.naturalWidth,overlayNaturalHeight:te.naturalHeight,overlayX:50,overlayY:50})),ct.set("overlay")},te.src=X}else H==="overlayLayer"?(Ye.update(te=>({...te,[H]:X})),ct.set("none")):Ye.update(te=>({...te,[H]:X}))}function oe(){Ye.update(H=>({...H,overlay:null,overlayNaturalWidth:0,overlayNaturalHeight:0})),ct.set("none")}function K(H){if(H.target.closest(".delete-btn"))return;H.preventDefault(),x=!0;const X=H.touches?.[0]||H;y=X.clientX,R=X.clientY,l=t().overlayX,w=t().overlayY,window.addEventListener("mousemove",fe),window.addEventListener("mouseup",q),window.addEventListener("touchmove",fe,{passive:!1}),window.addEventListener("touchend",q)}function fe(H){if(!x)return;H.preventDefault();const X=H.touches?.[0]||H,te=X.clientX-y,be=X.clientY-R,de=te/b*100,ze=be/n(k)*100,Ee=Math.max(0,Math.min(100,l+de)),Fe=Math.max(0,Math.min(100,w+ze));Ye.update(qe=>({...qe,overlayX:Ee,overlayY:Fe}))}function q(){x=!1,window.removeEventListener("mousemove",fe),window.removeEventListener("mouseup",q),window.removeEventListener("touchmove",fe),window.removeEventListener("touchend",q)}function W(H){const X=H.target;X.closest(".overlay-wrapper")?ct.set("overlay"):X.closest(".text1-wrapper")?ct.set("text1"):X.closest(".canvas-text.text2")?ct.set("text2"):X.closest(".canvas-quote")?ct.set("quote"):ct.set("none")}function se(H){if(!H.overlay||!H.overlayNaturalWidth)return null;const X=H.overlayNaturalWidth/H.overlayNaturalHeight,te=H.overlaySize/100*100;let be,de;return X>=1?(be=te,de=te/X):(de=te,be=te*X),{width:be,height:de}}Ne(()=>t(),()=>{z(c,se(t()))}),pt(),Te();var ge=Ro(),Be=f(ge);{var ye=H=>{var X=yo(),te=u(f(X),2),be=u(te,2);vt(be,4,()=>[1,2,3,4,5,6],dt,(de,ze)=>{var Ee=_o(),Fe=f(Ee),qe=f(Fe);g(Fe),g(Ee),J(()=>Ue(qe,`Template ${ze??""}`)),p("click",Ee,()=>E(`template-${ze}`)),A(de,Ee)}),g(be),g(X),p("click",te,()=>E("blank")),A(H,X)},Ke=H=>{var X=zo(),te=je(X);{let ae=Je(()=>(Le(Ye),m(()=>Ye.canUndo()))),re=Je(()=>(Le(Ye),m(()=>Ye.canRedo())));la(te,{get canUndo(){return n(ae)},get canRedo(){return n(re)},onUndo:()=>Ye.undo(),onRedo:()=>Ye.redo(),get onStartAgain(){return to},onCopy:T,onExport:I})}var be=u(te,2),de=f(be),ze=f(de);{var Ee=ae=>{const re=Je(()=>(n(v),t(),m(()=>n(v)*.1*t().text1Size/5))),Ie=Je(()=>(Le(n(re)),t(),m(()=>n(re)*(1+t().text1LineSpacing*.1)))),We=Je(()=>(Le(n(Ie)),t(),m(()=>n(Ie)*(t().text1QuoteStyle==="slab"?.35:.4)))),Ve=Je(()=>(t(),m(()=>t().text1YPosition*10))),Ae=Je(()=>8),B=Je(()=>n(Ve)-n(Ae)-n(We)/n(k)*100);var Z=Co(),ce=je(Z);{var Q=_=>{var D=ko();J(()=>we(D,`
								top: ${n(B)??""}%;
								font-family: ${t(),m(()=>t().text1QuoteStyle==="serif"?'"Playfair Display", serif':'"Alfa Slab One", cursive')??""};
								font-size: ${n(v),t(),m(()=>n(v)*.08*t().text1QuoteSize)??""}px;
								font-weight: ${t(),m(()=>t().text1QuoteStyle==="serif"?"bold":"normal")??""};
								color: ${t(),m(()=>t().text1Color)??""};
							`)),A(_,D)};$(ce,_=>{t(),m(()=>t().text1QuoteStyle!=="none")&&_(Q)})}var le=u(ce,2),ke=f(le),ne=f(ke);fa(ne,()=>(t(),m(()=>t().text1.replace(/==(.+?)==/g,`<span style="color: ${t().text1HighlightColor};">$1</span>`).replace(/\n/g,"<br>")))),g(ke),g(le),J(()=>{we(le,`top: ${n(Ve)??""}%;`),we(ke,`
								font-family: '${t(),m(()=>t().text1Font)??""}';
								font-size: ${t(),m(()=>t().text1Size*.5)??""}em;
								font-weight: ${t(),m(()=>t().text1IsBold?"bold":"normal")??""};
								color: ${t(),m(()=>t().text1Color)??""};
								text-align: ${t(),m(()=>t().text1Align)??""};
								line-height: ${t(),m(()=>1+t().text1LineSpacing*.1)??""};
							`)}),A(ae,Z)};$(ze,ae=>{t(),m(()=>t().text1)&&ae(Ee)})}var Fe=u(ze,2);{var qe=ae=>{var re=So(),Ie=f(re);fa(Ie,()=>(t(),m(()=>t().text2.replace(/==(.+?)==/g,`<span style="color: ${t().text2LabelColor};">$1</span>`).replace(/\n/g,"<br>")))),g(re),J(()=>we(re,`
							font-family: '${t(),m(()=>t().text2Font)??""}';
							font-size: ${t(),m(()=>t().text2Size*.5)??""}em;
							font-weight: ${t(),m(()=>t().text2IsBold?"bold":"normal")??""};
							color: ${t(),m(()=>t().text2Color)??""};
							text-align: ${t(),m(()=>t().text2Align)??""};
							top: ${t(),m(()=>t().text2YPosition*10)??""}%;
							line-height: ${t(),m(()=>1+t().text2LineSpacing*.1)??""};
						`)),A(ae,re)};$(Fe,ae=>{t(),m(()=>t().text2)&&ae(qe)})}var Ge=u(Fe,2);{var Qe=ae=>{var re=Io();let Ie;var We=f(re);let Ve;var Ae=f(We),B=u(Ae,2);let Z;var ce=f(B);g(B),g(We),g(re),J(()=>{Ie=ue(re,1,"overlay-wrapper svelte-fxk5n4",null,Ie,{active:e()==="overlay"}),we(re,`
							left: ${t(),m(()=>t().overlayX)??""}%;
							top: ${t(),m(()=>t().overlayY)??""}%;
							width: ${n(c),m(()=>n(c).width)??""}%;
							opacity: ${t(),m(()=>t().overlayOpacity/100)??""};
							z-index: ${e(),t(),m(()=>e()==="overlay"?11:t().overlayLayer==="below"?1:10)??""};
						`),Ve=ue(We,1,"overlay-bounding-box svelte-fxk5n4",null,Ve,{"mask-none":t().overlayMask==="none","mask-rounded":t().overlayMask==="rounded","mask-circle":t().overlayMask==="circle"}),we(We,`
								border-width: ${t(),m(()=>t().overlayBorderWidth*2)??""}px;
								border-color: ${t(),m(()=>t().overlayBorderColor)??""};
							`),Z=ue(B,1,"overlay-image-container svelte-fxk5n4",null,Z,{"mask-rounded":t().overlayMask==="rounded","mask-circle":t().overlayMask==="circle"}),_e(ce,"src",(t(),m(()=>t().overlay)))}),p("click",Ae,oe),p("mousedown",re,K),p("touchstart",re,K),A(ae,re)};$(Ge,ae=>{t(),n(c),m(()=>t().overlay&&n(c))&&ae(Qe)})}g(de),ft(de,ae=>z(s,ae),()=>n(s)),g(be);var he=u(be,2);sa(he,{get tabs(){return M},get activeTab(){return e()},onTabChange:L});var Oe=u(he,2),O=f(Oe);{var He=ae=>{xo(ae,{get overlay(){return t(),m(()=>t().overlay)},get overlaySize(){return t(),m(()=>t().overlaySize)},get overlayOpacity(){return t(),m(()=>t().overlayOpacity)},get overlayMask(){return t(),m(()=>t().overlayMask)},get overlayLayer(){return t(),m(()=>t().overlayLayer)},get overlayBorderWidth(){return t(),m(()=>t().overlayBorderWidth)},get overlayBorderColor(){return t(),m(()=>t().overlayBorderColor)},onChange:me,onDelete:oe})},nt=ae=>{var re=gt(),Ie=je(re);{var We=Ae=>{Qi(Ae,{get canvasSize(){return t(),m(()=>t().canvasSize)},onSizeChange:C})},Ve=Ae=>{var B=gt(),Z=je(B);{var ce=le=>{io(le,{get background(){return t(),m(()=>t().background)},onBackgroundChange:P})},Q=le=>{var ke=gt(),ne=je(ke);{var _=j=>{so(j,{get text1(){return t(),m(()=>t().text1)},get text1Font(){return t(),m(()=>t().text1Font)},get text1Size(){return t(),m(()=>t().text1Size)},get text1YPosition(){return t(),m(()=>t().text1YPosition)},get text1LineSpacing(){return t(),m(()=>t().text1LineSpacing)},get text1Color(){return t(),m(()=>t().text1Color)},get text1HighlightColor(){return t(),m(()=>t().text1HighlightColor)},get text1IsBold(){return t(),m(()=>t().text1IsBold)},get text1Align(){return t(),m(()=>t().text1Align)},onChange:U})},D=j=>{var ie=gt(),V=je(ie);{var xe=Se=>{go(Se,{get text2(){return t(),m(()=>t().text2)},get text2Font(){return t(),m(()=>t().text2Font)},get text2Size(){return t(),m(()=>t().text2Size)},get text2YPosition(){return t(),m(()=>t().text2YPosition)},get text2LineSpacing(){return t(),m(()=>t().text2LineSpacing)},get text2Color(){return t(),m(()=>t().text2Color)},get text2LabelColor(){return t(),m(()=>t().text2LabelColor)},get text2IsBold(){return t(),m(()=>t().text2IsBold)},get text2Align(){return t(),m(()=>t().text2Align)},onChange:Y})},Ce=Se=>{var Re=gt(),Pe=je(Re);{var ot=Xe=>{bo(Xe,{get quoteStyle(){return t(),m(()=>t().text1QuoteStyle)},get quoteSize(){return t(),m(()=>t().text1QuoteSize)},onChange:ee})};$(Pe,Xe=>{e()==="quote"&&Xe(ot)},!0)}A(Se,Re)};$(V,Se=>{e()==="text2"?Se(xe):Se(Ce,!1)},!0)}A(j,ie)};$(ne,j=>{e()==="text1"?j(_):j(D,!1)},!0)}A(le,ke)};$(Z,le=>{e()==="background"?le(ce):le(Q,!1)},!0)}A(Ae,B)};$(Ie,Ae=>{e()==="size"?Ae(We):Ae(Ve,!1)},!0)}A(ae,re)};$(O,ae=>{e(),t(),m(()=>e()==="overlay"||e()==="none"&&t().overlay)?ae(He):ae(nt,!1)})}g(Oe),J(()=>we(de,`
					aspect-ratio: ${t(),m(()=>t().canvasSize)??""};
					background: ${t(),m(()=>(t().background.type==="solid",t().background.value))??""};
				`)),p("click",de,W),p("keydown",de,ae=>ae.key==="Enter"&&W(ae)),A(H,X)};$(Be,H=>{o()?H(ye):H(Ke,!1)})}g(ge),A(i,ge),De(),d()}const Qt=bt("crop");var Eo=F('<!> <main class="main svelte-1uha8ag"><!></main> <!>',1);function qo(i,a){Me(a,!1);const e=()=>it(Qt,"$activeTab",o),t=()=>it(ve,"$cropState",o),[o,r]=Rt();let d=N(!1),c=null;function s(E){if(e()==="crop"&&t().cropPending&&E!=="crop"){c=E,z(d,!0);return}Qt.set(E)}async function v(){z(d,!1);const E=t();if(E.currentImage&&E.cropPending){const L=await Da(E.currentImage,E.cropBox,E.imageWidth,E.imageHeight),T=await Ut(L);ve.set({...E,currentImage:L,imageWidth:T.width,imageHeight:T.height,cropBox:{x:0,y:0,width:100,height:100},cropPending:!1,isCropping:!1})}c&&(Qt.set(c),c=null)}function b(){z(d,!1),c=null}Te();var k=Eo(),S=je(k);Sn(S,{get activeTab(){return e()},onTabChange:s});var x=u(S,2),y=f(x);{var R=E=>{pi(E,{})},l=E=>{var L=gt(),T=je(L);{var I=P=>{Xi(P,{})},C=P=>{var U=gt(),Y=je(U);{var ee=me=>{Bo(me,{})};$(Y,me=>{e()==="design"&&me(ee)},!0)}A(P,U)};$(T,P=>{e()==="ai"?P(I):P(C,!1)},!0)}A(E,L)};$(y,E=>{e()==="crop"?E(R):E(l,!1)})}g(x);var w=u(x,2);{var M=E=>{ta(E,{message:"Save changes?",confirmText:"Yes",cancelText:"Cancel",onConfirm:v,onCancel:b})};$(w,E=>{n(d)&&E(M)})}A(i,k),De(),r()}export{qo as component};
