import{b as ca,d as Oa,f as F,a as A,c as gt}from"../chunks/Dj8On0Xh.js";import"../chunks/Bnc7oL5D.js";import{F as Ht,i as nt,x as Dt,C as jt,j as Vt,M as Ha,g as a,aI as Ve,aA as Ua,O as Wa,a5 as da,aj as Nt,B as St,N as Sa,ao as ja,a2 as va,ax as Ct,P as Jt,az as Na,am as na,w as Ia,I as ua,at as U,aO as Ya,aP as Xa,aQ as Ga,aR as ft,ay as za,R as Ra,aS as Yt,ah as Ba,aT as Qa,al as Va,a3 as Ja,aU as Ea,L as Pa,aV as Za,t as K,A as Ka,aW as $a,ap as en,ai as tn,aX as an,aY as nn,aZ as on,a_ as rn,a$ as ln,b0 as sn,av as cn,b as m,J as dn,b1 as vn,p as Be,n as Ee,s as u,k as f,l as g,aq as z,b2 as Ye,b3 as pt,e as Re,a4 as yt,m as Xe,b4 as ga,b5 as La}from"../chunks/c1y374w_.js";import{p as h,b as ht,i as te,s as ot,a as Rt,_ as un}from"../chunks/DZfZzOi_.js";import{i as Le}from"../chunks/CBwOI1Gw.js";import{e as p,s as He}from"../chunks/8R3vFiuv.js";import{c as gn,o as Bt,d as ia,w as bt,a as oa}from"../chunks/pj8eKBGp.js";function dt(i,t){return t}function hn(i,t,e){for(var n=[],o=t.length,r,d=t.length,c=0;c<o;c++){let k=t[c];Ra(k,()=>{if(r){if(r.pending.delete(k),r.done.add(k),r.pending.size===0){var S=i.outrogroups;Zt(na(r.done)),S.delete(r),S.size===0&&(i.outrogroups=null)}}else d-=1},!1)}if(d===0){var s=n.length===0&&e!==null;if(s){var v=e,b=v.parentNode;Va(b),b.append(v),i.items.clear()}Zt(t,!s)}else r={pending:new Set(t),done:new Set},(i.outrogroups??=new Set).add(r)}function Zt(i,t=!0){for(var e=0;e<i.length;e++)Ja(i[e],t)}var ha;function vt(i,t,e,n,o,r=null){var d=i,c=new Map,s=(t&Ea)!==0;if(s){var v=i;d=nt?Ht(Dt(v)):v.appendChild(jt())}nt&&Vt();var b=null,k=Ve(()=>{var w=e();return Ia(w)?w:w==null?[]:na(w)}),S,x=!0;function y(){l.fallback=b,fn(l,S,d,t,n),b!==null&&(S.length===0?(b.f&ft)===0?za(b):(b.f^=ft,Tt(b,null,d)):Ra(b,()=>{b=null}))}var R=Ha(()=>{S=a(k);var w=S.length;let M=!1;if(nt){var E=Ua(d)===Wa;E!==(w===0)&&(d=da(),Ht(d),Nt(!1),M=!0)}for(var L=new Set,D=Ct,I=Na(),C=0;C<w;C+=1){nt&&St.nodeType===Sa&&St.data===ja&&(d=St,M=!0,Nt(!1));var P=S[C],j=n(P,C),G=x?null:c.get(j);G?(G.v&&va(G.v,P),G.i&&va(G.i,C),I&&D.skipped_effects.delete(G.e)):(G=bn(c,x?d:ha??=jt(),P,j,C,o,t,e),x||(G.e.f|=ft),c.set(j,G)),L.add(j)}if(w===0&&r&&!b&&(x?b=Jt(()=>r(d)):(b=Jt(()=>r(ha??=jt())),b.f|=ft)),nt&&w>0&&Ht(da()),!x)if(I){for(const[ae,ge]of c)L.has(ae)||D.skipped_effects.add(ge.e);D.oncommit(y),D.ondiscard(()=>{})}else y();M&&Nt(!0),a(k)}),l={effect:R,items:c,outrogroups:null,fallback:b};x=!1,nt&&(d=St)}function Pt(i){for(;i!==null&&(i.f&Qa)===0;)i=i.next;return i}function fn(i,t,e,n,o){var r=(n&Za)!==0,d=t.length,c=i.items,s=Pt(i.effect.first),v,b=null,k,S=[],x=[],y,R,l,w;if(r)for(w=0;w<d;w+=1)y=t[w],R=o(y,w),l=c.get(R).e,(l.f&ft)===0&&(l.nodes?.a?.measure(),(k??=new Set).add(l));for(w=0;w<d;w+=1){if(y=t[w],R=o(y,w),l=c.get(R).e,i.outrogroups!==null)for(const G of i.outrogroups)G.pending.delete(l),G.done.delete(l);if((l.f&ft)!==0)if(l.f^=ft,l===s)Tt(l,null,e);else{var M=b?b.next:s;l===i.effect.last&&(i.effect.last=l.prev),l.prev&&(l.prev.next=l.next),l.next&&(l.next.prev=l.prev),_t(i,b,l),_t(i,l,M),Tt(l,M,e),b=l,S=[],x=[],s=Pt(b.next);continue}if((l.f&Yt)!==0&&(za(l),r&&(l.nodes?.a?.unfix(),(k??=new Set).delete(l))),l!==s){if(v!==void 0&&v.has(l)){if(S.length<x.length){var E=x[0],L;b=E.prev;var D=S[0],I=S[S.length-1];for(L=0;L<S.length;L+=1)Tt(S[L],E,e);for(L=0;L<x.length;L+=1)v.delete(x[L]);_t(i,D.prev,I.next),_t(i,b,D),_t(i,I,E),s=E,b=I,w-=1,S=[],x=[]}else v.delete(l),Tt(l,s,e),_t(i,l.prev,l.next),_t(i,l,b===null?i.effect.first:b.next),_t(i,b,l),b=l;continue}for(S=[],x=[];s!==null&&s!==l;)(v??=new Set).add(s),x.push(s),s=Pt(s.next);if(s===null)continue}(l.f&ft)===0&&S.push(l),b=l,s=Pt(l.next)}if(i.outrogroups!==null){for(const G of i.outrogroups)G.pending.size===0&&(Zt(na(G.done)),i.outrogroups?.delete(G));i.outrogroups.size===0&&(i.outrogroups=null)}if(s!==null||v!==void 0){var C=[];if(v!==void 0)for(l of v)(l.f&Yt)===0&&C.push(l);for(;s!==null;)(s.f&Yt)===0&&s!==i.fallback&&C.push(s),s=Pt(s.next);var P=C.length;if(P>0){var j=(n&Ea)!==0&&d===0?e:null;if(r){for(w=0;w<P;w+=1)C[w].nodes?.a?.measure();for(w=0;w<P;w+=1)C[w].nodes?.a?.fix()}hn(i,C,j)}}r&&Pa(()=>{if(k!==void 0)for(l of k)l.nodes?.a?.apply()})}function bn(i,t,e,n,o,r,d,c){var s=(d&Xa)!==0?(d&Ga)===0?U(e,!1,!1):ua(e):null,v=(d&Ya)!==0?ua(o):null;return{v:s,i:v,e:Jt(()=>(r(t,s??e,v??o,c),()=>{i.delete(n)}))}}function Tt(i,t,e){if(i.nodes)for(var n=i.nodes.start,o=i.nodes.end,r=t&&(t.f&ft)===0?t.nodes.start:e;n!==null;){var d=Ba(n);if(r.before(n),n===o)return;n=d}}function _t(i,t,e){t===null?i.effect.first=e:t.next=e,e===null?i.effect.last=t:e.prev=t}function fa(i,t,e=!1,n=!1,o=!1){var r=i,d="";K(()=>{var c=Ka;if(d===(d=t()??"")){nt&&Vt();return}if(c.nodes!==null&&($a(c.nodes.start,c.nodes.end),c.nodes=null),d!==""){if(nt){St.data;for(var s=Vt(),v=s;s!==null&&(s.nodeType!==Sa||s.data!=="");)v=s,s=Ba(s);if(s===null)throw en(),tn;ca(St,v),r=Ht(s);return}var b=d+"";e?b=`<svg>${b}</svg>`:n&&(b=`<math>${b}</math>`);var k=Oa(b);if((e||n)&&(k=Dt(k)),ca(Dt(k),k.lastChild),e||n)for(;Dt(k);)r.before(Dt(k));else r.before(k)}})}const ba=[...` 	
\r\fÂ \v\uFEFF`];function mn(i,t,e){var n=i==null?"":""+i;if(e){for(var o in e)if(e[o])n=n?n+" "+o:o;else if(n.length)for(var r=o.length,d=0;(d=n.indexOf(o,d))>=0;){var c=d+r;(d===0||ba.includes(n[d-1]))&&(c===n.length||ba.includes(n[c]))?n=(d===0?"":n.substring(0,d))+n.substring(c+1):d=c}}return n===""?null:n}function pn(i,t){return i==null?null:String(i)}function de(i,t,e,n,o,r){var d=i.__className;if(nt||d!==e||d===void 0){var c=mn(e,n,r);(!nt||c!==i.getAttribute("class"))&&(c==null?i.removeAttribute("class"):i.className=c),i.__className=e}else if(r&&o!==r)for(var s in r){var v=!!r[s];(o==null||v!==!!o[s])&&i.classList.toggle(s,v)}return r}function ye(i,t,e,n){var o=i.__style;if(nt||o!==t){var r=pn(t);(!nt||r!==i.getAttribute("style"))&&(r==null?i.removeAttribute("style"):i.style.cssText=r),i.__style=t}return n}const wn=Symbol("is custom element"),xn=Symbol("is html");function Ft(i){if(nt){var t=!1,e=()=>{if(!t){if(t=!0,i.hasAttribute("value")){var n=i.value;ke(i,"value",null),i.value=n}if(i.hasAttribute("checked")){var o=i.checked;ke(i,"checked",null),i.checked=o}}};i.__on_r=e,Pa(e),ln()}}function qt(i,t){var e=ra(i);e.value===(e.value=t??void 0)||i.value===t&&(t!==0||i.nodeName!=="PROGRESS")||(i.value=t??"")}function _n(i,t){var e=ra(i);e.checked!==(e.checked=t??void 0)&&(i.checked=t)}function ke(i,t,e,n){var o=ra(i);nt&&(o[t]=i.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&i.nodeName==="LINK")||o[t]!==(o[t]=e)&&(t==="loading"&&(i[an]=e),e==null?i.removeAttribute(t):typeof e!="string"&&yn(i).includes(t)?i[t]=e:i.setAttribute(t,e))}function ra(i){return i.__attributes??={[wn]:i.nodeName.includes("-"),[xn]:i.namespaceURI===nn}}var ma=new Map;function yn(i){var t=i.getAttribute("is")||i.nodeName,e=ma.get(t);if(e)return e;ma.set(t,e=[]);for(var n,o=i,r=Element.prototype;r!==o;){n=rn(o);for(var d in n)n[d].set&&e.push(d);o=on(o)}return e}function kn(i,t,e=t){var n=new WeakSet;sn(i,"input",async o=>{var r=o?i.defaultValue:i.value;if(r=Xt(i)?Gt(r):r,e(r),Ct!==null&&n.add(Ct),await cn(),r!==(r=t())){var d=i.selectionStart,c=i.selectionEnd,s=i.value.length;if(i.value=r??"",c!==null){var v=i.value.length;d===c&&c===s&&v>s?(i.selectionStart=v,i.selectionEnd=v):(i.selectionStart=d,i.selectionEnd=Math.min(c,v))}}}),(nt&&i.defaultValue!==i.value||m(t)==null&&i.value)&&(e(Xt(i)?Gt(i.value):i.value),Ct!==null&&n.add(Ct)),dn(()=>{var o=t();if(i===document.activeElement){var r=vn??Ct;if(n.has(r))return}Xt(i)&&o===Gt(i.value)||i.type==="date"&&!o&&!i.value||o!==i.value&&(i.value=o??"")})}function Xt(i){var t=i.type;return t==="number"||t==="range"}function Gt(i){return i===""?null:+i}function st(i){return function(...t){var e=t[0];return e.stopPropagation(),i?.apply(this,t)}}function Kt(i,t){var e=i.$$events?.[t.type],n=Ia(e)?e.slice():e==null?[]:[e];for(var o of n)o.call(this,t)}var Cn=F('<header class="header svelte-hv3zzy"><img src="/logos/logo-picflam-logotype.png" alt="PicFlam" class="header-logo svelte-hv3zzy"/> <nav class="header-nav svelte-hv3zzy"><button aria-label="Crop tab"><img src="/icons/icon-crop.svg" alt="" class="nav-icon svelte-hv3zzy"/></button> <button aria-label="AI tab"><img src="/icons/icon-ai.svg" alt="" class="nav-icon svelte-hv3zzy"/></button> <button aria-label="Design tab"><img src="/icons/icon-design.svg" alt="" class="nav-icon svelte-hv3zzy"/></button></nav></header>');function Sn(i,t){Be(t,!1);let e=h(t,"activeTab",8,"crop"),n=h(t,"onTabChange",8);Le();var o=Cn(),r=u(f(o),2),d=f(r);let c;var s=u(d,2);let v;var b=u(s,2);let k;g(r),g(o),K(()=>{c=de(d,1,"nav-btn svelte-hv3zzy",null,c,{active:e()==="crop"}),v=de(s,1,"nav-btn svelte-hv3zzy",null,v,{active:e()==="ai"}),k=de(b,1,"nav-btn svelte-hv3zzy",null,k,{active:e()==="design"})}),p("click",d,()=>n()("crop")),p("click",s,()=>n()("ai")),p("click",b,()=>n()("design")),A(i,o),Ee()}function Ma(i){return new Promise((t,e)=>{const n=new FileReader;n.onload=o=>t(o.target.result),n.onerror=e,n.readAsDataURL(i)})}function mt(i){return new Promise((t,e)=>{const n=new Image;n.onload=()=>t(n),n.onerror=e,n.src=i})}async function Ut(i){const t=await mt(i);return{width:t.naturalWidth,height:t.naturalHeight}}function pa(i,t=2048){return new Promise(async e=>{const n=await mt(i),{naturalWidth:o,naturalHeight:r}=n;if(o<=t&&r<=t){e(i);return}const d=document.createElement("canvas"),c=d.getContext("2d");let s,v;o>r?(s=t,v=r/o*t):(v=t,s=o/r*t),d.width=s,d.height=v,c.drawImage(n,0,0,s,v),e(d.toDataURL("image/jpeg",.92))})}async function In(){try{const i=await navigator.clipboard.read();for(const t of i)for(const e of t.types)if(e.startsWith("image/")){const n=await t.getType(e);return await Ma(n)}return null}catch(i){return console.error("Failed to paste from clipboard:",i),null}}async function $t(i){try{const e=await(await fetch(i)).blob();return await navigator.clipboard.write([new ClipboardItem({[e.type]:e})]),!0}catch(t){return console.error("Failed to copy to clipboard:",t),!1}}function ea(i,t="picflam-export.png"){const e=document.createElement("a");e.href=i,e.download=t,document.body.appendChild(e),e.click(),document.body.removeChild(e)}async function Da(i,t,e,n){const o=await mt(i),r=document.createElement("canvas"),d=r.getContext("2d"),c=t.x/100*e,s=t.y/100*n,v=t.width/100*e,b=t.height/100*n;return r.width=v,r.height=b,d.drawImage(o,c,s,v,b,0,0,v,b),r.toDataURL("image/png")}async function zn(i,t){const e=await mt(i),n=document.createElement("canvas"),o=n.getContext("2d");return n.width=e.naturalHeight,n.height=e.naturalWidth,o.translate(n.width/2,n.height/2),o.rotate(t*Math.PI/180),o.drawImage(e,-e.naturalWidth/2,-e.naturalHeight/2),n.toDataURL("image/png")}async function Rn(i,t){const e=await mt(i),n=document.createElement("canvas"),o=n.getContext("2d");return n.width=e.naturalWidth,n.height=e.naturalHeight,o.translate(n.width,0),o.scale(-1,1),o.drawImage(e,0,0),n.toDataURL("image/png")}async function Bn(i,t,e){const n=await mt(i),o=document.createElement("canvas"),r=o.getContext("2d");if(o.width=n.naturalWidth,o.height=n.naturalHeight,t&&t!=="none"&&(r.filter=t),r.drawImage(n,0,0),r.filter="none",e&&Array.isArray(e)&&e.length>0)if(e.some(c=>c.invert)){const s=.5+e.reduce((l,w)=>l+(w.strength||50),0)/e.length/100*9.5,v=document.createElement("canvas");v.width=o.width,v.height=o.height;const b=v.getContext("2d");b.filter=`blur(${s}px)`,t&&t!=="none"&&(b.filter=`blur(${s}px) ${t}`),b.drawImage(n,0,0);const k=document.createElement("canvas");k.width=o.width,k.height=o.height;const S=k.getContext("2d");S.fillStyle="white",S.fillRect(0,0,k.width,k.height);for(const l of e){if(!l.invert)continue;const w=(l.soften||50)/100,M=S.createRadialGradient(l.x,l.y,0,l.x,l.y,l.radius);M.addColorStop(0,"rgba(0,0,0,1)"),M.addColorStop(.5+w*.3,"rgba(0,0,0,0.5)"),M.addColorStop(1,"rgba(0,0,0,0)"),S.fillStyle=M,S.beginPath(),S.arc(l.x,l.y,l.radius,0,Math.PI*2),S.fill()}const x=r.getImageData(0,0,o.width,o.height),y=b.getImageData(0,0,o.width,o.height),R=S.getImageData(0,0,o.width,o.height);for(let l=0;l<x.data.length;l+=4){const w=R.data[l]/255;x.data[l]=x.data[l]*w+y.data[l]*(1-w),x.data[l+1]=x.data[l+1]*w+y.data[l+1]*(1-w),x.data[l+2]=x.data[l+2]*w+y.data[l+2]*(1-w)}r.putImageData(x,0,0)}else for(const c of e){const s=c.strength||50,v=(c.soften||50)/100,b=.5+s/100*9.5,k=document.createElement("canvas");k.width=o.width,k.height=o.height;const S=k.getContext("2d");S.filter=`blur(${b}px)`,t&&t!=="none"&&(S.filter=`blur(${b}px) ${t}`),S.drawImage(n,0,0);const x=document.createElement("canvas");x.width=o.width,x.height=o.height;const y=x.getContext("2d"),R=y.createRadialGradient(c.x,c.y,0,c.x,c.y,c.radius);R.addColorStop(0,"rgba(255,255,255,1)"),R.addColorStop(.5+v*.3,"rgba(255,255,255,0.5)"),R.addColorStop(1,"rgba(255,255,255,0)"),y.fillStyle=R,y.beginPath(),y.arc(c.x,c.y,c.radius,0,Math.PI*2),y.fill();const l=r.getImageData(0,0,o.width,o.height),w=S.getImageData(0,0,o.width,o.height),M=y.getImageData(0,0,o.width,o.height);for(let E=0;E<l.data.length;E+=4){const L=M.data[E]/255;l.data[E]=l.data[E]*(1-L)+w.data[E]*L,l.data[E+1]=l.data[E+1]*(1-L)+w.data[E+1]*L,l.data[E+2]=l.data[E+2]*(1-L)+w.data[E+2]*L}r.putImageData(l,0,0)}return o.toDataURL("image/png")}var En=F('<div role="button" tabindex="0"><p class="import-title svelte-f1bndr"> </p> <img src="/icons/icon-upload.svg" alt="" class="import-icon svelte-f1bndr"/> <p class="import-hint svelte-f1bndr"> </p> <button class="btn-paste svelte-f1bndr">Paste</button> <input type="file" accept="image/*" class="sr-only"/></div>');function Ta(i,t){Be(t,!1);let e=h(t,"title",8,"Import an image"),n=h(t,"hint",8,"Import, drag or paste an image"),o=h(t,"onImageImport",8,I=>{}),r=U(!1),d=U();async function c(I){if(!I||!I.type.startsWith("image/"))return;const C=await Ma(I),P=await pa(C,2048);o()(P)}function s(I){const C=I.target.files?.[0];C&&c(C)}function v(I){I.preventDefault(),z(r,!1);const C=I.dataTransfer?.files?.[0];C&&c(C)}function b(I){I.preventDefault(),z(r,!0)}function k(){z(r,!1)}async function S(){const I=await In();if(I){const C=await pa(I,2048);o()(C)}}function x(){a(d)?.click()}Le();var y=En();let R;var l=f(y),w=f(l,!0);g(l);var M=u(l,4),E=f(M,!0);g(M);var L=u(M,2),D=u(L,2);ht(D,I=>z(d,I),()=>a(d)),g(y),K(()=>{R=de(y,1,"import-area svelte-f1bndr",null,R,{dragging:a(r)}),He(w,e()),He(E,n())}),p("click",L,st(S)),p("change",D,s),p("click",y,x),p("drop",y,v),p("dragover",y,b),p("dragleave",y,k),p("keypress",y,I=>I.key==="Enter"&&x()),A(i,y),Ee()}var Pn=F('<div class="action-bar svelte-96zw02"><div class="action-group svelte-96zw02"><button class="action-btn svelte-96zw02" aria-label="Undo"><img src="/icons/icon-undo.svg" alt="" class="action-icon svelte-96zw02"/></button> <button class="action-btn svelte-96zw02" aria-label="Redo"><img src="/icons/icon-redo.svg" alt="" class="action-icon svelte-96zw02"/></button></div> <div class="action-group svelte-96zw02"><button class="action-btn svelte-96zw02" aria-label="Start again"><img src="/icons/icon-startagain.svg" alt="" class="action-icon svelte-96zw02"/></button> <button class="action-btn svelte-96zw02" aria-label="Copy to clipboard"><img src="/icons/icon-copy.svg" alt="" class="action-icon svelte-96zw02"/></button> <button class="action-btn svelte-96zw02" aria-label="Export"><img src="/icons/icon-export.svg" alt="" class="action-icon svelte-96zw02"/></button></div></div>');function la(i,t){let e=h(t,"canUndo",8,!1),n=h(t,"canRedo",8,!1),o=h(t,"onUndo",8,()=>{}),r=h(t,"onRedo",8,()=>{}),d=h(t,"onStartAgain",8,()=>{}),c=h(t,"onCopy",8,()=>{}),s=h(t,"onExport",8,()=>{});var v=Pn(),b=f(v),k=f(b),S=u(k,2);g(b);var x=u(b,2),y=f(x),R=u(y,2),l=u(R,2);g(x),g(v),K(()=>{k.disabled=!e(),S.disabled=!n()}),p("click",k,function(...w){o()?.apply(this,w)}),p("click",S,function(...w){r()?.apply(this,w)}),p("click",y,function(...w){d()?.apply(this,w)}),p("click",R,function(...w){c()?.apply(this,w)}),p("click",l,function(...w){s()?.apply(this,w)}),A(i,v)}var Ln=F("<button> </button>"),Mn=F('<div class="sub-menu-tabs svelte-tv6tw8"></div>');function sa(i,t){Be(t,!1);let e=h(t,"tabs",24,()=>[]),n=h(t,"activeTab",8,""),o=h(t,"onTabChange",8,d=>{});Le();var r=Mn();vt(r,5,e,dt,(d,c)=>{var s=Ln();let v;var b=f(s,!0);g(s),K(()=>{v=de(s,1,"sub-menu-tab svelte-tv6tw8",null,v,{active:n()===a(c).id}),He(b,(a(c),m(()=>a(c).label)))}),p("click",s,()=>o()(a(c).id)),A(d,s)}),g(r),A(i,r),Ee()}var Dn=F('<div class="modal-overlay svelte-qik81a" role="dialog" aria-modal="true" tabindex="-1"><div class="modal svelte-qik81a" role="document"><p class="modal-message svelte-qik81a"> </p> <div class="modal-actions svelte-qik81a"><button class="btn-text svelte-qik81a"> </button> <button class="btn-text btn-confirm svelte-qik81a"> </button></div></div></div>');function ta(i,t){Be(t,!1);let e=h(t,"message",8,""),n=h(t,"confirmText",8,"Yes"),o=h(t,"cancelText",8,"Cancel"),r=h(t,"onConfirm",8,()=>{}),d=h(t,"onCancel",8,()=>{});Le();var c=Dn(),s=f(c),v=f(s),b=f(v,!0);g(v);var k=u(v,2),S=f(k),x=f(S,!0);g(S);var y=u(S,2),R=f(y,!0);g(y),g(k),g(s),g(c),K(()=>{He(b,e()),He(x,o()),He(R,n())}),p("click",S,function(...l){d()?.apply(this,l)}),p("click",y,function(...l){r()?.apply(this,l)}),p("click",s,st(function(l){Kt.call(this,t,l)})),p("keydown",s,st(function(l){Kt.call(this,t,l)})),p("click",c,function(...l){d()?.apply(this,l)}),p("keydown",c,l=>l.key==="Escape"&&d()()),A(i,c),Ee()}var Tn=F('<canvas class="blur-canvas svelte-pjowa5"></canvas>'),An=F('<div class="blur-brush-indicator svelte-pjowa5"></div>'),Fn=F('<div class="blur-brush-preview svelte-pjowa5"></div>'),qn=F('<div class="crop-overlay svelte-pjowa5"><div class="overlay-top svelte-pjowa5"></div> <div class="overlay-bottom svelte-pjowa5"></div> <div class="overlay-left svelte-pjowa5"></div> <div class="overlay-right svelte-pjowa5"></div> <div class="crop-box svelte-pjowa5" role="button" aria-label="Drag to move crop area" tabindex="0"><div class="crop-border svelte-pjowa5"></div> <div class="corner-handle top-left svelte-pjowa5" role="button" aria-label="Resize top-left corner" tabindex="0"></div> <div class="corner-handle top-right svelte-pjowa5" role="button" aria-label="Resize top-right corner" tabindex="0"></div> <div class="corner-handle bottom-left svelte-pjowa5" role="button" aria-label="Resize bottom-left corner" tabindex="0"></div> <div class="corner-handle bottom-right svelte-pjowa5" role="button" aria-label="Resize bottom-right corner" tabindex="0"></div></div></div>'),On=F('<div class="crop-canvas svelte-pjowa5" role="application" aria-label="Image crop canvas"><div class="image-wrapper svelte-pjowa5"><img alt="Crop preview" class="canvas-image svelte-pjowa5" draggable="false"/> <!></div> <!> <!> <!></div>');function Hn(i,t){Be(t,!1);const e=U(),n=U(),o=U(),r=U();let d=h(t,"imageSrc",8,""),c=h(t,"cropBox",24,()=>({x:10,y:10,width:80,height:80})),s=h(t,"isCropping",8,!1),v=h(t,"scale",8,1),b=h(t,"offsetX",8,0),k=h(t,"offsetY",8,0),S=h(t,"imageWidth",8,0),x=h(t,"imageHeight",8,0),y=h(t,"editFilters",8,""),R=h(t,"blurEnabled",8,!1),l=h(t,"blurBrushSize",8,50),w=h(t,"blurStrength",8,50),M=h(t,"blurSoften",8,50),E=h(t,"blurInvert",8,!1),L=h(t,"blurMask",24,()=>[]),D=h(t,"showBrushPreview",8,!1);const I=gn();let C=U(),P=U(),j=U({width:0,height:0}),G=!1,ae=null,ge=0,le=0,ee=null,he=0,O=1,H=!1,ie=U({x:0,y:0,visible:!1}),ve=U(null),Se=U("");async function we(){z(Se,d());const B=new Image;B.crossOrigin="anonymous",B.onload=()=>{z(ve,B)},B.src=d()}function Ze(B){const J=document.createElement("canvas");J.width=a(ve).naturalWidth,J.height=a(ve).naturalHeight;const re=J.getContext("2d");return re.filter=`blur(${B}px)`,re.drawImage(a(ve),0,0),J}function Te(){if(!a(P)||!a(ve)||!L())return;const B=a(P).getContext("2d"),J=a(P).width,re=a(P).height;if(B.clearRect(0,0,J,re),L().length===0)return;const X=J/S(),ce=re/x();if(L().some($=>$.invert)){const $=L().reduce((W,ne)=>W+(ne.strength||50),0)/L().length;L().reduce((W,ne)=>W+(ne.soften||50),0)/L().length;const _=.5+$/100*9.5,T=Ze(_);B.drawImage(T,0,0,J,re),B.globalCompositeOperation="destination-out";for(const W of L()){if(!W.invert)continue;const ne=W.x*X,Q=W.y*ce,xe=W.radius*Math.min(X,ce),Ce=(W.soften||50)/100,De=Math.max(0,.3-Ce*.3),ze=.3+(1-Ce)*.4,_e=B.createRadialGradient(ne,Q,0,ne,Q,xe);_e.addColorStop(De,"rgba(0,0,0,1)"),_e.addColorStop(ze,`rgba(0,0,0,${.5+Ce*.3})`),_e.addColorStop(1,"rgba(0,0,0,0)"),B.fillStyle=_e,B.beginPath(),B.arc(ne,Q,xe,0,Math.PI*2),B.fill()}B.globalCompositeOperation="source-over"}else for(const $ of L()){const _=$.x*X,T=$.y*ce,W=$.radius*Math.min(X,ce),ne=$.strength||50,Q=($.soften||50)/100,xe=.5+ne/100*9.5,Ce=Ze(xe);B.save();const De=Math.max(0,.2-Q*.2),ze=.2+(1-Q)*.5,_e=B.createRadialGradient(_,T,0,_,T,W);_e.addColorStop(De,"rgba(255,255,255,1)"),_e.addColorStop(ze,`rgba(255,255,255,${.4+Q*.3})`),_e.addColorStop(1,"rgba(255,255,255,0)"),B.beginPath(),B.arc(_,T,W,0,Math.PI*2),B.clip(),B.drawImage(Ce,0,0,J,re),B.restore()}}Bt(()=>(Ue(),window.addEventListener("resize",Ue),()=>window.removeEventListener("resize",Ue)));function Ue(){if(a(C)){const B=a(C).getBoundingClientRect();z(j,{width:B.width,height:B.height})}}function N(B){return B.touches&&B.touches.length>0?{x:B.touches[0].clientX,y:B.touches[0].clientY}:{x:B.clientX,y:B.clientY}}function Y(B){if(B.touches&&B.touches.length>=2){const J=B.touches[0].clientX-B.touches[1].clientX,re=B.touches[0].clientY-B.touches[1].clientY;return Math.sqrt(J*J+re*re)}return 0}function Z(B,J="move"){if(!s())return;if(B.touches&&B.touches.length>=2){he=Y(B),O=v(),ae="pinch";return}B.preventDefault(),G=!0,ae=J;const re=N(B);ge=re.x,le=re.y,ee={...c()}}function fe(B){if(!s())return;if(ae==="pinch"&&B.touches&&B.touches.length>=2){const Ie=Y(B),$=O*(Ie/he);I("scaleChange",{scale:Math.max(.5,Math.min(3,$))});return}if(!G||!ee)return;B.preventDefault();const J=N(B),re=(J.x-ge)/a(e)*100,X=(J.y-le)/a(n)*100;let ce={...ee};if(ae==="move")ce.x=Math.max(0,Math.min(100-ee.width,ee.x+re)),ce.y=Math.max(0,Math.min(100-ee.height,ee.y+X));else if(ae.includes("corner")){if(ae.includes("left")){const $=ee.x+re,_=ee.width-re;_>=10&&$>=0&&(ce.x=$,ce.width=_)}if(ae.includes("right")){const $=ee.width+re;$>=10&&ee.x+$<=100&&(ce.width=$)}if(ae.includes("top")){const $=ee.y+X,_=ee.height-X;_>=10&&$>=0&&(ce.y=$,ce.height=_)}if(ae.includes("bottom")){const $=ee.height+X;$>=10&&ee.y+$<=100&&(ce.height=$)}}I("cropChange",{cropBox:ce})}function pe(){G=!1,ae=null,ee=null,H&&(H=!1)}function qe(B){R()&&(B.preventDefault(),H=!0,We(B))}function Pe(B){if(!R())return;const J=a(C).getBoundingClientRect(),re=N(B);z(ie,{x:re.x-J.left,y:re.y-J.top,visible:!0}),H&&We(B)}function Ae(){z(ie,{...a(ie),visible:!1}),H&&(H=!1)}function We(B){const J=a(C).getBoundingClientRect(),re=N(B),X=(re.x-J.left)/a(e)*S(),ce=(re.y-J.top)/a(n)*x(),Ie=l()/100*Math.min(S(),x())*.15;I("blurPaint",{point:{x:X,y:ce,radius:Ie,strength:w(),soften:M(),invert:E()}})}Ye(()=>a(j),()=>{z(e,a(j).width)}),Ye(()=>(Re(x()),Re(S()),a(e)),()=>{z(n,x()&&S()?a(e)*x()/S():0)}),Ye(()=>(Re(l()),a(e),a(n)),()=>{z(o,l()/100*Math.min(a(e),a(n))*.3)}),Ye(()=>(Re(d()),a(P),a(Se)),()=>{d()&&a(P)&&d()!==a(Se)&&we()}),Ye(()=>(Re(L()),a(P),a(ve)),()=>{L()&&Array.isArray(L())&&L().length>0&&a(P)&&a(ve)&&Te()}),Ye(()=>(Re(c()),a(e),a(n)),()=>{z(r,{x:c().x/100*a(e),y:c().y/100*a(n),width:c().width/100*a(e),height:c().height/100*a(n)})}),pt(),Le();var ue=On(),je=f(ue),q=f(je),Fe=u(q,2);{var it=B=>{var J=Tn();ht(J,re=>z(P,re),()=>a(P)),K(()=>{ke(J,"width",a(e)),ke(J,"height",a(n)),ye(J,`filter: ${y()??""};`)}),A(B,J)};te(Fe,B=>{R()&&a(e)>0&&a(n)>0&&B(it)})}g(je);var Oe=u(je,2);{var Me=B=>{var J=An();K(()=>ye(J,`
				left: ${a(ie),m(()=>a(ie).x)??""}px;
				top: ${a(ie),m(()=>a(ie).y)??""}px;
				width: ${a(o)??""}px;
				height: ${a(o)??""}px;
			`)),A(B,J)};te(Oe,B=>{Re(R()),a(ie),m(()=>R()&&a(ie).visible)&&B(Me)})}var oe=u(Oe,2);{var me=B=>{var J=Fn();K(()=>ye(J,`
				left: ${a(e)/2}px;
				top: ${a(n)/2}px;
				width: ${a(o)??""}px;
				height: ${a(o)??""}px;
			`)),A(B,J)};te(oe,B=>{D()&&a(e)>0&&a(n)>0&&B(me)})}var Ge=u(oe,2);{var Ne=B=>{var J=qn(),re=f(J),X=u(re,2),ce=u(X,2),Ie=u(ce,2),$=u(Ie,2),_=u(f($),2),T=u(_,2),W=u(T,2),ne=u(W,2);g($),g(J),K(()=>{ye(re,`height: ${a(r),m(()=>a(r).y)??""}px;`),ye(X,`top: ${a(r),m(()=>a(r).y+a(r).height)??""}px; height: ${a(n),a(r),m(()=>a(n)-a(r).y-a(r).height)??""}px;`),ye(ce,`top: ${a(r),m(()=>a(r).y)??""}px; height: ${a(r),m(()=>a(r).height)??""}px; width: ${a(r),m(()=>a(r).x)??""}px;`),ye(Ie,`top: ${a(r),m(()=>a(r).y)??""}px; height: ${a(r),m(()=>a(r).height)??""}px; left: ${a(r),m(()=>a(r).x+a(r).width)??""}px; width: ${a(e),a(r),m(()=>a(e)-a(r).x-a(r).width)??""}px;`),ye($,`left: ${a(r),m(()=>a(r).x)??""}px; top: ${a(r),m(()=>a(r).y)??""}px; width: ${a(r),m(()=>a(r).width)??""}px; height: ${a(r),m(()=>a(r).height)??""}px;`)}),p("mousedown",_,st(Q=>Z(Q,"corner-top-left"))),p("touchstart",_,st(Q=>Z(Q,"corner-top-left"))),p("mousedown",T,st(Q=>Z(Q,"corner-top-right"))),p("touchstart",T,st(Q=>Z(Q,"corner-top-right"))),p("mousedown",W,st(Q=>Z(Q,"corner-bottom-left"))),p("touchstart",W,st(Q=>Z(Q,"corner-bottom-left"))),p("mousedown",ne,st(Q=>Z(Q,"corner-bottom-right"))),p("touchstart",ne,st(Q=>Z(Q,"corner-bottom-right"))),p("mousedown",$,Q=>Z(Q,"move")),p("touchstart",$,Q=>Z(Q,"move")),A(B,J)};te(Ge,B=>{s()&&a(n)>0&&B(Ne)})}g(ue),ht(ue,B=>z(C,B),()=>a(C)),K(()=>{ye(je,`transform: scale(${v()??""}) translate(${b()??""}px, ${k()??""}px);`),ke(q,"src",d()),ye(q,`filter: ${y()??""};`)}),p("mousemove",ue,function(...B){(R()?Pe:fe)?.apply(this,B)}),p("mouseup",ue,pe),p("mouseleave",ue,function(...B){(R()?Ae:pe)?.apply(this,B)}),p("touchmove",ue,function(...B){(R()?Pe:fe)?.apply(this,B)}),p("touchend",ue,pe),p("mousedown",ue,function(...B){(R()?qe:null)?.apply(this,B)}),p("touchstart",ue,function(...B){(R()?qe:null)?.apply(this,B)}),A(i,ue),Ee()}var Un=F('<img alt="" class="toggle-icon svelte-1gdqxne"/>'),Wn=F('<span class="toggle-label svelte-1gdqxne"> </span>'),jn=F("<div><button><!></button> <!></div>"),Nn=F("<div></div>");function Aa(i,t){Be(t,!1);let e=h(t,"options",24,()=>[]),n=h(t,"value",8,""),o=h(t,"onChange",8,v=>{}),r=h(t,"showLabels",8,!0),d=h(t,"centered",8,!1);Le();var c=Nn();let s;vt(c,5,e,dt,(v,b)=>{var k=jn();let S;var x=f(k);let y;var R=f(x);{var l=E=>{var L=Un();K(()=>ke(L,"src",`/icons/${a(b),m(()=>a(b).icon)??""}.svg`)),A(E,L)};te(R,E=>{a(b),m(()=>a(b).icon)&&E(l)})}g(x);var w=u(x,2);{var M=E=>{var L=Wn(),D=f(L,!0);g(L),K(()=>He(D,(a(b),m(()=>a(b).label)))),A(E,L)};te(w,E=>{Re(r()),a(b),m(()=>r()&&a(b).label)&&E(M)})}g(k),K(()=>{S=de(k,1,"toggle-item svelte-1gdqxne",null,S,{active:n()===a(b).id}),y=de(x,1,"toggle-btn svelte-1gdqxne",null,y,{active:n()===a(b).id}),ke(x,"aria-label",(a(b),m(()=>a(b).label)))}),p("click",x,()=>o()(a(b).id)),A(v,k)}),g(c),K(()=>s=de(c,1,"toggle-group svelte-1gdqxne",null,s,{centered:d()})),A(i,c),Ee()}var Yn=F('<label class="input-label svelte-1r47u3b"> <input class="input svelte-1r47u3b"/></label>'),Xn=F('<input class="input svelte-1r47u3b"/>'),Gn=F('<div class="input-field svelte-1r47u3b"><!></div>');function wa(i,t){Be(t,!1);let e=h(t,"label",8,""),n=h(t,"value",12,""),o=h(t,"type",8,"text"),r=h(t,"placeholder",8,""),d=h(t,"disabled",8,!1),c=h(t,"onChange",8,x=>{});function s(x){n(x.target.value),c()(n())}Le();var v=Gn(),b=f(v);{var k=x=>{var y=Yn(),R=f(y),l=u(R);Ft(l),g(y),K(()=>{He(R,`${e()??""} `),ke(l,"type",o()),qt(l,n()),ke(l,"placeholder",r()),l.disabled=d()}),p("input",l,s),A(x,y)},S=x=>{var y=Xn();Ft(y),K(()=>{ke(y,"type",o()),qt(y,n()),ke(y,"placeholder",r()),y.disabled=d()}),p("input",y,s),A(x,y)};te(b,x=>{e()?x(k):x(S,!1)})}g(v),A(i,v),Ee()}var Qn=F('<span class="slider-value svelte-jchife"> </span>'),Vn=F('<div class="slider-header svelte-jchife"><span class="slider-label svelte-jchife"> </span> <!></div>'),Jn=F('<div class="slider-container svelte-jchife"><!> <input type="range" class="slider svelte-jchife"/></div>');function Je(i,t){Be(t,!1);let e=h(t,"label",8,""),n=h(t,"min",8,0),o=h(t,"max",8,100),r=h(t,"value",8,50),d=h(t,"step",8,1),c=h(t,"showValue",8,!1),s=h(t,"onChange",8,M=>{}),v=h(t,"onInteractionStart",8,()=>{}),b=h(t,"onInteractionEnd",8,()=>{});function k(M){const E=Number(M.target.value);s()(E)}function S(){v()()}function x(){b()()}Le();var y=Jn(),R=f(y);{var l=M=>{var E=Vn(),L=f(E),D=f(L,!0);g(L);var I=u(L,2);{var C=P=>{var j=Qn(),G=f(j,!0);g(j),K(()=>He(G,r())),A(P,j)};te(I,P=>{c()&&P(C)})}g(E),K(()=>He(D,e())),A(M,E)};te(R,M=>{e()&&M(l)})}var w=u(R,2);Ft(w),g(y),K(()=>{ke(w,"min",n()),ke(w,"max",o()),ke(w,"step",d()),qt(w,r())}),p("input",w,k),p("mousedown",w,S),p("touchstart",w,S),p("mouseup",w,x),p("touchend",w,x),A(i,y),Ee()}var Zn=F('<div class="apply-row svelte-17iy3mz"><button class="btn-apply svelte-17iy3mz">Apply</button></div>'),Kn=F('<div class="crop-controls svelte-17iy3mz"><!> <div class="dimensions-row svelte-17iy3mz"><div class="dimension-input svelte-17iy3mz"><!></div> <button class="icon-btn svelte-17iy3mz"><img alt="" class="icon-btn-img svelte-17iy3mz"/></button> <div class="dimension-input svelte-17iy3mz"><!></div> <button class="icon-btn svelte-17iy3mz" aria-label="Flip horizontal"><img src="/icons/icon-flip-horizontal.svg" alt="" class="icon-btn-img svelte-17iy3mz"/></button> <button class="icon-btn svelte-17iy3mz" aria-label="Rotate"><img src="/icons/icon-rotate.svg" alt="" class="icon-btn-img svelte-17iy3mz"/></button></div> <!> <!></div>');function $n(i,t){Be(t,!1);let e=h(t,"aspectRatio",8,"9:16"),n=h(t,"cropWidth",8,1080),o=h(t,"cropHeight",8,1920),r=h(t,"ratioLocked",8,!0),d=h(t,"scale",8,100),c=h(t,"cropPending",8,!1),s=h(t,"onRatioChange",8,O=>{}),v=h(t,"onDimensionsChange",8,({width:O,height:H})=>{}),b=h(t,"onLockToggle",8,()=>{}),k=h(t,"onFlip",8,()=>{}),S=h(t,"onRotate",8,()=>{}),x=h(t,"onScaleChange",8,O=>{}),y=h(t,"onApply",8,()=>{});const R=[{id:"9:16",label:"9:16",icon:"icon-vertical"},{id:"1:1",label:"1:1",icon:"icon-square"},{id:"16:9",label:"16:9",icon:"icon-horizontal"},{id:"custom",label:"Custom",icon:"icon-custom"}];function l(O){const H=parseInt(O)||0;v()({width:H,height:o()})}function w(O){const H=parseInt(O)||0;v()({width:n(),height:H})}Le();var M=Kn(),E=f(M);Aa(E,{get options(){return R},get value(){return e()},get onChange(){return s()},showLabels:!0});var L=u(E,2),D=f(L),I=f(D);{let O=Ve(()=>(Re(n()),m(()=>n().toString())));wa(I,{label:"Width",type:"number",get value(){return a(O)},onChange:l})}g(D);var C=u(D,2),P=f(C);g(C);var j=u(C,2),G=f(j);{let O=Ve(()=>(Re(o()),m(()=>o().toString())));wa(G,{label:"Height",type:"number",get value(){return a(O)},onChange:w})}g(j);var ae=u(j,2),ge=u(ae,2);g(L);var le=u(L,2);Je(le,{label:"Scale",min:50,max:200,get value(){return d()},step:1,showValue:!0,get onChange(){return x()}});var ee=u(le,2);{var he=O=>{var H=Zn(),ie=f(H);g(H),p("click",ie,function(...ve){y()?.apply(this,ve)}),A(O,H)};te(ee,O=>{c()&&O(he)})}g(M),K(()=>{ke(C,"aria-label",r()?"Unlock aspect ratio":"Lock aspect ratio"),ke(P,"src",`/icons/${r()?"icon-lock":"icon-unlock"}.svg`)}),p("click",C,function(...O){b()?.apply(this,O)}),p("click",ae,function(...O){k()?.apply(this,O)}),p("click",ge,function(...O){S()?.apply(this,O)}),A(i,M),Ee()}var ei=F("<button> </button>"),ti=F("<button> </button>"),ai=F('<div class="blur-controls svelte-1e1k0ax"><div class="blur-control-row svelte-1e1k0ax"><!> <label class="invert-checkbox svelte-1e1k0ax"><input type="checkbox" class="svelte-1e1k0ax"/> <span class="checkbox-label svelte-1e1k0ax">Invert</span></label></div> <div class="slider-row svelte-1e1k0ax"><div class="slider-track svelte-1e1k0ax"><!></div> <button class="reset-btn svelte-1e1k0ax" aria-label="Reset"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-1e1k0ax"/></button></div> <div class="zoom-row svelte-1e1k0ax"><span class="zoom-label svelte-1e1k0ax">Zoom in</span> <div class="zoom-slider-row svelte-1e1k0ax"><div class="slider-track svelte-1e1k0ax"><!></div> <button class="reset-btn svelte-1e1k0ax" aria-label="Reset zoom"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-1e1k0ax"/></button></div></div> <div class="nudge-row svelte-1e1k0ax"><button class="nudge-btn svelte-1e1k0ax" aria-label="Nudge up"><img src="/icons/icon-nudge-up.svg" alt="" class="svelte-1e1k0ax"/></button> <button class="nudge-btn svelte-1e1k0ax" aria-label="Nudge down"><img src="/icons/icon-nudge-down.svg" alt="" class="svelte-1e1k0ax"/></button> <button class="nudge-btn svelte-1e1k0ax" aria-label="Nudge left"><img src="/icons/icon-nudge-left.svg" alt="" class="svelte-1e1k0ax"/></button> <button class="nudge-btn svelte-1e1k0ax" aria-label="Nudge right"><img src="/icons/icon-nudge-right.svg" alt="" class="svelte-1e1k0ax"/></button></div></div>'),ni=F('<div class="edit-controls svelte-1e1k0ax"><div class="enhancement-row svelte-1e1k0ax"></div> <div class="slider-row svelte-1e1k0ax"><div class="slider-track svelte-1e1k0ax"><!></div> <button class="reset-btn svelte-1e1k0ax" aria-label="Reset"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-1e1k0ax"/></button></div> <div class="blur-section svelte-1e1k0ax"><div class="blur-header svelte-1e1k0ax"><button class="chevron-btn svelte-1e1k0ax"><img alt=""/></button> <span class="blur-label svelte-1e1k0ax">Blur</span> <button><span class="toggle-thumb svelte-1e1k0ax"></span></button></div> <!></div></div>');function ii(i,t){Be(t,!1);const e=U(),n=U(),o=U(),r=U(),d=U(),c=U();let s=h(t,"brightness",8,0),v=h(t,"shadows",8,0),b=h(t,"contrast",8,0),k=h(t,"hdr",8,0),S=h(t,"blurBrushSize",8,50),x=h(t,"blurStrength",8,50),y=h(t,"blurSoften",8,50),R=h(t,"blurInvert",8,!1),l=h(t,"zoomLevel",8,1),w=h(t,"blurEnabled",8,!1),M=h(t,"onBrightnessChange",8,X=>{}),E=h(t,"onShadowsChange",8,X=>{}),L=h(t,"onContrastChange",8,X=>{}),D=h(t,"onHdrChange",8,X=>{}),I=h(t,"onBlurBrushSizeChange",8,X=>{}),C=h(t,"onBlurStrengthChange",8,X=>{}),P=h(t,"onBlurSoftenChange",8,X=>{}),j=h(t,"onBlurInvertChange",8,X=>{}),G=h(t,"onZoomChange",8,X=>{}),ae=h(t,"onNudge",8,X=>{}),ge=h(t,"onResetZoom",8,()=>{}),le=h(t,"onBlurToggle",8,X=>{}),ee=h(t,"onBrushPreviewChange",8,X=>{}),he=h(t,"onEditEnd",8,()=>{}),O=U("brightness"),H=U(w()),ie=U("brushSize");const ve=[{id:"brightness",label:"Brightness"},{id:"shadows",label:"Shadows"},{id:"contrast",label:"Contrast"},{id:"hdr",label:"HDR"}],Se=[{id:"brushSize",label:"Brush size"},{id:"strength",label:"Strength"},{id:"soften",label:"Soften edges"}];function we(X){switch(a(O)){case"brightness":M()(X);break;case"shadows":E()(X);break;case"contrast":L()(X);break;case"hdr":D()(X);break}}function Ze(){we(0)}function Te(X){switch(a(ie)){case"brushSize":I()(X);break;case"strength":C()(X);break;case"soften":P()(X);break}}function Ue(){Te(50)}function N(){const X=!w();le()(X),z(H,X)}function Y(){w()&&z(H,!a(H))}function Z(){j()(!R())}function fe(X){z(O,X),z(H,!1)}function pe(X){z(ie,X)}function qe(){he()()}function Pe(){a(ie)==="brushSize"&&ee()(!0)}function Ae(){ee()(!1),he()()}Ye(()=>(a(O),Re(s()),Re(v()),Re(b()),Re(k())),()=>{z(e,(()=>{switch(a(O)){case"brightness":return s();case"shadows":return v();case"contrast":return b();case"hdr":return k();default:return 0}})())}),Ye(()=>a(O),()=>{z(n,a(O)==="hdr"?0:-100)}),Ye(()=>{},()=>{z(o,100)}),Ye(()=>(a(ie),Re(S()),Re(x()),Re(y())),()=>{z(r,(()=>{switch(a(ie)){case"brushSize":return S();case"strength":return x();case"soften":return y();default:return 50}})())}),Ye(()=>{},()=>{z(d,1)}),Ye(()=>{},()=>{z(c,100)}),pt(),Le();var We=ni(),ue=f(We);vt(ue,5,()=>ve,dt,(X,ce)=>{var Ie=ei();let $;var _=f(Ie,!0);g(Ie),K(()=>{$=de(Ie,1,"enhancement-btn svelte-1e1k0ax",null,$,{active:a(O)===a(ce).id}),He(_,(a(ce),m(()=>a(ce).label)))}),p("click",Ie,()=>fe(a(ce).id)),A(X,Ie)}),g(ue);var je=u(ue,2),q=f(je),Fe=f(q);Je(Fe,{get min(){return a(n)},get max(){return a(o)},get value(){return a(e)},step:1,onChange:we,onInteractionEnd:qe}),g(q);var it=u(q,2);g(je);var Oe=u(je,2),Me=f(Oe),oe=f(Me),me=f(oe);let Ge;g(oe);var Ne=u(oe,4);let B;g(Me);var J=u(Me,2);{var re=X=>{var ce=ai(),Ie=f(ce),$=f(Ie);vt($,1,()=>Se,dt,(V,be)=>{var $e=ti();let at;var Et=f($e,!0);g($e),K(()=>{at=de($e,1,"blur-control-btn svelte-1e1k0ax",null,at,{active:a(ie)===a(be).id}),He(Et,(a(be),m(()=>a(be).label)))}),p("click",$e,()=>pe(a(be).id)),A(V,$e)});var _=u($,2),T=f(_);Ft(T),yt(2),g(_),g(Ie);var W=u(Ie,2),ne=f(W),Q=f(ne);Je(Q,{get min(){return a(d)},get max(){return a(c)},get value(){return a(r)},step:1,onChange:Te,onInteractionStart:Pe,onInteractionEnd:Ae}),g(ne);var xe=u(ne,2);g(W);var Ce=u(W,2),De=u(f(Ce),2),ze=f(De),_e=f(ze);Je(_e,{min:1,max:3,step:.1,get value(){return l()},get onChange(){return G()}}),g(ze);var rt=u(ze,2);g(De),g(Ce);var Ke=u(Ce,2),wt=f(Ke),et=u(wt,2),lt=u(et,2),kt=u(lt,2);g(Ke),g(ce),K(()=>_n(T,R())),p("change",T,Z),p("click",xe,Ue),p("click",rt,function(...V){ge()?.apply(this,V)}),p("click",wt,()=>ae()("up")),p("click",et,()=>ae()("down")),p("click",lt,()=>ae()("left")),p("click",kt,()=>ae()("right")),A(X,ce)};te(J,X=>{a(H)&&w()&&X(re)})}g(Oe),g(We),K(()=>{oe.disabled=!w(),ke(oe,"aria-label",a(H)?"Collapse":"Expand"),ke(me,"src",`/icons/${a(H)?"icon-collapse":"icon-expand"}.svg`),Ge=de(me,1,"chevron-icon svelte-1e1k0ax",null,Ge,{disabled:!w()}),B=de(Ne,1,"toggle-switch svelte-1e1k0ax",null,B,{active:w()}),ke(Ne,"aria-label",w()?"Disable blur":"Enable blur")}),p("click",it,Ze),p("click",oe,Y),p("click",Ne,N),A(i,We),Ee()}var oi=F('<button><div class="filter-preview svelte-183y0dt"></div> <span> </span></button>'),ri=F('<div class="filter-grid svelte-183y0dt"></div>');function li(i,t){Be(t,!1);let e=h(t,"filters",24,()=>[]),n=h(t,"value",8,"original"),o=h(t,"imageUrl",8,""),r=h(t,"onChange",8,c=>{});Le();var d=ri();vt(d,5,e,dt,(c,s)=>{var v=oi();let b;var k=f(v),S=u(k,2);let x;var y=f(S,!0);g(S),g(v),K(()=>{b=de(v,1,"filter-card svelte-183y0dt",null,b,{active:n()===a(s).id}),ye(k,`
					background-image: url(${o()??""});
					filter: ${a(s),m(()=>a(s).css||"none")??""};
				`),x=de(S,1,"filter-label svelte-183y0dt",null,x,{active:n()===a(s).id}),He(y,(a(s),m(()=>a(s).label)))}),p("click",v,()=>r()(a(s).id)),A(c,v)}),g(d),A(i,d),Ee()}var si=F('<div class="filter-controls svelte-1274k9v"><!> <div><div class="slider-track svelte-1274k9v"><!></div> <button class="reset-btn svelte-1274k9v" aria-label="Reset filter"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-1274k9v"/></button></div></div>');function ci(i,t){Be(t,!1);const e=U();let n=h(t,"imageUrl",8,""),o=h(t,"activeFilter",8,"original"),r=h(t,"filterStrength",8,50),d=h(t,"onFilterChange",8,w=>{}),c=h(t,"onStrengthChange",8,w=>{}),s=h(t,"onReset",8,()=>{});const v=[{id:"original",label:"Original",css:"none"},{id:"greyscale",label:"Greyscale",css:"grayscale(100%)"},{id:"sepia",label:"Sepia",css:"sepia(100%)"},{id:"sunset",label:"Sunset",css:"sepia(30%) saturate(140%) brightness(110%) hue-rotate(-10deg)"},{id:"azure",label:"Azure",css:"saturate(120%) brightness(105%) hue-rotate(180deg)"},{id:"teal",label:"Teal",css:"saturate(130%) hue-rotate(140deg)"}];Ye(()=>Re(o()),()=>{z(e,o()==="original")}),pt();var b=si(),k=f(b);li(k,{get filters(){return v},get value(){return o()},get imageUrl(){return n()},get onChange(){return d()}});var S=u(k,2);let x;var y=f(S),R=f(y);{let w=Ve(()=>a(e)?()=>{}:c());Je(R,{label:"Strength",min:0,max:100,get value(){return r()},get onChange(){return a(w)}})}g(y);var l=u(y,2);g(S),g(b),K(()=>x=de(S,1,"slider-row svelte-1274k9v",null,x,{disabled:a(e)})),p("click",l,function(...w){s()?.apply(this,w)}),A(i,b),Ee()}const xa=[{id:"original",label:"Original",css:"none"},{id:"greyscale",label:"Greyscale",css:"grayscale(100%)"},{id:"sepia",label:"Sepia",css:"sepia(100%)"},{id:"sunset",label:"Sunset",css:"sepia(30%) saturate(140%) brightness(110%) hue-rotate(-10deg)"},{id:"azure",label:"Azure",css:"saturate(120%) brightness(105%) hue-rotate(180deg)"},{id:"teal",label:"Teal",css:"saturate(130%) hue-rotate(140deg)"}];function di(i){const t=[i];let e=0,n=0;const o=bt({canUndo:!1,canRedo:!1}),{subscribe:r,set:d,update:c}=bt(i);function s(){o.set({canUndo:e>n,canRedo:e<t.length-1})}return{subscribe:r,undoState:o,set:v=>{t.splice(e+1),t.push(v),e=t.length-1,d(v),s()},update:v=>{c(b=>{const k=v(b);return t.splice(e+1),t.push(k),e=t.length-1,s(),k})},silentUpdate:v=>{c(v)},setBaseState:()=>{n=e,s()},undo:()=>{e>n&&(e--,d(t[e]),s())},redo:()=>{e<t.length-1&&(e++,d(t[e]),s())},canUndo:()=>e>n,canRedo:()=>e<t.length-1,reset:()=>{t.length=0,t.push(i),e=0,n=0,d(i),s()}}}const vi={originalImage:null,currentImage:null,aspectRatio:"custom",width:0,height:0,ratioLocked:!1,scale:1,offsetX:0,offsetY:0,brightness:0,contrast:0,shadows:0,hdr:0,activeFilter:"original",filterStrength:50,cropBox:{x:0,y:0,width:0,height:0},isCropping:!1,cropPending:!1,imageWidth:0,imageHeight:0,blurEnabled:!1,blurBrushSize:50,blurStrength:50,blurSoften:50,blurInvert:!1,blurMask:null,showBrushPreview:!1,zoomLevel:1,zoomOffsetX:0,zoomOffsetY:0},se=di(vi),At=bt("none"),ui=ia(se,i=>i.currentImage!==null);function gi(){se.reset(),At.set("none")}var hi=F('<div class="controls-panel svelte-c9tnuw"><!></div>'),fi=F('<div class="controls-panel svelte-c9tnuw"><!></div>'),bi=F("<!> <!> <!> <!>",1),mi=F('<div class="crop-tab svelte-c9tnuw"><!> <!> <!></div>');function pi(i,t){Be(t,!1);const e=()=>ot(se,"$cropState",d),n=()=>ot(At,"$activeSubMenu",d),o=()=>ot(ui,"$hasImage",d),r=()=>ot(k,"$undoState",d),[d,c]=Rt(),s=U(),v=U(),b=U(),k=se.undoState,S=[{id:"crop",label:"Crop"},{id:"edit",label:"Edit"},{id:"filter",label:"Filter"}];let x=U(null),y=null;async function R(_){const T=await Ut(_);se.set({...e(),originalImage:_,currentImage:_,imageWidth:T.width,imageHeight:T.height,width:T.width,height:T.height,cropBox:{x:0,y:0,width:100,height:100},isCropping:!0,cropPending:!1,aspectRatio:"custom",ratioLocked:!1}),se.setBaseState(),At.set("crop")}function l(_){if(e().cropPending&&n()==="crop"&&_!=="crop"){y=()=>{At.set(_),se.silentUpdate(T=>({...T,isCropping:!1}))},z(x,"save");return}_==="crop"?se.silentUpdate(T=>({...T,isCropping:!0})):se.silentUpdate(T=>({...T,isCropping:!1})),At.set(n()===_?"none":_)}async function w(){return await Bn(e().currentImage,a(b),e().blurMask)}async function M(){if(e().cropPending){y=async()=>{const _=await w();await $t(_)},z(x,"save");return}if(e().currentImage){const _=await w();await $t(_)}}async function E(){if(e().cropPending){y=async()=>{const _=await w();ea(_,"picflam-export.png")},z(x,"save");return}if(e().currentImage){const _=await w();ea(_,"picflam-export.png")}}function L(){z(x,"startAgain")}function D(){se.undo()}function I(){se.redo()}async function C(){z(x,null),await ae(),y&&(await y(),y=null)}function P(){z(x,null),y=null}function j(){z(x,null),gi()}function G(){z(x,null)}async function ae(){const _=e();if(!_.currentImage||!_.cropPending)return;const T=await Da(_.currentImage,_.cropBox,_.imageWidth,_.imageHeight),W=await Ut(T);se.set({..._,currentImage:T,imageWidth:W.width,imageHeight:W.height,width:W.width,height:W.height,cropBox:{x:0,y:0,width:100,height:100},cropPending:!1})}function ge(_){if(_==="custom"){se.silentUpdate(xe=>({...xe,aspectRatio:"custom",cropBox:{x:0,y:0,width:100,height:100},ratioLocked:!1,cropPending:!1}));return}const W={"9:16":9/16,"1:1":1,"16:9":16/9}[_],ne=e().imageWidth/e().imageHeight;let Q;if(_==="9:16"){const Ce=W/ne*100;if(Ce<=100)Q={x:(100-Ce)/2,y:0,width:Ce,height:100};else{const De=ne/W*100;Q={x:0,y:(100-De)/2,width:100,height:De}}}else if(_==="16:9"){const Ce=ne/W*100;if(Ce<=100)Q={x:0,y:(100-Ce)/2,width:100,height:Ce};else{const De=W/ne*100;Q={x:(100-De)/2,y:0,width:De,height:100}}}else if(_==="1:1")if(ne>1){const xe=100/ne;Q={x:(100-xe)/2,y:0,width:xe,height:100}}else{const xe=100*ne;Q={x:0,y:(100-xe)/2,width:100,height:xe}}se.silentUpdate(xe=>({...xe,aspectRatio:_,cropBox:Q,cropPending:!0,isCropping:!0,ratioLocked:!0}))}function le({width:_,height:T}){const W=e().imageWidth,ne=e().imageHeight,Q=Math.min(Math.max(1,_),W),xe=Math.min(Math.max(1,T),ne),Ce=Q/W*100,De=xe/ne*100;let ze;if(e().ratioLocked){const _e=a(s)/a(v);if(_!==a(s)){const Ke=Q/_e/ne*100;ze={x:(100-Ce)/2,y:(100-Math.min(100,Ke))/2,width:Ce,height:Math.min(100,Ke)}}else{const Ke=xe*_e/W*100;ze={x:(100-Math.min(100,Ke))/2,y:(100-De)/2,width:Math.min(100,Ke),height:De}}}else ze={x:(100-Ce)/2,y:(100-De)/2,width:Ce,height:De};se.silentUpdate(_e=>({..._e,cropBox:ze,cropPending:!0}))}function ee(){se.silentUpdate(_=>({..._,ratioLocked:!_.ratioLocked}))}async function he(){const _=await Rn(e().currentImage);se.set({...e(),currentImage:_})}async function O(){const _=await zn(e().currentImage,90),T=await Ut(_);se.set({...e(),currentImage:_,imageWidth:T.width,imageHeight:T.height,cropBox:{x:0,y:0,width:100,height:100},cropPending:!1})}function H(_){se.silentUpdate(T=>({...T,scale:_/100}))}function ie(_){const T=_.detail.cropBox;if(e().ratioLocked&&e().aspectRatio!=="custom"){const ne={"9:16":.5625,"1:1":1,"16:9":1.7777777777777777}[e().aspectRatio];e().imageWidth/e().imageHeight;const Q=T.width*e().imageWidth/(T.height*e().imageHeight);if(Math.abs(Q-ne)>.01){const De=T.width/100*e().imageWidth/ne/e().imageHeight*100;T.height=Math.min(100,De),T.y+T.height>100&&(T.y=100-T.height)}}se.silentUpdate(W=>({...W,cropBox:T,cropPending:!0}))}function ve(){ae()}let Se=null;function we(){Se===null&&(Se={...e()})}function Ze(){Se!==null&&(se.set(e()),Se=null)}function Te(_){we(),se.silentUpdate(T=>({...T,brightness:_}))}function Ue(_){we(),se.silentUpdate(T=>({...T,shadows:_}))}function N(_){we(),se.silentUpdate(T=>({...T,contrast:_}))}function Y(_){we(),se.silentUpdate(T=>({...T,hdr:_}))}function Z(_){se.set({...e(),blurEnabled:_})}function fe(_){we(),se.silentUpdate(T=>({...T,blurBrushSize:_}))}function pe(_){we(),se.silentUpdate(T=>({...T,blurStrength:_}))}function qe(_){we(),se.silentUpdate(T=>({...T,blurSoften:_}))}function Pe(_){se.set({...e(),blurInvert:_})}function Ae(_){se.silentUpdate(T=>({...T,showBrushPreview:_}))}function We(){Ze()}let ue=null,je=[],q=null;function Fe(_){const T=_.detail.point;q===null&&(q=e().blurMask?[...e().blurMask]:[]),je.push(T),se.silentUpdate(W=>({...W,blurMask:[...W.blurMask||[],T]})),ue&&clearTimeout(ue),ue=setTimeout(()=>{if(je.length>0){const W=[...q,...je];se.set({...e(),blurMask:W}),je=[],q=null}ue=null},300)}function it(_){se.silentUpdate(T=>({...T,zoomLevel:_}))}function Oe(_){se.silentUpdate(W=>{let{zoomOffsetX:ne,zoomOffsetY:Q}=W;switch(_){case"up":Q-=20;break;case"down":Q+=20;break;case"left":ne-=20;break;case"right":ne+=20;break}return{...W,zoomOffsetX:ne,zoomOffsetY:Q}})}function Me(){se.silentUpdate(_=>({..._,zoomLevel:1,zoomOffsetX:0,zoomOffsetY:0}))}function oe(_){se.silentUpdate(T=>({...T,activeFilter:_}))}function me(_){we(),se.silentUpdate(T=>({...T,filterStrength:_}))}function Ge(){se.set({...e(),activeFilter:"original",filterStrength:50})}Ye(()=>e(),()=>{z(s,Math.round(e().imageWidth*e().cropBox.width/100))}),Ye(()=>e(),()=>{z(v,Math.round(e().imageHeight*e().cropBox.height/100))}),Ye(()=>(e(),xa),()=>{z(b,(()=>{let _=[];if(e().brightness!==0&&_.push(`brightness(${1+e().brightness/100})`),e().contrast!==0&&_.push(`contrast(${1+e().contrast/100})`),e().shadows!==0){const T=1+e().shadows/200;_.push(`brightness(${T})`)}if(e().hdr!==0){const T=1+e().hdr/100*.3,W=1+e().hdr/100*.2;_.push(`saturate(${T}) contrast(${W})`)}if(e().activeFilter!=="original"){const T=xa.find(W=>W.id===e().activeFilter);if(T&&T.css!=="none"){const W=e().filterStrength/100,ne=T.css.replace(/(\d+)%/g,(Q,xe)=>`${Math.round(parseInt(xe)*W)}%`);_.push(ne)}}return _.length>0?_.join(" "):"none"})())}),pt(),Le();var Ne=mi(),B=f(Ne);{var J=_=>{Ta(_,{title:"Crop, edit and add filters to photos",hint:"Import, drag or paste an image",onImageImport:R})},re=_=>{var T=bi(),W=Xe(T);la(W,{get canUndo(){return r(),m(()=>r().canUndo)},get canRedo(){return r(),m(()=>r().canRedo)},onUndo:D,onRedo:I,onStartAgain:L,onCopy:M,onExport:E});var ne=u(W,2);{let ze=Ve(()=>(n(),e(),m(()=>n()==="edit"?e().zoomLevel:e().scale))),_e=Ve(()=>(n(),e(),m(()=>n()==="edit"?e().zoomOffsetX:e().offsetX))),rt=Ve(()=>(n(),e(),m(()=>n()==="edit"?e().zoomOffsetY:e().offsetY))),Ke=Ve(()=>(e(),m(()=>e().blurMask||[])));Hn(ne,{get imageSrc(){return e(),m(()=>e().currentImage)},get cropBox(){return e(),m(()=>e().cropBox)},get isCropping(){return e(),m(()=>e().isCropping)},get scale(){return a(ze)},get offsetX(){return a(_e)},get offsetY(){return a(rt)},get imageWidth(){return e(),m(()=>e().imageWidth)},get imageHeight(){return e(),m(()=>e().imageHeight)},get editFilters(){return a(b)},get blurEnabled(){return e(),m(()=>e().blurEnabled)},get blurBrushSize(){return e(),m(()=>e().blurBrushSize)},get blurStrength(){return e(),m(()=>e().blurStrength)},get blurSoften(){return e(),m(()=>e().blurSoften)},get blurInvert(){return e(),m(()=>e().blurInvert)},get blurMask(){return a(Ke)},get showBrushPreview(){return e(),m(()=>e().showBrushPreview)},$$events:{cropChange:ie,blurPaint:Fe}})}var Q=u(ne,2);sa(Q,{get tabs(){return S},get activeTab(){return n()},onTabChange:l});var xe=u(Q,2);{var Ce=ze=>{{let _e=Ve(()=>(e(),m(()=>Math.round(e().scale*100))));$n(ze,{get aspectRatio(){return e(),m(()=>e().aspectRatio)},get cropWidth(){return a(s)},get cropHeight(){return a(v)},get ratioLocked(){return e(),m(()=>e().ratioLocked)},get scale(){return a(_e)},get cropPending(){return e(),m(()=>e().cropPending)},onRatioChange:ge,onDimensionsChange:le,onLockToggle:ee,onFlip:he,onRotate:O,onScaleChange:H,onApply:ve})}},De=ze=>{var _e=gt(),rt=Xe(_e);{var Ke=et=>{var lt=hi(),kt=f(lt);ii(kt,{get brightness(){return e(),m(()=>e().brightness)},get shadows(){return e(),m(()=>e().shadows)},get contrast(){return e(),m(()=>e().contrast)},get hdr(){return e(),m(()=>e().hdr)},get blurEnabled(){return e(),m(()=>e().blurEnabled)},get blurBrushSize(){return e(),m(()=>e().blurBrushSize)},get blurStrength(){return e(),m(()=>e().blurStrength)},get blurSoften(){return e(),m(()=>e().blurSoften)},get blurInvert(){return e(),m(()=>e().blurInvert)},get zoomLevel(){return e(),m(()=>e().zoomLevel)},onBrightnessChange:Te,onShadowsChange:Ue,onContrastChange:N,onHdrChange:Y,onBlurToggle:Z,onBlurBrushSizeChange:fe,onBlurStrengthChange:pe,onBlurSoftenChange:qe,onBlurInvertChange:Pe,onZoomChange:it,onNudge:Oe,onResetZoom:Me,onBrushPreviewChange:Ae,onEditEnd:We}),g(lt),A(et,lt)},wt=et=>{var lt=gt(),kt=Xe(lt);{var V=be=>{var $e=fi(),at=f($e);ci(at,{get imageUrl(){return e(),m(()=>e().currentImage)},get activeFilter(){return e(),m(()=>e().activeFilter)},get filterStrength(){return e(),m(()=>e().filterStrength)},onFilterChange:oe,onStrengthChange:me,onReset:Ge}),g($e),A(be,$e)};te(kt,be=>{n()==="filter"&&be(V)},!0)}A(et,lt)};te(rt,et=>{n()==="edit"?et(Ke):et(wt,!1)},!0)}A(ze,_e)};te(xe,ze=>{n()==="crop"?ze(Ce):ze(De,!1)})}A(_,T)};te(B,_=>{o()?_(re,!1):_(J)})}var X=u(B,2);{var ce=_=>{ta(_,{message:"Save changes?",confirmText:"Yes",cancelText:"Cancel",onConfirm:C,onCancel:P})};te(X,_=>{a(x)==="save"&&_(ce)})}var Ie=u(X,2);{var $=_=>{ta(_,{message:"Start again? Your changes will be lost.",confirmText:"Yes",cancelText:"Cancel",onConfirm:j,onCancel:G})};te(Ie,_=>{a(x)==="startAgain"&&_($)})}g(Ne),A(i,Ne),Ee(),c()}var wi=F('<div class="before-after-container svelte-1i0ztfp" role="slider" aria-label="Before and after comparison" tabindex="0"><div class="before-image svelte-1i0ztfp"><img alt="Before" class="svelte-1i0ztfp"/></div> <div class="after-image svelte-1i0ztfp"><img alt="After" class="svelte-1i0ztfp"/></div> <div class="slider-handle svelte-1i0ztfp" role="presentation"><div class="slider-line svelte-1i0ztfp"></div> <div class="slider-thumb svelte-1i0ztfp"><img src="/icons/icon-ai-slider.svg" alt="" class="slider-icon svelte-1i0ztfp"/></div></div></div>');function xi(i,t){Be(t,!1);let e=h(t,"beforeImage",8,""),n=h(t,"afterImage",8,""),o=h(t,"position",12,50),r=h(t,"onChange",8,()=>{}),d=U(),c=!1;Bt(()=>(window.addEventListener("mousemove",b),window.addEventListener("touchmove",k,{passive:!1}),window.addEventListener("mouseup",S),window.addEventListener("touchend",S),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("touchmove",k),window.removeEventListener("mouseup",S),window.removeEventListener("touchend",S)}));function s(){c=!0}function v(D){D.touches.length===1&&(c=!0)}function b(D){!c||!a(d)||x(D.clientX)}function k(D){!c||!a(d)||D.touches.length!==1||(D.preventDefault(),x(D.touches[0].clientX))}function S(){c=!1}function x(D){const I=a(d).getBoundingClientRect(),C=Math.max(0,Math.min(100,(D-I.left)/I.width*100));o(C),r()(C)}function y(D){if(!a(d))return;const I=a(d).getBoundingClientRect(),C=(D.clientX-I.left)/I.width*100;o(Math.max(0,Math.min(100,C))),r()(o())}Le();var R=wi(),l=f(R),w=f(l);g(l);var M=u(l,2),E=f(M);g(M);var L=u(M,2);g(R),ht(R,D=>z(d,D),()=>a(d)),K(()=>{ke(w,"src",e()),ye(M,`clip-path: inset(0 ${100-o()}% 0 0)`),ke(E,"src",n()),ye(L,`left: ${o()??""}%`)}),p("mousedown",L,s),p("touchstart",L,v),p("click",R,y),A(i,R),Ee()}const _a={originalImage:null,currentImage:null,processedImage:null,isProcessing:!1,processingType:null,upscaleFactor:1,showComparison:!1,comparisonPosition:50};function _i(){const{subscribe:i,set:t,update:e}=bt(_a);return{subscribe:i,setImage:n=>e(o=>({...o,originalImage:n,currentImage:n,processedImage:null})),startProcessing:n=>e(o=>({...o,isProcessing:!0,processingType:n})),finishProcessing:n=>e(o=>({...o,isProcessing:!1,processingType:null,processedImage:n,currentImage:n,showComparison:!0})),cancelProcessing:()=>e(n=>({...n,isProcessing:!1,processingType:null})),setUpscaleFactor:n=>e(o=>({...o,upscaleFactor:n})),setComparisonPosition:n=>e(o=>({...o,comparisonPosition:n})),reset:()=>t(_a)}}const tt=_i(),ya=bt("enhance"),yi=ia(tt,i=>i.currentImage!==null);let Lt=null;async function ki(i,t=4,e){e?.("Uploading image...");const n=await fetch("/api/face-enhance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:i,scale:t,faceEnhance:.5})}),o=await n.json();if(!n.ok)throw new Error(o.error||`API error: ${n.status}`);if(o.status==="succeeded"&&o.output)return e?.("Downloading result..."),await Fa(o.output);if(o.status==="processing"||o.status==="starting")return e?.("Processing with CodeFormer..."),await Ci(o.pollUrl,e);throw new Error("Unexpected response")}async function Ci(i,t,e=60){for(let n=0;n<e;n++){await new Promise(d=>setTimeout(d,2e3));const o=await fetch(`/api/upscale?pollUrl=${encodeURIComponent(i)}`),r=await o.json();if(!o.ok)throw new Error(r.error||`Polling error: ${o.status}`);if(r.status==="succeeded"&&r.output)return t?.("Downloading result..."),await Fa(r.output);if(r.status==="failed")throw new Error(r.error||"Upscaling failed");t?.(`Processing in cloud (${(n+1)*2}s)...`)}throw new Error("Timeout waiting for result")}async function Fa(i){const e=await(await fetch(i)).blob();return new Promise((n,o)=>{const r=new FileReader;r.onload=()=>n(r.result),r.onerror=o,r.readAsDataURL(e)})}async function Si(i){if(Lt)return Lt;console.log("[AI] Loading RMBG background removal model..."),i?.("Downloading model (first time only)...");const{pipeline:t,env:e}=await un(async()=>{const{pipeline:n,env:o}=await import("../chunks/bLAnV4ll.js");return{pipeline:n,env:o}},[],import.meta.url);e.allowLocalModels=!1;try{Lt=await t("image-segmentation","briaai/RMBG-1.4",{device:"webgpu",dtype:"fp32"}),console.log("[AI] RMBG model ready (WebGPU)")}catch(n){console.log("[AI] WebGPU not available, falling back to WASM...",n.message),Lt=await t("image-segmentation","briaai/RMBG-1.4",{dtype:"q8"}),console.log("[AI] RMBG model ready (WASM)")}return Lt}async function Ii(i,t){try{console.log("[AI] Starting background removal...");const e=await Si(t);t?.("Processing image...");const n=await e(i);if(console.log("[AI] Segmentation result:",n),!n||n.length===0)throw new Error("No segmentation result returned");const o=n[0];if(console.log("[AI] Segment keys:",Object.keys(o)),o.mask&&o.mask.toDataURL)return console.log("[AI] Background removal complete (RawImage mask)"),await ka(i,o.mask);if(o.mask&&o.mask.data)return console.log("[AI] Background removal complete (data mask)"),await ka(i,o.mask);if(typeof o=="string"&&o.startsWith("data:"))return console.log("[AI] Background removal complete (direct output)"),o;throw console.log("[AI] Segment structure:",JSON.stringify(o,null,2).substring(0,500)),new Error("Unexpected segmentation result format")}catch(e){throw console.error("[AI] Background removal failed:",e),new Error("Background removal failed: "+e.message)}}async function ka(i,t){return new Promise((e,n)=>{const o=new Image;o.onload=async()=>{try{const r=document.createElement("canvas");r.width=o.width,r.height=o.height;const d=r.getContext("2d");d.drawImage(o,0,0);const c=d.getImageData(0,0,r.width,r.height),s=c.data;let v,b,k;if(t.toDataURL){const x=document.createElement("canvas");x.width=t.width,x.height=t.height;const y=x.getContext("2d"),R=new Image;R.onload=()=>{y.drawImage(R,0,0);const l=y.getImageData(0,0,t.width,t.height);Ca(s,l.data,r.width,r.height,t.width,t.height,!0),d.putImageData(c,0,0),e(r.toDataURL("image/png"))},R.onerror=n,R.src=t.toDataURL();return}else v=t.data,b=t.width,k=t.height;const S=v.length===b*k*4;Ca(s,v,r.width,r.height,b,k,S),d.putImageData(c,0,0),e(r.toDataURL("image/png"))}catch(r){n(r)}},o.onerror=n,o.src=i})}function Ca(i,t,e,n,o,r,d){const c=o/e,s=r/n;for(let v=0;v<n;v++)for(let b=0;b<e;b++){const k=Math.floor(b*c),S=Math.floor(v*s);let x;if(d){const R=(S*o+k)*4;x=t[R]}else{const R=S*o+k;x=t[R]||0}const y=(v*e+b)*4;i[y+3]=x}}var zi=F('<div class="size-display svelte-1rgvkgu"> </div>'),Ri=F('<button class="processing-btn svelte-1rgvkgu" disabled><span class="spinner svelte-1rgvkgu"></span> </button> <button class="cancel-btn svelte-1rgvkgu">Cancel</button>',1),Bi=F('<button class="upscale-btn svelte-1rgvkgu"><img src="/icons/icon-ai.svg" alt="" class="btn-icon svelte-1rgvkgu"/> Upscale image</button> <p class="hint svelte-1rgvkgu">Upscales, sharpens and enhances images</p>',1),Ei=F('<div class="error-message svelte-1rgvkgu"> </div>'),Pi=F('<div class="upscale-controls svelte-1rgvkgu"><div class="controls-content svelte-1rgvkgu"><!> <!> <!></div></div>');function Li(i,t){Be(t,!1);const e=()=>ot(tt,"$aiState",n),[n,o]=Rt(),r=4;let d=U(!1),c=U(""),s=U(null),v=U(null);async function b(){try{const I=await mt(e().originalImage),C=Math.round(I.naturalWidth*r),P=Math.round(I.naturalHeight*r);z(v,`${C} x ${P}`)}catch(I){console.error("Failed to get image dimensions:",I)}}async function k(){if(e().originalImage)try{z(d,!0),z(s,null),z(c,"Starting..."),tt.startProcessing("upscale");const I=await ki(e().originalImage,r,C=>{z(c,C)});tt.finishProcessing(I)}catch(I){z(s,I.message||"Upscaling failed"),tt.cancelProcessing()}finally{z(d,!1),z(c,"")}}function S(){z(d,!1),z(c,""),z(s,null),tt.cancelProcessing()}Ye(()=>e(),()=>{e().originalImage&&b()}),pt(),Le();var x=Pi(),y=f(x),R=f(y);{var l=I=>{var C=zi(),P=f(C);g(C),K(()=>He(P,`Output: ${a(v)??""}`)),A(I,C)};te(R,I=>{a(v)&&I(l)})}var w=u(R,2);{var M=I=>{var C=Ri(),P=Xe(C),j=u(f(P));g(P);var G=u(P,2);K(()=>He(j,` ${a(c)||"Processing..."}`)),p("click",G,S),A(I,C)},E=I=>{var C=Bi(),P=Xe(C);yt(2),p("click",P,k),A(I,C)};te(w,I=>{a(d)?I(M):I(E,!1)})}var L=u(w,2);{var D=I=>{var C=Ei(),P=f(C,!0);g(C),K(()=>He(P,a(s))),A(I,C)};te(L,I=>{a(s)&&I(D)})}g(y),g(x),A(i,x),Ee(),o()}var Mi=F('<img alt="Original" class="compare-overlay svelte-1ibkqf6"/>'),Di=F('<div class="brush-indicator svelte-1ibkqf6"></div>'),Ti=F('<div class="brush-preview svelte-1ibkqf6"></div>'),Ai=F('<div class="drawer-overlay svelte-1ibkqf6" role="presentation"><div class="drawer svelte-1ibkqf6" role="dialog"><div class="drawer-header svelte-1ibkqf6"><button class="icon-btn svelte-1ibkqf6" title="Undo"><img src="/icons/icon-undo.svg" alt="Undo" class="svelte-1ibkqf6"/></button> <button class="icon-btn svelte-1ibkqf6" title="Redo"><img src="/icons/icon-redo.svg" alt="Redo" class="svelte-1ibkqf6"/></button> <div class="spacer svelte-1ibkqf6"></div> <button title="Compare"><img src="/icons/icon-compare.svg" alt="Compare" class="svelte-1ibkqf6"/></button></div> <div class="canvas-container svelte-1ibkqf6"><div class="canvas-wrapper svelte-1ibkqf6" role="presentation"><canvas class="svelte-1ibkqf6"></canvas> <!> <!> <!></div></div> <div class="controls-section svelte-1ibkqf6"><div class="button-group svelte-1ibkqf6"><button><img src="/icons/icon-erase.svg" alt="" class="svelte-1ibkqf6"/> Erase</button> <button><img src="/icons/icon-restore.svg" alt="" class="svelte-1ibkqf6"/> Restore</button></div> <div class="control-row svelte-1ibkqf6"><label class="svelte-1ibkqf6">Brush size</label> <div class="control-item svelte-1ibkqf6"><!> <button class="reset-btn svelte-1ibkqf6" title="Reset"><img src="/icons/icon-reset.svg" alt="Reset" class="svelte-1ibkqf6"/></button></div></div> <div class="control-row svelte-1ibkqf6"><label class="svelte-1ibkqf6">Soften edges</label> <div class="control-item svelte-1ibkqf6"><!> <button class="reset-btn svelte-1ibkqf6" title="Reset"><img src="/icons/icon-reset.svg" alt="Reset" class="svelte-1ibkqf6"/></button></div></div> <div class="control-row svelte-1ibkqf6"><label class="svelte-1ibkqf6">Zoom in</label> <div class="control-item svelte-1ibkqf6"><!> <button class="reset-btn svelte-1ibkqf6" title="Reset"><img src="/icons/icon-reset.svg" alt="Reset" class="svelte-1ibkqf6"/></button></div></div> <div class="nudge-buttons svelte-1ibkqf6"><button class="nudge-btn svelte-1ibkqf6">â</button> <button class="nudge-btn svelte-1ibkqf6">â</button> <button class="nudge-btn svelte-1ibkqf6">â</button> <button class="nudge-btn svelte-1ibkqf6">â</button></div> <div class="drawer-footer svelte-1ibkqf6"><button class="btn-cancel svelte-1ibkqf6">Cancel</button> <button class="btn-done svelte-1ibkqf6">Done</button></div></div></div></div>');function Fi(i,t){Be(t,!1);const e=U();let n=h(t,"image",8,""),o=h(t,"originalFullImage",8,""),r=h(t,"onClose",8,()=>{}),d=h(t,"onSave",8,()=>{}),c=U(),s=U(),v,b=U(!0),k=U(20),S=U(50),x=U(1),y=U(0),R=U(0),l=!1,w=[],M=0,E=null,L=U({x:0,y:0,visible:!1}),D=U(!1),I=U(0),C=U(0),P=U(!1);Bt(async()=>{const V=await mt(n());ga(c,a(c).width=V.naturalWidth),ga(c,a(c).height=V.naturalHeight),v=a(c).getContext("2d"),v.drawImage(V,0,0),o()?E=await mt(o()):E=V,j(),G()});function j(){if(a(s)){const V=a(s).getBoundingClientRect();z(I,V.width),z(C,V.height)}}function G(){w=w.slice(0,M+1),w.push(a(c).toDataURL()),M=w.length-1}function ae(){M>0&&(M--,le())}function ge(){M<w.length-1&&(M++,le())}function le(){const V=new Image;V.onload=()=>{v.clearRect(0,0,a(c).width,a(c).height),v.drawImage(V,0,0)},V.src=w[M]}function ee(V){const be=a(s).getBoundingClientRect(),$e=a(c).width/be.width,at=a(c).height/be.height,Et=(V.clientX-be.left)*$e,Ot=(V.clientY-be.top)*at;return{x:Et,y:Ot}}function he(V){l=!0;const{x:be,y:$e}=ee(V);ve(be,$e)}function O(V){const be=a(s).getBoundingClientRect();if(z(L,{x:V.clientX-be.left,y:V.clientY-be.top,visible:!0}),!l)return;const{x:$e,y:at}=ee(V);ve($e,at)}function H(){l&&(l=!1,G())}function ie(){z(L,{...a(L),visible:!1}),l&&(l=!1,G())}function ve(V,be){const $e=a(c).width/a(s).getBoundingClientRect().width,at=a(e)/2*$e,Et=a(S)/100,Ot=Math.min(at-.001,at*(1-Et));v.save();try{if(a(b)){const ut=v.createRadialGradient(V,be,Ot,V,be,at);ut.addColorStop(0,"rgba(0,0,0,1)"),ut.addColorStop(1,"rgba(0,0,0,0)"),v.globalCompositeOperation="destination-out",v.fillStyle=ut,v.beginPath(),v.arc(V,be,at,0,Math.PI*2),v.fill()}else{if(!E)return;const ut=document.createElement("canvas");ut.width=a(c).width,ut.height=a(c).height;const xt=ut.getContext("2d"),Wt=xt.createRadialGradient(V,be,Ot,V,be,at);Wt.addColorStop(0,"rgba(0,0,0,1)"),Wt.addColorStop(1,"rgba(0,0,0,0)"),xt.globalCompositeOperation="source-over",xt.drawImage(E,0,0,ut.width,ut.height),xt.globalCompositeOperation="destination-in",xt.fillStyle=Wt,xt.beginPath(),xt.arc(V,be,at,0,Math.PI*2),xt.fill(),v.globalCompositeOperation="source-over",v.drawImage(ut,0,0)}}finally{v.restore()}}function Se(){z(k,20)}function we(){z(S,50)}function Ze(){z(x,1),z(y,0),z(R,0)}function Te(V){switch(V){case"up":z(R,a(R)-10);break;case"down":z(R,a(R)+10);break;case"left":z(y,a(y)-10);break;case"right":z(y,a(y)+10);break}}function Ue(){r()()}function N(){const V=a(c).toDataURL("image/png");d()(V)}Ye(()=>(a(k),a(I),a(C)),()=>{z(e,a(k)/100*Math.min(a(I)||300,a(C)||300)*.5)}),pt(),Le();var Y=Ai(),Z=f(Y),fe=f(Z),pe=f(fe),qe=u(pe,2),Pe=u(qe,4);let Ae;g(fe);var We=u(fe,2),ue=f(We),je=f(ue);ht(je,V=>z(c,V),()=>a(c));var q=u(je,2);{var Fe=V=>{var be=Mi();K(()=>ke(be,"src",o())),A(V,be)};te(q,V=>{a(P)&&o()&&V(Fe)})}var it=u(q,2);{var Oe=V=>{var be=Di();K(()=>ye(be,`
							left: ${a(L),m(()=>a(L).x)??""}px;
							top: ${a(L),m(()=>a(L).y)??""}px;
							width: ${a(e)??""}px;
							height: ${a(e)??""}px;
						`)),A(V,be)};te(it,V=>{a(L),a(I),m(()=>a(L).visible&&a(I)>0)&&V(Oe)})}var Me=u(it,2);{var oe=V=>{var be=Ti();K(()=>ye(be,`
						left: ${a(I)/2}px;
						top: ${a(C)/2}px;
						width: ${a(e)??""}px;
						height: ${a(e)??""}px;
					`)),A(V,be)};te(Me,V=>{a(D)&&a(I)>0&&a(C)>0&&V(oe)})}g(ue),ht(ue,V=>z(s,V),()=>a(s)),g(We);var me=u(We,2),Ge=f(me),Ne=f(Ge);let B;var J=u(Ne,2);let re;g(Ge);var X=u(Ge,2),ce=u(f(X),2),Ie=f(ce);Je(Ie,{min:5,max:100,step:1,get value(){return a(k)},onChange:V=>z(k,V),onInteractionStart:()=>{j(),z(D,!0)},onInteractionEnd:()=>z(D,!1)});var $=u(Ie,2);g(ce),g(X);var _=u(X,2),T=u(f(_),2),W=f(T);Je(W,{min:0,max:100,step:1,get value(){return a(S)},onChange:V=>z(S,V)});var ne=u(W,2);g(T),g(_);var Q=u(_,2),xe=u(f(Q),2),Ce=f(xe);Je(Ce,{min:1,max:3,step:.1,get value(){return a(x)},onChange:V=>z(x,V)});var De=u(Ce,2);g(xe),g(Q);var ze=u(Q,2),_e=f(ze),rt=u(_e,2),Ke=u(rt,2),wt=u(Ke,2);g(ze);var et=u(ze,2),lt=f(et),kt=u(lt,2);g(et),g(me),g(Z),g(Y),K(()=>{Ae=de(Pe,1,"icon-btn svelte-1ibkqf6",null,Ae,{active:a(P)}),ye(ue,`transform: scale(${a(x)??""}) translate(${a(y)??""}px, ${a(R)??""}px)`),B=de(Ne,1,"mode-btn svelte-1ibkqf6",null,B,{active:a(b)}),re=de(J,1,"mode-btn svelte-1ibkqf6",null,re,{active:!a(b)})}),p("click",pe,ae),p("click",qe,ge),p("mousedown",Pe,()=>z(P,!0)),p("mouseup",Pe,()=>z(P,!1)),p("mouseleave",Pe,()=>z(P,!1)),p("touchstart",Pe,()=>z(P,!0)),p("touchend",Pe,()=>z(P,!1)),p("mousedown",ue,he),p("mousemove",ue,O),p("mouseup",ue,H),p("mouseleave",ue,ie),p("click",Ne,()=>z(b,!0)),p("click",J,()=>z(b,!1)),p("click",$,Se),p("click",ne,we),p("click",De,Ze),p("click",_e,()=>Te("up")),p("click",rt,()=>Te("down")),p("click",Ke,()=>Te("left")),p("click",wt,()=>Te("right")),p("click",lt,Ue),p("click",kt,N),p("click",Z,st(function(V){Kt.call(this,t,V)})),p("click",Y,Ue),A(i,Y),Ee()}var qi=F('<button class="processing-btn svelte-1wdmsm1" disabled><span class="spinner svelte-1wdmsm1"></span> </button> <button class="cancel-btn svelte-1wdmsm1">Cancel</button>',1),Oi=F('<button class="remove-btn svelte-1wdmsm1"><img src="/icons/icon-ai.svg" alt="" class="btn-icon svelte-1wdmsm1"/> Remove background</button> <p class="hint svelte-1wdmsm1">Remove image background with AI</p> <button class="erase-btn svelte-1wdmsm1"><img src="/icons/icon-erase.svg" alt="" class="btn-icon svelte-1wdmsm1"/> Erase and restore</button> <p class="hint svelte-1wdmsm1">Manually clean up background</p>',1),Hi=F('<div class="error-message svelte-1wdmsm1"> </div>'),Ui=F('<div class="background-controls svelte-1wdmsm1"><div class="controls-content svelte-1wdmsm1"><!> <!></div> <!></div>');function Wi(i,t){Be(t,!1);const e=()=>ot(tt,"$aiState",n),[n,o]=Rt(),r=U();let d=U(!1),c=U(""),s=U(null),v=U(!1);async function b(){if(e().originalImage)try{z(d,!0),z(s,null),z(c,"Starting..."),tt.startProcessing("background");const C=await Ii(e().originalImage,P=>{z(c,P)});tt.finishProcessing(C)}catch(C){z(s,C.message||"Background removal failed"),tt.cancelProcessing()}finally{z(d,!1),z(c,"")}}function k(){z(d,!1),z(c,""),z(s,null),tt.cancelProcessing()}function S(){z(v,!0)}function x(){z(v,!1)}Ye(()=>e(),()=>{z(r,e().showComparison&&e().processedImage)}),pt(),Le();var y=Ui(),R=f(y),l=f(R);{var w=C=>{var P=qi(),j=Xe(P),G=u(f(j));g(j);var ae=u(j,2);K(()=>He(G,` ${a(c)||"Processing..."}`)),p("click",ae,k),A(C,P)},M=C=>{var P=Oi(),j=Xe(P),G=u(j,4);yt(2),K(()=>G.disabled=!a(r)),p("click",j,b),p("click",G,S),A(C,P)};te(l,C=>{a(d)?C(w):C(M,!1)})}var E=u(l,2);{var L=C=>{var P=Hi(),j=f(P,!0);g(P),K(()=>He(j,a(s))),A(C,P)};te(E,C=>{a(s)&&C(L)})}g(R);var D=u(R,2);{var I=C=>{Fi(C,{get image(){return e(),m(()=>e().processedImage)},get originalFullImage(){return e(),m(()=>e().originalImage)},onClose:x,onSave:P=>{tt.finishProcessing(P),z(v,!1)}})};te(D,C=>{a(v)&&C(I)})}g(y),A(i,y),Ee(),o()}var ji=F('<img alt="Working image" class="working-image svelte-17agwu4"/>'),Ni=F('<!> <div class="image-container svelte-17agwu4"><!></div> <!> <!>',1),Yi=F('<div class="ai-tab svelte-17agwu4"><!></div>');function Xi(i,t){Be(t,!1);const e=()=>ot(tt,"$aiState",r),n=()=>ot(yi,"$hasAiImage",r),o=()=>ot(ya,"$activeAiMenu",r),[r,d]=Rt();let c=U(50);function s(M){z(c,M),tt.setComparisonPosition(M)}const v=[{id:"upscale",label:"Upscale"},{id:"background",label:"Remove background"}];function b(M){tt.setImage(M)}function k(M){ya.set(M)}async function S(){e().currentImage&&await $t(e().currentImage)}function x(){e().currentImage&&ea(e().currentImage,"picflam-ai.png")}Le();var y=Yi(),R=f(y);{var l=M=>{Ta(M,{title:"Upscale and remove backgrounds using AI power",hint:"Import, drag or paste an image",onImageImport:b})},w=M=>{var E=Ni(),L=Xe(E);la(L,{canUndo:!1,canRedo:!1,onUndo:()=>{},onRedo:()=>{},onStartAgain:()=>tt.reset(),onCopy:S,onExport:x});var D=u(L,2),I=f(D);{var C=le=>{xi(le,{get beforeImage(){return e().originalImage},get afterImage(){return e().processedImage},get position(){return a(c)},onChange:s})},P=le=>{var ee=ji();K(()=>ke(ee,"src",e().currentImage)),A(le,ee)};te(I,le=>{e().showComparison&&e().processedImage?le(C):le(P,!1)})}g(D);var j=u(D,2);sa(j,{get tabs(){return v},get activeTab(){return o()},onTabChange:k});var G=u(j,2);{var ae=le=>{Li(le,{})},ge=le=>{var ee=gt(),he=Xe(ee);{var O=H=>{Wi(H,{})};te(he,H=>{o()==="background"&&H(O)},!0)}A(le,ee)};te(G,le=>{o()==="upscale"?le(ae):le(ge,!1)})}A(M,E)};te(R,M=>{n()?M(w,!1):M(l)})}g(y),A(i,y),Ee(),d()}var Gi=F('<div class="size-controls svelte-1l8e210"><!></div>');function Qi(i,t){Be(t,!1);let e=h(t,"canvasSize",8,"1/1"),n=h(t,"onSizeChange",8,s=>{});const o=[{id:"9/16",label:"9:16",icon:"icon-vertical"},{id:"1/1",label:"1:1",icon:"icon-square"},{id:"16/9",label:"16:9",icon:"icon-horizontal"}];function r(s){n()(s)}Le();var d=Gi(),c=f(d);Aa(c,{get options(){return o},get value(){return e()},onChange:r,showLabels:!0,centered:!0}),g(d),A(i,d),Ee()}var Vi=F("<button></button>"),Ji=F('<div class="color-picker-popover svelte-x97jji"><input type="color" class="svelte-x97jji"/></div>'),Zi=F('<button aria-label="Custom color"></button> <!>',1),Ki=F('<div class="color-swatches svelte-x97jji"><!> <!></div>');function zt(i,t){Be(t,!1);let e=h(t,"colors",24,()=>[]),n=h(t,"value",8,""),o=h(t,"onChange",8,S=>{}),r=h(t,"showRainbow",8,!0),d=U(!1),c=U("#5422b0");Le();var s=Ki(),v=f(s);vt(v,1,e,dt,(S,x)=>{var y=Vi();let R;K(()=>{R=de(y,1,"swatch svelte-x97jji",null,R,{active:n()===a(x),white:a(x)==="#FFFFFF"}),ye(y,`background-color: ${a(x)??""};`),ke(y,"aria-label",`Select color ${a(x)??""}`)}),p("click",y,()=>o()(a(x))),A(S,y)});var b=u(v,2);{var k=S=>{var x=Zi(),y=Xe(x);let R;var l=u(y,2);{var w=M=>{var E=Ji(),L=f(E);Ft(L),g(E),kn(L,()=>a(c),D=>z(c,D)),p("change",L,()=>o()(a(c))),A(M,E)};te(l,M=>{a(d)&&M(w)})}K(M=>R=de(y,1,"swatch rainbow svelte-x97jji",null,R,M),[()=>({active:!e().includes(n())&&n()!=="transparent"})]),p("click",y,()=>z(d,!a(d))),A(S,x)};te(b,S=>{r()&&S(k)})}g(s),A(i,s),Ee()}const It={solids:["#FFFFFF","#000000","#007C1F","#00679D","#B20715"],gradients:["linear-gradient(135deg, #5422b0 0%, #4B0082 100%)","linear-gradient(135deg, #15509B 0%, #20244F 100%)","linear-gradient(135deg, #A8076B 0%, #62045F 100%)","linear-gradient(135deg, #EA5C56 0%, #3C0C40 100%)","linear-gradient(135deg, #0A8F9D 0%, #202B54 100%)","linear-gradient(135deg, #D17A29 0%, #41363C 100%)"]},qa=["Inter","Roboto Slab","Saira Condensed","Lora","Playfair Display","Special Elite"],Mt={up:"to top",down:"to bottom",left:"to left",right:"to right"},$i={canvasSize:"1/1",background:{type:"solid",value:"#FFFFFF",direction:"down",gradientColors:["#5422b0","#4B0082"]},text1:"",text1Font:"Inter",text1Size:5,text1YPosition:3,text1LineSpacing:5,text1Color:"#000000",text1HighlightColor:"transparent",text1IsBold:!0,text1Align:"center",text1QuoteStyle:"none",text1QuoteSize:5,text2:"",text2Font:"Inter",text2Size:3,text2YPosition:8,text2LineSpacing:5,text2Color:"#000000",text2LabelColor:"transparent",text2IsBold:!1,text2Align:"center",overlay:null,overlaySize:50,overlayOpacity:100,overlayX:50,overlayY:50,overlayMask:"none",overlayLayer:"above",overlayBorderWidth:0,overlayBorderColor:"#FFFFFF",overlayNaturalWidth:0,overlayNaturalHeight:0};function eo(i){const t=[JSON.parse(JSON.stringify(i))];let e=0;const{subscribe:n,set:o,update:r}=bt(i);return{subscribe:n,set:d=>{t.splice(e+1),t.push(JSON.parse(JSON.stringify(d))),e=t.length-1,o(d)},update:d=>{r(c=>{const s=d(c);return t.splice(e+1),t.push(JSON.parse(JSON.stringify(s))),e=t.length-1,s})},undo:()=>e>0?(e--,o(JSON.parse(JSON.stringify(t[e]))),!0):!1,redo:()=>e<t.length-1?(e++,o(JSON.parse(JSON.stringify(t[e]))),!0):!1,canUndo:()=>e>0,canRedo:()=>e<t.length-1,reset:()=>{const d=JSON.parse(JSON.stringify(i));t.length=0,t.push(d),e=0,o(d)}}}const Qe=eo($i),aa=bt(!0),ct=bt("none");ia(Qe,i=>i.text1||i.text2||i.overlay||i.background.value!=="#FFFFFF");function to(){Qe.reset(),aa.set(!0),ct.set("none")}var ao=F('<button aria-label="Select gradient"></button>'),no=F('<div class="background-controls svelte-18tfgkp"><div class="section svelte-18tfgkp"><div class="color-row svelte-18tfgkp"><!></div></div> <div class="section svelte-18tfgkp"><div class="gradient-row svelte-18tfgkp"></div></div> <div class="section svelte-18tfgkp"><div class="gradient-preview-row svelte-18tfgkp"><button class="gradient-endpoint svelte-18tfgkp" aria-label="Edit start color"></button> <div class="gradient-preview svelte-18tfgkp"></div> <button class="gradient-endpoint svelte-18tfgkp" aria-label="Edit end color"></button></div></div> <div class="section svelte-18tfgkp"><div><button aria-label="Gradient direction up"><img src="/icons/icon-nudge-up.svg" alt="" class="direction-icon svelte-18tfgkp"/></button> <button aria-label="Gradient direction down"><img src="/icons/icon-nudge-down.svg" alt="" class="direction-icon svelte-18tfgkp"/></button> <button aria-label="Gradient direction left"><img src="/icons/icon-nudge-left.svg" alt="" class="direction-icon svelte-18tfgkp"/></button> <button aria-label="Gradient direction right"><img src="/icons/icon-nudge-right.svg" alt="" class="direction-icon svelte-18tfgkp"/></button></div></div></div>');function io(i,t){Be(t,!1);const e=U();let n=h(t,"background",24,()=>({type:"solid",value:"#FFFFFF",direction:"down",gradientColors:["#5422b0","#4B0082"]})),o=h(t,"onBackgroundChange",8,O=>{});const r=It.gradients.map(O=>{const H=O.match(/#[A-Fa-f0-9]{6}/g);return H?[H[0],H[1]]:["#5422b0","#4B0082"]});function d(O){o()({...n(),type:"solid",value:O})}function c(O){const H=r[O],ie=Mt[n().direction]||"to bottom";o()({...n(),type:"gradient",value:`linear-gradient(${ie}, ${H[0]} 0%, ${H[1]} 100%)`,gradientColors:H})}function s(O){const H=Mt[O],ie=n().gradientColors||["#5422b0","#4B0082"];o()({...n(),direction:O,value:`linear-gradient(${H}, ${ie[0]} 0%, ${ie[1]} 100%)`})}function v(O,H){const ie=[...n().gradientColors||["#5422b0","#4B0082"]];ie[O]=H;const ve=Mt[n().direction]||"to bottom";o()({...n(),type:"gradient",value:`linear-gradient(${ve}, ${ie[0]} 0%, ${ie[1]} 100%)`,gradientColors:ie})}Ye(()=>(Re(n()),Mt),()=>{z(e,n().type==="gradient"?`linear-gradient(${Mt[n().direction]||"to bottom"}, ${n().gradientColors?.[0]||"#5422b0"} 0%, ${n().gradientColors?.[1]||"#4B0082"} 100%)`:`linear-gradient(to bottom, ${r[0][0]} 0%, ${r[0][1]} 100%)`)}),pt(),Le();var b=no(),k=f(b),S=f(k),x=f(S);{let O=Ve(()=>(Re(n()),m(()=>n().type==="solid"?n().value:"")));zt(x,{get colors(){return Re(It),m(()=>It.solids)},get value(){return a(O)},onChange:d,showRainbow:!0})}g(S),g(k);var y=u(k,2),R=f(y);vt(R,5,()=>r,dt,(O,H,ie)=>{var ve=ao();let Se;K(()=>{Se=de(ve,1,"gradient-swatch svelte-18tfgkp",null,Se,{active:n().type==="gradient"&&n().gradientColors?.[0]===a(H)[0]&&n().gradientColors?.[1]===a(H)[1]}),ye(ve,`background: linear-gradient(135deg, ${a(H),m(()=>a(H)[0])??""} 0%, ${a(H),m(()=>a(H)[1])??""} 100%);`)}),p("click",ve,()=>c(ie)),A(O,ve)}),g(R),g(y);var l=u(y,2),w=f(l),M=f(w),E=u(M,2),L=u(E,2);g(w),g(l);var D=u(l,2),I=f(D);let C;var P=f(I);let j;var G=u(P,2);let ae;var ge=u(G,2);let le;var ee=u(ge,2);let he;g(I),g(D),g(b),K(()=>{ye(M,`background-color: ${Re(n()),m(()=>n().gradientColors?.[0]||"#5422b0")??""};`),ye(E,`background: ${a(e)??""};`),ye(L,`background-color: ${Re(n()),m(()=>n().gradientColors?.[1]||"#4B0082")??""};`),C=de(I,1,"direction-row svelte-18tfgkp",null,C,{inactive:n().type!=="gradient"}),j=de(P,1,"direction-btn svelte-18tfgkp",null,j,{active:n().direction==="up"}),ae=de(G,1,"direction-btn svelte-18tfgkp",null,ae,{active:n().direction==="down"}),le=de(ge,1,"direction-btn svelte-18tfgkp",null,le,{active:n().direction==="left"}),he=de(ee,1,"direction-btn svelte-18tfgkp",null,he,{active:n().direction==="right"})}),p("click",M,()=>{const O=document.createElement("input");O.type="color",O.value=n().gradientColors?.[0]||"#5422b0",O.addEventListener("input",H=>v(0,H.target.value)),O.click()}),p("click",L,()=>{const O=document.createElement("input");O.type="color",O.value=n().gradientColors?.[1]||"#4B0082",O.addEventListener("input",H=>v(1,H.target.value)),O.click()}),p("click",P,()=>s("up")),p("click",G,()=>s("down")),p("click",ge,()=>s("left")),p("click",ee,()=>s("right")),A(i,b),Ee()}var oo=F("<button> </button>"),ro=F('<div class="font-dropdown-menu svelte-fspusj"></div>'),lo=F('<div class="text1-controls svelte-fspusj"><div class="text-input-container svelte-fspusj"><textarea class="text-input svelte-fspusj" placeholder="How to ==highlight== text"></textarea> <div class="resize-handle svelte-fspusj"></div></div> <div class="font-row svelte-fspusj"><span class="row-label svelte-fspusj">Font</span> <div class="font-dropdown-wrapper svelte-fspusj"><button class="font-dropdown-trigger svelte-fspusj"> <span class="dropdown-arrow svelte-fspusj">â¾</span></button> <!></div> <button aria-label="Bold"><img src="/icons/icon-bold.svg" alt="" class="btn-icon svelte-fspusj"/></button> <button class="icon-btn svelte-fspusj"><img alt="" class="btn-icon svelte-fspusj"/></button></div> <div class="slider-row svelte-fspusj"><!> <button class="reset-btn svelte-fspusj" aria-label="Reset size"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-fspusj"/></button></div> <div class="slider-row svelte-fspusj"><!> <button class="reset-btn svelte-fspusj" aria-label="Reset position"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-fspusj"/></button></div> <div class="slider-row svelte-fspusj"><!> <button class="reset-btn svelte-fspusj" aria-label="Reset line spacing"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-fspusj"/></button></div> <div class="color-section svelte-fspusj"><span class="section-label svelte-fspusj">Text colour</span> <!></div> <div class="color-section svelte-fspusj"><span class="section-label svelte-fspusj">Highlight colour</span> <!></div></div>');function so(i,t){Be(t,!1);let e=h(t,"text1",8,""),n=h(t,"text1Font",8,"Inter"),o=h(t,"text1Size",8,5),r=h(t,"text1YPosition",8,3),d=h(t,"text1LineSpacing",8,5),c=h(t,"text1Color",8,"#000000"),s=h(t,"text1HighlightColor",8,"transparent"),v=h(t,"text1IsBold",8,!0),b=h(t,"text1Align",8,"center"),k=h(t,"onChange",8,(q,Fe)=>{});const S=It.solids,x=["#FFD700","#000000","#007C1F","#00679D","#B20715"],y=["left","center","right"],R={text1Size:5,text1YPosition:3,text1LineSpacing:5};let l=U(!1),w=U();function M(q){a(w)&&!a(w).contains(q.target)&&z(l,!1)}Bt(()=>{document.addEventListener("click",M)}),oa(()=>{document.removeEventListener("click",M)});function E(q){k()("text1",q.target.value)}function L(q){k()("text1Font",q),z(l,!1)}function D(){k()("text1IsBold",!v())}function I(){const Fe=(y.indexOf(b())+1)%y.length;k()("text1Align",y[Fe])}function C(q){k()("text1Color",q)}function P(q){k()("text1HighlightColor",q===s()?"transparent":q)}function j(q){k()(q,R[q])}Le();var G=lo(),ae=f(G),ge=f(ae);La(ge),yt(2),g(ae);var le=u(ae,2),ee=u(f(le),2),he=f(ee),O=f(he);yt(),g(he);var H=u(he,2);{var ie=q=>{var Fe=ro();vt(Fe,5,()=>qa,dt,(it,Oe)=>{var Me=oo();let oe;var me=f(Me,!0);g(Me),K(()=>{oe=de(Me,1,"font-option svelte-fspusj",null,oe,{selected:n()===a(Oe)}),ye(Me,`font-family: '${a(Oe)??""}'`),He(me,a(Oe)==="Inter"?"Inter (Default)":a(Oe))}),p("click",Me,()=>L(a(Oe))),A(it,Me)}),g(Fe),A(q,Fe)};te(H,q=>{a(l)&&q(ie)})}g(ee),ht(ee,q=>z(w,q),()=>a(w));var ve=u(ee,2);let Se;var we=u(ve,2),Ze=f(we);g(we),g(le);var Te=u(le,2),Ue=f(Te);Je(Ue,{label:"Size",min:1,max:10,get value(){return o()},onChange:q=>k()("text1Size",q)});var N=u(Ue,2);g(Te);var Y=u(Te,2),Z=f(Y);Je(Z,{label:"Position",min:0,max:10,get value(){return r()},onChange:q=>k()("text1YPosition",q)});var fe=u(Z,2);g(Y);var pe=u(Y,2),qe=f(pe);Je(qe,{label:"Line spacing",min:1,max:10,get value(){return d()},onChange:q=>k()("text1LineSpacing",q)});var Pe=u(qe,2);g(pe);var Ae=u(pe,2),We=u(f(Ae),2);zt(We,{get colors(){return S},get value(){return c()},onChange:C,showRainbow:!0}),g(Ae);var ue=u(Ae,2),je=u(f(ue),2);zt(je,{get colors(){return x},get value(){return s()},onChange:P,showRainbow:!0}),g(ue),g(G),K(()=>{qt(ge,e()),ye(he,`font-family: '${n()??""}'`),He(O,`${(n()==="Inter"?"Inter (Default)":n())??""} `),Se=de(ve,1,"icon-btn svelte-fspusj",null,Se,{active:v()}),ke(we,"aria-label",`Align ${b()??""}`),ke(Ze,"src",`/icons/icon-align-${b()??""}.svg`)}),p("input",ge,E),p("click",he,()=>z(l,!a(l))),p("click",ve,D),p("click",we,I),p("click",N,()=>j("text1Size")),p("click",fe,()=>j("text1YPosition")),p("click",Pe,()=>j("text1LineSpacing")),A(i,G),Ee()}var co=F("<button> </button>"),vo=F('<div class="font-dropdown-menu svelte-n6z268"></div>'),uo=F('<div class="text2-controls svelte-n6z268"><div class="text-input-container svelte-n6z268"><textarea class="text-input svelte-n6z268" placeholder="How to ==highlight== text"></textarea> <div class="resize-handle svelte-n6z268"></div></div> <div class="font-row svelte-n6z268"><span class="row-label svelte-n6z268">Font</span> <div class="font-dropdown-wrapper svelte-n6z268"><button class="font-dropdown-trigger svelte-n6z268"> <span class="dropdown-arrow svelte-n6z268">â¾</span></button> <!></div> <button aria-label="Bold"><img src="/icons/icon-bold.svg" alt="" class="btn-icon svelte-n6z268"/></button> <button class="icon-btn svelte-n6z268"><img alt="" class="btn-icon svelte-n6z268"/></button></div> <div class="slider-row svelte-n6z268"><!> <button class="reset-btn svelte-n6z268" aria-label="Reset size"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-n6z268"/></button></div> <div class="slider-row svelte-n6z268"><!> <button class="reset-btn svelte-n6z268" aria-label="Reset position"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-n6z268"/></button></div> <div class="slider-row svelte-n6z268"><!> <button class="reset-btn svelte-n6z268" aria-label="Reset line spacing"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-n6z268"/></button></div> <div class="color-section svelte-n6z268"><span class="section-label svelte-n6z268">Text colour</span> <!></div> <div class="color-section svelte-n6z268"><span class="section-label svelte-n6z268">Highlight colour</span> <!></div></div>');function go(i,t){Be(t,!1);let e=h(t,"text2",8,""),n=h(t,"text2Font",8,"Inter"),o=h(t,"text2Size",8,3),r=h(t,"text2YPosition",8,8),d=h(t,"text2LineSpacing",8,5),c=h(t,"text2Color",8,"#000000"),s=h(t,"text2LabelColor",8,"transparent"),v=h(t,"text2IsBold",8,!1),b=h(t,"text2Align",8,"center"),k=h(t,"onChange",8,(q,Fe)=>{});const S=It.solids,x=["#FFD700","#000000","#007C1F","#00679D","#B20715"],y=["left","center","right"],R={text2Size:3,text2YPosition:8,text2LineSpacing:5};let l=U(!1),w=U();function M(q){a(w)&&!a(w).contains(q.target)&&z(l,!1)}Bt(()=>{document.addEventListener("click",M)}),oa(()=>{document.removeEventListener("click",M)});function E(q){k()("text2",q.target.value)}function L(q){k()("text2Font",q),z(l,!1)}function D(){k()("text2IsBold",!v())}function I(){const Fe=(y.indexOf(b())+1)%y.length;k()("text2Align",y[Fe])}function C(q){k()("text2Color",q)}function P(q){k()("text2LabelColor",q===s()?"transparent":q)}function j(q){k()(q,R[q])}Le();var G=uo(),ae=f(G),ge=f(ae);La(ge),yt(2),g(ae);var le=u(ae,2),ee=u(f(le),2),he=f(ee),O=f(he);yt(),g(he);var H=u(he,2);{var ie=q=>{var Fe=vo();vt(Fe,5,()=>qa,dt,(it,Oe)=>{var Me=co();let oe;var me=f(Me,!0);g(Me),K(()=>{oe=de(Me,1,"font-option svelte-n6z268",null,oe,{selected:n()===a(Oe)}),ye(Me,`font-family: '${a(Oe)??""}'`),He(me,a(Oe)==="Inter"?"Inter (Default)":a(Oe))}),p("click",Me,()=>L(a(Oe))),A(it,Me)}),g(Fe),A(q,Fe)};te(H,q=>{a(l)&&q(ie)})}g(ee),ht(ee,q=>z(w,q),()=>a(w));var ve=u(ee,2);let Se;var we=u(ve,2),Ze=f(we);g(we),g(le);var Te=u(le,2),Ue=f(Te);Je(Ue,{label:"Size",min:1,max:10,get value(){return o()},onChange:q=>k()("text2Size",q)});var N=u(Ue,2);g(Te);var Y=u(Te,2),Z=f(Y);Je(Z,{label:"Position",min:0,max:10,get value(){return r()},onChange:q=>k()("text2YPosition",q)});var fe=u(Z,2);g(Y);var pe=u(Y,2),qe=f(pe);Je(qe,{label:"Line spacing",min:1,max:10,get value(){return d()},onChange:q=>k()("text2LineSpacing",q)});var Pe=u(qe,2);g(pe);var Ae=u(pe,2),We=u(f(Ae),2);zt(We,{get colors(){return S},get value(){return c()},onChange:C,showRainbow:!0}),g(Ae);var ue=u(Ae,2),je=u(f(ue),2);zt(je,{get colors(){return x},get value(){return s()},onChange:P,showRainbow:!0}),g(ue),g(G),K(()=>{qt(ge,e()),ye(he,`font-family: '${n()??""}'`),He(O,`${(n()==="Inter"?"Inter (Default)":n())??""} `),Se=de(ve,1,"icon-btn svelte-n6z268",null,Se,{active:v()}),ke(we,"aria-label",`Align ${b()??""}`),ke(Ze,"src",`/icons/icon-align-${b()??""}.svg`)}),p("input",ge,E),p("click",he,()=>z(l,!a(l))),p("click",ve,D),p("click",we,I),p("click",N,()=>j("text2Size")),p("click",fe,()=>j("text2YPosition")),p("click",Pe,()=>j("text2LineSpacing")),A(i,G),Ee()}var ho=F('<button><img alt="" class="style-icon svelte-4vqdnp"/></button>'),fo=F('<div class="quote-controls svelte-4vqdnp"><div class="style-row svelte-4vqdnp"></div> <div><!> <button class="reset-btn svelte-4vqdnp" aria-label="Reset size"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-4vqdnp"/></button></div></div>');function bo(i,t){Be(t,!1);let e=h(t,"quoteStyle",8,"none"),n=h(t,"quoteSize",8,5),o=h(t,"onChange",8,(R,l)=>{});const r=[{id:"none",icon:"/icons/icon-none.svg",label:"No quote"},{id:"serif",icon:"/icons/icon-quote-serif.svg",label:"Serif quote"},{id:"slab",icon:"/icons/icon-quote-slab.svg",label:"Slab quote"}],d={quoteSize:5};function c(R){o()("text1QuoteStyle",R)}function s(R){o()("text1QuoteSize",d[R])}Le();var v=fo(),b=f(v);vt(b,5,()=>r,dt,(R,l)=>{var w=ho();let M;var E=f(w);g(w),K(()=>{M=de(w,1,"style-btn svelte-4vqdnp",null,M,{active:e()===a(l).id,"is-none":a(l).id==="none"}),ke(w,"aria-label",(a(l),m(()=>a(l).label))),ke(E,"src",(a(l),m(()=>a(l).icon)))}),p("click",w,()=>c(a(l).id)),A(R,w)}),g(b);var k=u(b,2);let S;var x=f(k);Je(x,{label:"Size",min:1,max:10,get value(){return n()},onChange:R=>e()!=="none"&&o()("text1QuoteSize",R)});var y=u(x,2);g(k),g(v),K(()=>{S=de(k,1,"slider-row svelte-4vqdnp",null,S,{disabled:e()==="none"}),y.disabled=e()==="none"}),p("click",y,()=>s("quoteSize")),A(i,v),Ee()}var mo=F('<div class="import-box svelte-qirtgp" role="button" tabindex="0"><label class="import-area svelte-qirtgp"><input type="file" accept="image/*" class="file-input svelte-qirtgp"/> <img src="/icons/icon-upload.svg" alt="" class="upload-icon svelte-qirtgp"/> <span class="import-text svelte-qirtgp">Import, drag or<br/>paste an image</span></label> <button class="paste-btn svelte-qirtgp">Paste</button></div>'),po=F('<div class="slider-row svelte-qirtgp"><!></div> <div class="slider-row svelte-qirtgp"><!></div> <div class="mask-row svelte-qirtgp"><span class="row-label svelte-qirtgp">Mask</span> <div class="mask-buttons svelte-qirtgp"><button aria-label="No mask"><img src="/icons/icon-none.svg" alt="" class="mask-icon svelte-qirtgp"/></button> <button aria-label="Rounded mask"><img src="/icons/icon-square.svg" alt="" class="mask-icon svelte-qirtgp"/></button> <button aria-label="Circle mask"><div class="circle-icon svelte-qirtgp"></div></button></div> <span class="row-label layer-label svelte-qirtgp">Layers</span> <div class="layer-buttons svelte-qirtgp"><button aria-label="Overlay above text"><img src="/icons/icon-layer-above.svg" alt="" class="layer-icon svelte-qirtgp"/></button> <button aria-label="Overlay below text"><img src="/icons/icon-layer-below.svg" alt="" class="layer-icon svelte-qirtgp"/></button></div></div> <div class="slider-row svelte-qirtgp"><!></div> <div class="color-section svelte-qirtgp"><span class="section-label svelte-qirtgp">Border colour</span> <!></div>',1),wo=F('<div class="overlay-controls svelte-qirtgp"><!></div>');function xo(i,t){Be(t,!1);let e=h(t,"overlay",8,null),n=h(t,"overlaySize",8,50),o=h(t,"overlayOpacity",8,100),r=h(t,"overlayMask",8,"none"),d=h(t,"overlayLayer",8,"above"),c=h(t,"overlayBorderWidth",8,0),s=h(t,"overlayBorderColor",8,"#FFFFFF"),v=h(t,"onChange",8,(D,I)=>{});const b=It.solids,k=[0,1,2,3];function S(D){const I=D.target.files?.[0];if(I&&I.type.startsWith("image/")){const C=new FileReader;C.onload=P=>{v()("overlay",P.target.result)},C.readAsDataURL(I)}D.target.value=""}function x(D){D.preventDefault();const I=D.dataTransfer?.files?.[0];if(I&&I.type.startsWith("image/")){const C=new FileReader;C.onload=P=>{v()("overlay",P.target.result)},C.readAsDataURL(I)}}function y(D){D.preventDefault()}async function R(){try{const D=await navigator.clipboard.read();for(const I of D){const C=I.types.find(P=>P.startsWith("image/"));if(C){const P=await I.getType(C),j=new FileReader;j.onload=G=>{v()("overlay",G.target.result)},j.readAsDataURL(P);return}}}catch(D){console.error("Paste failed:",D)}}function l(D){const I=k.reduce((C,P)=>Math.abs(P-D)<Math.abs(C-D)?P:C);v()("overlayBorderWidth",I)}Le();var w=wo(),M=f(w);{var E=D=>{var I=mo(),C=f(I),P=f(C);yt(4),g(C);var j=u(C,2);g(I),p("change",P,S),p("click",j,R),p("drop",I,x),p("dragover",I,y),A(D,I)},L=D=>{var I=po(),C=Xe(I),P=f(C);Je(P,{label:"Size",min:10,max:100,get value(){return n()},onChange:fe=>v()("overlaySize",fe)}),g(C);var j=u(C,2),G=f(j);Je(G,{label:"Opacity",min:0,max:100,get value(){return o()},onChange:fe=>v()("overlayOpacity",fe)}),g(j);var ae=u(j,2),ge=u(f(ae),2),le=f(ge);let ee;var he=u(le,2);let O;var H=u(he,2);let ie;g(ge);var ve=u(ge,4),Se=f(ve);let we;var Ze=u(Se,2);let Te;g(ve),g(ae);var Ue=u(ae,2),N=f(Ue);Je(N,{label:"Border width",min:0,max:3,step:1,get value(){return c()},onChange:l}),g(Ue);var Y=u(Ue,2),Z=u(f(Y),2);zt(Z,{get colors(){return b},get value(){return s()},onChange:fe=>v()("overlayBorderColor",fe),showRainbow:!0}),g(Y),K(()=>{ee=de(le,1,"mask-btn svelte-qirtgp",null,ee,{active:r()==="none"}),O=de(he,1,"mask-btn svelte-qirtgp",null,O,{active:r()==="rounded"}),ie=de(H,1,"mask-btn svelte-qirtgp",null,ie,{active:r()==="circle"}),we=de(Se,1,"layer-btn svelte-qirtgp",null,we,{active:d()==="above"}),Te=de(Ze,1,"layer-btn svelte-qirtgp",null,Te,{active:d()==="below"})}),p("click",le,()=>v()("overlayMask","none")),p("click",he,()=>v()("overlayMask","rounded")),p("click",H,()=>v()("overlayMask","circle")),p("click",Se,()=>v()("overlayLayer","above")),p("click",Ze,()=>v()("overlayLayer","below")),A(D,I)};te(M,D=>{e()?D(L,!1):D(E)})}g(w),A(i,w),Ee()}var _o=F('<button class="template-card svelte-fxk5n4"><div class="template-placeholder svelte-fxk5n4"> </div></button>'),yo=F('<div class="template-picker svelte-fxk5n4"><p class="picker-title svelte-fxk5n4">Create quotes and cards. Start with a template or blank canvas</p> <button class="blank-canvas-btn svelte-fxk5n4"><img src="/icons/icon-add.svg" alt="" class="add-icon svelte-fxk5n4"/></button> <div class="template-grid svelte-fxk5n4"></div></div>'),ko=F('<div class="canvas-quote svelte-fxk5n4">&#8220;</div>'),Co=F('<!> <div class="text1-wrapper svelte-fxk5n4"><div class="canvas-text text1 svelte-fxk5n4"><!></div></div>',1),So=F('<div class="canvas-text text2 svelte-fxk5n4"><!></div>'),Io=F('<div role="button" tabindex="0"><div><button class="delete-btn svelte-fxk5n4" aria-label="Delete overlay"><img src="/icons/icon-close.svg" alt="" class="delete-icon svelte-fxk5n4"/></button> <div><img alt="Overlay" class="overlay-image svelte-fxk5n4" draggable="false"/></div></div></div>'),zo=F('<!> <div class="canvas-container svelte-fxk5n4"><div class="design-canvas svelte-fxk5n4" role="button" tabindex="0"><!> <!> <!></div></div> <!> <div class="controls-panel svelte-fxk5n4"><!></div>',1),Ro=F('<div class="design-tab svelte-fxk5n4"><!></div>');function Bo(i,t){Be(t,!1);const e=()=>ot(Qe,"$slideState",r),n=()=>ot(ct,"$activeDesignMenu",r),o=()=>ot(aa,"$showTemplatePicker",r),[r,d]=Rt(),c=U();let s=U(),v=U(300),b=300,k=U(300),S,x=U(),y=U(0),R=!1,l=0,w=0,M=0,E=0;Bt(()=>{a(s)&&(S=new ResizeObserver(([N])=>{const{width:Y,height:Z}=N.contentRect;b=Y,z(k,Z),z(v,Math.min(Y,Z))}),S.observe(a(s)))}),oa(()=>{S&&S.disconnect()});const L=[{id:"size",label:"Size"},{id:"background",label:"Background"},{id:"text1",label:"Text 1"},{id:"text2",label:"Text 2"},{id:"quote",label:"Quote"},{id:"overlay",label:"Overlay"}];function D(N){N==="blank"&&Qe.reset(),aa.set(!1)}function I(N){ct.set(n()===N?"none":N)}async function C(){}function P(){}function j(N){Qe.update(Y=>({...Y,canvasSize:N}))}function G(N){Qe.update(Y=>({...Y,background:N}))}function ae(N,Y){Qe.update(Z=>({...Z,[N]:Y}))}function ge(N,Y){Qe.update(Z=>({...Z,[N]:Y}))}function le(N,Y){Qe.update(Z=>({...Z,[N]:Y}))}function ee(N,Y){if(N==="overlay"&&Y){const Z=new Image;Z.onload=()=>{Qe.update(fe=>({...fe,overlay:Y,overlayNaturalWidth:Z.naturalWidth,overlayNaturalHeight:Z.naturalHeight,overlayX:50,overlayY:50})),ct.set("overlay")},Z.src=Y}else N==="overlayLayer"?(Qe.update(Z=>({...Z,[N]:Y})),ct.set("none")):Qe.update(Z=>({...Z,[N]:Y}))}function he(){Qe.update(N=>({...N,overlay:null,overlayNaturalWidth:0,overlayNaturalHeight:0})),ct.set("none")}function O(N){if(N.target.closest(".delete-btn"))return;N.preventDefault(),R=!0;const Y=N.touches?.[0]||N;l=Y.clientX,w=Y.clientY,M=e().overlayX,E=e().overlayY,window.addEventListener("mousemove",H),window.addEventListener("mouseup",ie),window.addEventListener("touchmove",H,{passive:!1}),window.addEventListener("touchend",ie)}function H(N){if(!R)return;N.preventDefault();const Y=N.touches?.[0]||N,Z=Y.clientX-l,fe=Y.clientY-w,pe=Z/b*100,qe=fe/a(k)*100,Pe=Math.max(0,Math.min(100,M+pe)),Ae=Math.max(0,Math.min(100,E+qe));Qe.update(We=>({...We,overlayX:Pe,overlayY:Ae}))}function ie(){R=!1,window.removeEventListener("mousemove",H),window.removeEventListener("mouseup",ie),window.removeEventListener("touchmove",H),window.removeEventListener("touchend",ie)}function ve(N){const Y=N.target;Y.closest(".overlay-wrapper")?ct.set("overlay"):Y.closest(".text1-wrapper")?ct.set("text1"):Y.closest(".canvas-text.text2")?ct.set("text2"):Y.closest(".canvas-quote")?ct.set("quote"):ct.set("none")}function Se(N){if(!N.overlay||!N.overlayNaturalWidth)return null;const Y=N.overlayNaturalWidth/N.overlayNaturalHeight,Z=N.overlaySize/100*100;let fe,pe;return Y>=1?(fe=Z,pe=Z/Y):(pe=Z,fe=Z*Y),{width:fe,height:pe}}Ye(()=>(a(x),e()),()=>{a(x)&&e().text1&&setTimeout(()=>{z(y,a(x).offsetHeight||0)},0)}),Ye(()=>e(),()=>{z(c,Se(e()))}),pt(),Le();var we=Ro(),Ze=f(we);{var Te=N=>{var Y=yo(),Z=u(f(Y),2),fe=u(Z,2);vt(fe,4,()=>[1,2,3,4,5,6],dt,(pe,qe)=>{var Pe=_o(),Ae=f(Pe),We=f(Ae);g(Ae),g(Pe),K(()=>He(We,`Template ${qe??""}`)),p("click",Pe,()=>D(`template-${qe}`)),A(pe,Pe)}),g(fe),g(Y),p("click",Z,()=>D("blank")),A(N,Y)},Ue=N=>{var Y=zo(),Z=Xe(Y);{let oe=Ve(()=>(Re(Qe),m(()=>Qe.canUndo()))),me=Ve(()=>(Re(Qe),m(()=>Qe.canRedo())));la(Z,{get canUndo(){return a(oe)},get canRedo(){return a(me)},onUndo:()=>Qe.undo(),onRedo:()=>Qe.redo(),get onStartAgain(){return to},onCopy:C,onExport:P})}var fe=u(Z,2),pe=f(fe),qe=f(pe);{var Pe=oe=>{const me=Ve(()=>(a(v),e(),m(()=>a(v)*.1*e().text1Size/5))),Ge=Ve(()=>(Re(a(me)),e(),m(()=>a(me)*(1+e().text1LineSpacing*.1)))),Ne=Ve(()=>(Re(a(Ge)),e(),m(()=>a(Ge)*(e().text1QuoteStyle==="slab"?.35:.4)))),B=Ve(()=>(e(),m(()=>e().text1YPosition*10))),J=Ve(()=>a(y)/a(k)*100),re=Ve(()=>a(B)-a(J)/2-a(Ne)/a(k)*100);var X=Co(),ce=Xe(X);{var Ie=W=>{var ne=ko();K(()=>ye(ne,`
								top: ${a(re)??""}%;
								font-family: ${e(),m(()=>e().text1QuoteStyle==="serif"?'"Playfair Display", serif':'"Alfa Slab One", cursive')??""};
								font-size: ${a(v),e(),m(()=>a(v)*.08*e().text1QuoteSize)??""}px;
								font-weight: ${e(),m(()=>e().text1QuoteStyle==="serif"?"bold":"normal")??""};
								color: ${e(),m(()=>e().text1Color)??""};
							`)),A(W,ne)};te(ce,W=>{e(),m(()=>e().text1QuoteStyle!=="none")&&W(Ie)})}var $=u(ce,2),_=f($),T=f(_);fa(T,()=>(e(),m(()=>e().text1.replace(/==(.+?)==/g,`<span style="color: ${e().text1HighlightColor};">$1</span>`).replace(/\n/g,"<br>")))),g(_),g($),ht($,W=>z(x,W),()=>a(x)),K(()=>{ye($,`top: ${a(B)??""}%;`),ye(_,`
								font-family: '${e(),m(()=>e().text1Font)??""}';
								font-size: ${e(),m(()=>e().text1Size*.5)??""}em;
								font-weight: ${e(),m(()=>e().text1IsBold?"bold":"normal")??""};
								color: ${e(),m(()=>e().text1Color)??""};
								text-align: ${e(),m(()=>e().text1Align)??""};
								line-height: ${e(),m(()=>1+e().text1LineSpacing*.1)??""};
							`)}),A(oe,X)};te(qe,oe=>{e(),m(()=>e().text1)&&oe(Pe)})}var Ae=u(qe,2);{var We=oe=>{var me=So(),Ge=f(me);fa(Ge,()=>(e(),m(()=>e().text2.replace(/==(.+?)==/g,`<span style="color: ${e().text2LabelColor};">$1</span>`).replace(/\n/g,"<br>")))),g(me),K(()=>ye(me,`
							font-family: '${e(),m(()=>e().text2Font)??""}';
							font-size: ${e(),m(()=>e().text2Size*.5)??""}em;
							font-weight: ${e(),m(()=>e().text2IsBold?"bold":"normal")??""};
							color: ${e(),m(()=>e().text2Color)??""};
							text-align: ${e(),m(()=>e().text2Align)??""};
							top: ${e(),m(()=>e().text2YPosition*10)??""}%;
							line-height: ${e(),m(()=>1+e().text2LineSpacing*.1)??""};
						`)),A(oe,me)};te(Ae,oe=>{e(),m(()=>e().text2)&&oe(We)})}var ue=u(Ae,2);{var je=oe=>{var me=Io();let Ge;var Ne=f(me);let B;var J=f(Ne),re=u(J,2);let X;var ce=f(re);g(re),g(Ne),g(me),K(()=>{Ge=de(me,1,"overlay-wrapper svelte-fxk5n4",null,Ge,{active:n()==="overlay"}),ye(me,`
							left: ${e(),m(()=>e().overlayX)??""}%;
							top: ${e(),m(()=>e().overlayY)??""}%;
							width: ${a(c),m(()=>a(c).width)??""}%;
							opacity: ${e(),m(()=>e().overlayOpacity/100)??""};
							z-index: ${n(),e(),m(()=>n()==="overlay"?11:e().overlayLayer==="below"?1:10)??""};
						`),B=de(Ne,1,"overlay-bounding-box svelte-fxk5n4",null,B,{"mask-none":e().overlayMask==="none","mask-rounded":e().overlayMask==="rounded","mask-circle":e().overlayMask==="circle"}),ye(Ne,`
								border-width: ${e(),m(()=>e().overlayBorderWidth*2)??""}px;
								border-color: ${e(),m(()=>e().overlayBorderColor)??""};
							`),X=de(re,1,"overlay-image-container svelte-fxk5n4",null,X,{"mask-rounded":e().overlayMask==="rounded","mask-circle":e().overlayMask==="circle"}),ke(ce,"src",(e(),m(()=>e().overlay)))}),p("click",J,he),p("mousedown",me,O),p("touchstart",me,O),A(oe,me)};te(ue,oe=>{e(),a(c),m(()=>e().overlay&&a(c))&&oe(je)})}g(pe),ht(pe,oe=>z(s,oe),()=>a(s)),g(fe);var q=u(fe,2);sa(q,{get tabs(){return L},get activeTab(){return n()},onTabChange:I});var Fe=u(q,2),it=f(Fe);{var Oe=oe=>{xo(oe,{get overlay(){return e(),m(()=>e().overlay)},get overlaySize(){return e(),m(()=>e().overlaySize)},get overlayOpacity(){return e(),m(()=>e().overlayOpacity)},get overlayMask(){return e(),m(()=>e().overlayMask)},get overlayLayer(){return e(),m(()=>e().overlayLayer)},get overlayBorderWidth(){return e(),m(()=>e().overlayBorderWidth)},get overlayBorderColor(){return e(),m(()=>e().overlayBorderColor)},onChange:ee,onDelete:he})},Me=oe=>{var me=gt(),Ge=Xe(me);{var Ne=J=>{Qi(J,{get canvasSize(){return e(),m(()=>e().canvasSize)},onSizeChange:j})},B=J=>{var re=gt(),X=Xe(re);{var ce=$=>{io($,{get background(){return e(),m(()=>e().background)},onBackgroundChange:G})},Ie=$=>{var _=gt(),T=Xe(_);{var W=Q=>{so(Q,{get text1(){return e(),m(()=>e().text1)},get text1Font(){return e(),m(()=>e().text1Font)},get text1Size(){return e(),m(()=>e().text1Size)},get text1YPosition(){return e(),m(()=>e().text1YPosition)},get text1LineSpacing(){return e(),m(()=>e().text1LineSpacing)},get text1Color(){return e(),m(()=>e().text1Color)},get text1HighlightColor(){return e(),m(()=>e().text1HighlightColor)},get text1IsBold(){return e(),m(()=>e().text1IsBold)},get text1Align(){return e(),m(()=>e().text1Align)},onChange:ae})},ne=Q=>{var xe=gt(),Ce=Xe(xe);{var De=_e=>{go(_e,{get text2(){return e(),m(()=>e().text2)},get text2Font(){return e(),m(()=>e().text2Font)},get text2Size(){return e(),m(()=>e().text2Size)},get text2YPosition(){return e(),m(()=>e().text2YPosition)},get text2LineSpacing(){return e(),m(()=>e().text2LineSpacing)},get text2Color(){return e(),m(()=>e().text2Color)},get text2LabelColor(){return e(),m(()=>e().text2LabelColor)},get text2IsBold(){return e(),m(()=>e().text2IsBold)},get text2Align(){return e(),m(()=>e().text2Align)},onChange:ge})},ze=_e=>{var rt=gt(),Ke=Xe(rt);{var wt=et=>{bo(et,{get quoteStyle(){return e(),m(()=>e().text1QuoteStyle)},get quoteSize(){return e(),m(()=>e().text1QuoteSize)},onChange:le})};te(Ke,et=>{n()==="quote"&&et(wt)},!0)}A(_e,rt)};te(Ce,_e=>{n()==="text2"?_e(De):_e(ze,!1)},!0)}A(Q,xe)};te(T,Q=>{n()==="text1"?Q(W):Q(ne,!1)},!0)}A($,_)};te(X,$=>{n()==="background"?$(ce):$(Ie,!1)},!0)}A(J,re)};te(Ge,J=>{n()==="size"?J(Ne):J(B,!1)},!0)}A(oe,me)};te(it,oe=>{n(),e(),m(()=>n()==="overlay"||n()==="none"&&e().overlay)?oe(Oe):oe(Me,!1)})}g(Fe),K(()=>ye(pe,`
					aspect-ratio: ${e(),m(()=>e().canvasSize)??""};
					background: ${e(),m(()=>(e().background.type==="solid",e().background.value))??""};
				`)),p("click",pe,ve),p("keydown",pe,oe=>oe.key==="Enter"&&ve(oe)),A(N,Y)};te(Ze,N=>{o()?N(Te):N(Ue,!1)})}g(we),A(i,we),Ee(),d()}const Qt=bt("crop");var Eo=F('<!> <main class="main svelte-1uha8ag"><!></main> <!>',1);function qo(i,t){Be(t,!1);const e=()=>ot(Qt,"$activeTab",o),n=()=>ot(se,"$cropState",o),[o,r]=Rt();let d=U(!1),c=null;function s(E){if(e()==="crop"&&n().cropPending&&E!=="crop"){c=E,z(d,!0);return}Qt.set(E)}async function v(){z(d,!1);const E=n();if(E.currentImage&&E.cropPending){const L=await Da(E.currentImage,E.cropBox,E.imageWidth,E.imageHeight),D=await Ut(L);se.set({...E,currentImage:L,imageWidth:D.width,imageHeight:D.height,cropBox:{x:0,y:0,width:100,height:100},cropPending:!1,isCropping:!1})}c&&(Qt.set(c),c=null)}function b(){z(d,!1),c=null}Le();var k=Eo(),S=Xe(k);Sn(S,{get activeTab(){return e()},onTabChange:s});var x=u(S,2),y=f(x);{var R=E=>{pi(E,{})},l=E=>{var L=gt(),D=Xe(L);{var I=P=>{Xi(P,{})},C=P=>{var j=gt(),G=Xe(j);{var ae=ge=>{Bo(ge,{})};te(G,ge=>{e()==="design"&&ge(ae)},!0)}A(P,j)};te(D,P=>{e()==="ai"?P(I):P(C,!1)},!0)}A(E,L)};te(y,E=>{e()==="crop"?E(R):E(l,!1)})}g(x);var w=u(x,2);{var M=E=>{ta(E,{message:"Save changes?",confirmText:"Yes",cancelText:"Cancel",onConfirm:v,onCancel:b})};te(w,E=>{a(d)&&E(M)})}A(i,k),Ee(),r()}export{qo as component};
