import{b as ca,d as Oa,f as F,a as L,c as ut}from"../chunks/Dj8On0Xh.js";import"../chunks/Bnc7oL5D.js";import{F as Ut,i as at,x as Mt,C as jt,j as Vt,M as Ua,g as n,aI as st,aA as Ha,O as Wa,a5 as da,aj as Nt,B as St,N as Sa,ao as ja,a2 as va,ax as kt,P as Jt,az as Na,am as na,w as Ia,I as ua,at as N,aO as Ya,aP as Xa,aQ as Ga,aR as gt,ay as za,R as Ra,aS as Yt,ah as Ba,aT as Qa,al as Va,a3 as Ja,aU as Ea,L as Pa,aV as Za,t as K,A as Ka,aW as $a,ap as en,ai as tn,aX as an,aY as nn,aZ as on,a_ as rn,a$ as ln,b0 as sn,av as cn,b as m,J as dn,b1 as vn,p as ze,n as Re,s as u,k as f,l as g,aq as z,b2 as Ne,b3 as mt,e as Le,a4 as _t,m as Ge,b4 as ga,b5 as Ta}from"../chunks/c1y374w_.js";import{p as h,b as ht,i as ee,s as it,a as Rt,_ as un}from"../chunks/DZfZzOi_.js";import{i as Ee}from"../chunks/CBwOI1Gw.js";import{e as p,s as Ue}from"../chunks/8R3vFiuv.js";import{c as gn,o as Bt,d as ia,w as ft,a as oa}from"../chunks/pj8eKBGp.js";function ct(i,a){return a}function hn(i,a,e){for(var t=[],o=a.length,r,d=a.length,s=0;s<o;s++){let C=a[s];Ra(C,()=>{if(r){if(r.pending.delete(C),r.done.add(C),r.pending.size===0){var S=i.outrogroups;Zt(na(r.done)),S.delete(r),S.size===0&&(i.outrogroups=null)}}else d-=1},!1)}if(d===0){var c=t.length===0&&e!==null;if(c){var v=e,b=v.parentNode;Va(b),b.append(v),i.items.clear()}Zt(a,!c)}else r={pending:new Set(a),done:new Set},(i.outrogroups??=new Set).add(r)}function Zt(i,a=!0){for(var e=0;e<i.length;e++)Ja(i[e],a)}var ha;function dt(i,a,e,t,o,r=null){var d=i,s=new Map,c=(a&Ea)!==0;if(c){var v=i;d=at?Ut(Mt(v)):v.appendChild(jt())}at&&Vt();var b=null,C=st(()=>{var w=e();return Ia(w)?w:w==null?[]:na(w)}),S,x=!0;function _(){l.fallback=b,fn(l,S,d,a,t),b!==null&&(S.length===0?(b.f&gt)===0?za(b):(b.f^=gt,Lt(b,null,d)):Ra(b,()=>{b=null}))}var R=Ua(()=>{S=n(C);var w=S.length;let D=!1;if(at){var E=Ha(d)===Wa;E!==(w===0)&&(d=da(),Ut(d),Nt(!1),D=!0)}for(var T=new Set,M=kt,I=Na(),k=0;k<w;k+=1){at&&St.nodeType===Sa&&St.data===ja&&(d=St,D=!0,Nt(!1));var P=S[k],j=t(P,k),X=x?null:s.get(j);X?(X.v&&va(X.v,P),X.i&&va(X.i,k),I&&M.skipped_effects.delete(X.e)):(X=bn(s,x?d:ha??=jt(),P,j,k,o,a,e),x||(X.e.f|=gt),s.set(j,X)),T.add(j)}if(w===0&&r&&!b&&(x?b=Jt(()=>r(d)):(b=Jt(()=>r(ha??=jt())),b.f|=gt)),at&&w>0&&Ut(da()),!x)if(I){for(const[te,ue]of s)T.has(te)||M.skipped_effects.add(ue.e);M.oncommit(_),M.ondiscard(()=>{})}else _();D&&Nt(!0),n(C)}),l={effect:R,items:s,outrogroups:null,fallback:b};x=!1,at&&(d=St)}function Pt(i){for(;i!==null&&(i.f&Qa)===0;)i=i.next;return i}function fn(i,a,e,t,o){var r=(t&Za)!==0,d=a.length,s=i.items,c=Pt(i.effect.first),v,b=null,C,S=[],x=[],_,R,l,w;if(r)for(w=0;w<d;w+=1)_=a[w],R=o(_,w),l=s.get(R).e,(l.f&gt)===0&&(l.nodes?.a?.measure(),(C??=new Set).add(l));for(w=0;w<d;w+=1){if(_=a[w],R=o(_,w),l=s.get(R).e,i.outrogroups!==null)for(const X of i.outrogroups)X.pending.delete(l),X.done.delete(l);if((l.f&gt)!==0)if(l.f^=gt,l===c)Lt(l,null,e);else{var D=b?b.next:c;l===i.effect.last&&(i.effect.last=l.prev),l.prev&&(l.prev.next=l.next),l.next&&(l.next.prev=l.prev),xt(i,b,l),xt(i,l,D),Lt(l,D,e),b=l,S=[],x=[],c=Pt(b.next);continue}if((l.f&Yt)!==0&&(za(l),r&&(l.nodes?.a?.unfix(),(C??=new Set).delete(l))),l!==c){if(v!==void 0&&v.has(l)){if(S.length<x.length){var E=x[0],T;b=E.prev;var M=S[0],I=S[S.length-1];for(T=0;T<S.length;T+=1)Lt(S[T],E,e);for(T=0;T<x.length;T+=1)v.delete(x[T]);xt(i,M.prev,I.next),xt(i,b,M),xt(i,I,E),c=E,b=I,w-=1,S=[],x=[]}else v.delete(l),Lt(l,c,e),xt(i,l.prev,l.next),xt(i,l,b===null?i.effect.first:b.next),xt(i,b,l),b=l;continue}for(S=[],x=[];c!==null&&c!==l;)(v??=new Set).add(c),x.push(c),c=Pt(c.next);if(c===null)continue}(l.f&gt)===0&&S.push(l),b=l,c=Pt(l.next)}if(i.outrogroups!==null){for(const X of i.outrogroups)X.pending.size===0&&(Zt(na(X.done)),i.outrogroups?.delete(X));i.outrogroups.size===0&&(i.outrogroups=null)}if(c!==null||v!==void 0){var k=[];if(v!==void 0)for(l of v)(l.f&Yt)===0&&k.push(l);for(;c!==null;)(c.f&Yt)===0&&c!==i.fallback&&k.push(c),c=Pt(c.next);var P=k.length;if(P>0){var j=(t&Ea)!==0&&d===0?e:null;if(r){for(w=0;w<P;w+=1)k[w].nodes?.a?.measure();for(w=0;w<P;w+=1)k[w].nodes?.a?.fix()}hn(i,k,j)}}r&&Pa(()=>{if(C!==void 0)for(l of C)l.nodes?.a?.apply()})}function bn(i,a,e,t,o,r,d,s){var c=(d&Xa)!==0?(d&Ga)===0?N(e,!1,!1):ua(e):null,v=(d&Ya)!==0?ua(o):null;return{v:c,i:v,e:Jt(()=>(r(a,c??e,v??o,s),()=>{i.delete(t)}))}}function Lt(i,a,e){if(i.nodes)for(var t=i.nodes.start,o=i.nodes.end,r=a&&(a.f&gt)===0?a.nodes.start:e;t!==null;){var d=Ba(t);if(r.before(t),t===o)return;t=d}}function xt(i,a,e){a===null?i.effect.first=e:a.next=e,e===null?i.effect.last=a:e.prev=a}function fa(i,a,e=!1,t=!1,o=!1){var r=i,d="";K(()=>{var s=Ka;if(d===(d=a()??"")){at&&Vt();return}if(s.nodes!==null&&($a(s.nodes.start,s.nodes.end),s.nodes=null),d!==""){if(at){St.data;for(var c=Vt(),v=c;c!==null&&(c.nodeType!==Sa||c.data!=="");)v=c,c=Ba(c);if(c===null)throw en(),tn;ca(St,v),r=Ut(c);return}var b=d+"";e?b=`<svg>${b}</svg>`:t&&(b=`<math>${b}</math>`);var C=Oa(b);if((e||t)&&(C=Mt(C)),ca(Mt(C),C.lastChild),e||t)for(;Mt(C);)r.before(Mt(C));else r.before(C)}})}const ba=[...` 	
\r\fÂ \v\uFEFF`];function mn(i,a,e){var t=i==null?"":""+i;if(e){for(var o in e)if(e[o])t=t?t+" "+o:o;else if(t.length)for(var r=o.length,d=0;(d=t.indexOf(o,d))>=0;){var s=d+r;(d===0||ba.includes(t[d-1]))&&(s===t.length||ba.includes(t[s]))?t=(d===0?"":t.substring(0,d))+t.substring(s+1):d=s}}return t===""?null:t}function pn(i,a){return i==null?null:String(i)}function ce(i,a,e,t,o,r){var d=i.__className;if(at||d!==e||d===void 0){var s=mn(e,t,r);(!at||s!==i.getAttribute("class"))&&(s==null?i.removeAttribute("class"):i.className=s),i.__className=e}else if(r&&o!==r)for(var c in r){var v=!!r[c];(o==null||v!==!!o[c])&&i.classList.toggle(c,v)}return r}function ye(i,a,e,t){var o=i.__style;if(at||o!==a){var r=pn(a);(!at||r!==i.getAttribute("style"))&&(r==null?i.removeAttribute("style"):i.style.cssText=r),i.__style=a}return t}const wn=Symbol("is custom element"),xn=Symbol("is html");function Ft(i){if(at){var a=!1,e=()=>{if(!a){if(a=!0,i.hasAttribute("value")){var t=i.value;Ce(i,"value",null),i.value=t}if(i.hasAttribute("checked")){var o=i.checked;Ce(i,"checked",null),i.checked=o}}};i.__on_r=e,Pa(e),ln()}}function qt(i,a){var e=ra(i);e.value===(e.value=a??void 0)||i.value===a&&(a!==0||i.nodeName!=="PROGRESS")||(i.value=a??"")}function _n(i,a){var e=ra(i);e.checked!==(e.checked=a??void 0)&&(i.checked=a)}function Ce(i,a,e,t){var o=ra(i);at&&(o[a]=i.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&i.nodeName==="LINK")||o[a]!==(o[a]=e)&&(a==="loading"&&(i[an]=e),e==null?i.removeAttribute(a):typeof e!="string"&&yn(i).includes(a)?i[a]=e:i.setAttribute(a,e))}function ra(i){return i.__attributes??={[wn]:i.nodeName.includes("-"),[xn]:i.namespaceURI===nn}}var ma=new Map;function yn(i){var a=i.getAttribute("is")||i.nodeName,e=ma.get(a);if(e)return e;ma.set(a,e=[]);for(var t,o=i,r=Element.prototype;r!==o;){t=rn(o);for(var d in t)t[d].set&&e.push(d);o=on(o)}return e}function Cn(i,a,e=a){var t=new WeakSet;sn(i,"input",async o=>{var r=o?i.defaultValue:i.value;if(r=Xt(i)?Gt(r):r,e(r),kt!==null&&t.add(kt),await cn(),r!==(r=a())){var d=i.selectionStart,s=i.selectionEnd,c=i.value.length;if(i.value=r??"",s!==null){var v=i.value.length;d===s&&s===c&&v>c?(i.selectionStart=v,i.selectionEnd=v):(i.selectionStart=d,i.selectionEnd=Math.min(s,v))}}}),(at&&i.defaultValue!==i.value||m(a)==null&&i.value)&&(e(Xt(i)?Gt(i.value):i.value),kt!==null&&t.add(kt)),dn(()=>{var o=a();if(i===document.activeElement){var r=vn??kt;if(t.has(r))return}Xt(i)&&o===Gt(i.value)||i.type==="date"&&!o&&!i.value||o!==i.value&&(i.value=o??"")})}function Xt(i){var a=i.type;return a==="number"||a==="range"}function Gt(i){return i===""?null:+i}function lt(i){return function(...a){var e=a[0];return e.stopPropagation(),i?.apply(this,a)}}function Kt(i,a){var e=i.$$events?.[a.type],t=Ia(e)?e.slice():e==null?[]:[e];for(var o of t)o.call(this,a)}var kn=F('<header class="header svelte-hv3zzy"><img src="/logos/logo-picflam-logotype.png" alt="PicFlam" class="header-logo svelte-hv3zzy"/> <nav class="header-nav svelte-hv3zzy"><button aria-label="Crop tab"><img src="/icons/icon-crop.svg" alt="" class="nav-icon svelte-hv3zzy"/></button> <button aria-label="AI tab"><img src="/icons/icon-ai.svg" alt="" class="nav-icon svelte-hv3zzy"/></button> <button aria-label="Design tab"><img src="/icons/icon-design.svg" alt="" class="nav-icon svelte-hv3zzy"/></button></nav></header>');function Sn(i,a){ze(a,!1);let e=h(a,"activeTab",8,"crop"),t=h(a,"onTabChange",8);Ee();var o=kn(),r=u(f(o),2),d=f(r);let s;var c=u(d,2);let v;var b=u(c,2);let C;g(r),g(o),K(()=>{s=ce(d,1,"nav-btn svelte-hv3zzy",null,s,{active:e()==="crop"}),v=ce(c,1,"nav-btn svelte-hv3zzy",null,v,{active:e()==="ai"}),C=ce(b,1,"nav-btn svelte-hv3zzy",null,C,{active:e()==="design"})}),p("click",d,()=>t()("crop")),p("click",c,()=>t()("ai")),p("click",b,()=>t()("design")),L(i,o),Re()}function Da(i){return new Promise((a,e)=>{const t=new FileReader;t.onload=o=>a(o.target.result),t.onerror=e,t.readAsDataURL(i)})}function bt(i){return new Promise((a,e)=>{const t=new Image;t.onload=()=>a(t),t.onerror=e,t.src=i})}async function Ht(i){const a=await bt(i);return{width:a.naturalWidth,height:a.naturalHeight}}function pa(i,a=2048){return new Promise(async e=>{const t=await bt(i),{naturalWidth:o,naturalHeight:r}=t;if(o<=a&&r<=a){e(i);return}const d=document.createElement("canvas"),s=d.getContext("2d");let c,v;o>r?(c=a,v=r/o*a):(v=a,c=o/r*a),d.width=c,d.height=v,s.drawImage(t,0,0,c,v),e(d.toDataURL("image/jpeg",.92))})}async function In(){try{const i=await navigator.clipboard.read();for(const a of i)for(const e of a.types)if(e.startsWith("image/")){const t=await a.getType(e);return await Da(t)}return null}catch(i){return console.error("Failed to paste from clipboard:",i),null}}async function $t(i){try{const e=await(await fetch(i)).blob();return await navigator.clipboard.write([new ClipboardItem({[e.type]:e})]),!0}catch(a){return console.error("Failed to copy to clipboard:",a),!1}}function ea(i,a="picflam-export.png"){const e=document.createElement("a");e.href=i,e.download=a,document.body.appendChild(e),e.click(),document.body.removeChild(e)}async function Ma(i,a,e,t){const o=await bt(i),r=document.createElement("canvas"),d=r.getContext("2d"),s=a.x/100*e,c=a.y/100*t,v=a.width/100*e,b=a.height/100*t;return r.width=v,r.height=b,d.drawImage(o,s,c,v,b,0,0,v,b),r.toDataURL("image/png")}async function zn(i,a){const e=await bt(i),t=document.createElement("canvas"),o=t.getContext("2d");return t.width=e.naturalHeight,t.height=e.naturalWidth,o.translate(t.width/2,t.height/2),o.rotate(a*Math.PI/180),o.drawImage(e,-e.naturalWidth/2,-e.naturalHeight/2),t.toDataURL("image/png")}async function Rn(i,a){const e=await bt(i),t=document.createElement("canvas"),o=t.getContext("2d");return t.width=e.naturalWidth,t.height=e.naturalHeight,o.translate(t.width,0),o.scale(-1,1),o.drawImage(e,0,0),t.toDataURL("image/png")}async function Bn(i,a,e){const t=await bt(i),o=document.createElement("canvas"),r=o.getContext("2d");if(o.width=t.naturalWidth,o.height=t.naturalHeight,a&&a!=="none"&&(r.filter=a),r.drawImage(t,0,0),r.filter="none",e&&Array.isArray(e)&&e.length>0)if(e.some(s=>s.invert)){const c=.5+e.reduce((l,w)=>l+(w.strength||50),0)/e.length/100*9.5,v=document.createElement("canvas");v.width=o.width,v.height=o.height;const b=v.getContext("2d");b.filter=`blur(${c}px)`,a&&a!=="none"&&(b.filter=`blur(${c}px) ${a}`),b.drawImage(t,0,0);const C=document.createElement("canvas");C.width=o.width,C.height=o.height;const S=C.getContext("2d");S.fillStyle="white",S.fillRect(0,0,C.width,C.height);for(const l of e){if(!l.invert)continue;const w=(l.soften||50)/100,D=S.createRadialGradient(l.x,l.y,0,l.x,l.y,l.radius);D.addColorStop(0,"rgba(0,0,0,1)"),D.addColorStop(.5+w*.3,"rgba(0,0,0,0.5)"),D.addColorStop(1,"rgba(0,0,0,0)"),S.fillStyle=D,S.beginPath(),S.arc(l.x,l.y,l.radius,0,Math.PI*2),S.fill()}const x=r.getImageData(0,0,o.width,o.height),_=b.getImageData(0,0,o.width,o.height),R=S.getImageData(0,0,o.width,o.height);for(let l=0;l<x.data.length;l+=4){const w=R.data[l]/255;x.data[l]=x.data[l]*w+_.data[l]*(1-w),x.data[l+1]=x.data[l+1]*w+_.data[l+1]*(1-w),x.data[l+2]=x.data[l+2]*w+_.data[l+2]*(1-w)}r.putImageData(x,0,0)}else for(const s of e){const c=s.strength||50,v=(s.soften||50)/100,b=.5+c/100*9.5,C=document.createElement("canvas");C.width=o.width,C.height=o.height;const S=C.getContext("2d");S.filter=`blur(${b}px)`,a&&a!=="none"&&(S.filter=`blur(${b}px) ${a}`),S.drawImage(t,0,0);const x=document.createElement("canvas");x.width=o.width,x.height=o.height;const _=x.getContext("2d"),R=_.createRadialGradient(s.x,s.y,0,s.x,s.y,s.radius);R.addColorStop(0,"rgba(255,255,255,1)"),R.addColorStop(.5+v*.3,"rgba(255,255,255,0.5)"),R.addColorStop(1,"rgba(255,255,255,0)"),_.fillStyle=R,_.beginPath(),_.arc(s.x,s.y,s.radius,0,Math.PI*2),_.fill();const l=r.getImageData(0,0,o.width,o.height),w=S.getImageData(0,0,o.width,o.height),D=_.getImageData(0,0,o.width,o.height);for(let E=0;E<l.data.length;E+=4){const T=D.data[E]/255;l.data[E]=l.data[E]*(1-T)+w.data[E]*T,l.data[E+1]=l.data[E+1]*(1-T)+w.data[E+1]*T,l.data[E+2]=l.data[E+2]*(1-T)+w.data[E+2]*T}r.putImageData(l,0,0)}return o.toDataURL("image/png")}var En=F('<div role="button" tabindex="0"><p class="import-title svelte-f1bndr"> </p> <img src="/icons/icon-upload.svg" alt="" class="import-icon svelte-f1bndr"/> <p class="import-hint svelte-f1bndr"> </p> <button class="btn-paste svelte-f1bndr">Paste</button> <input type="file" accept="image/*" class="sr-only"/></div>');function La(i,a){ze(a,!1);let e=h(a,"title",8,"Import an image"),t=h(a,"hint",8,"Import, drag or paste an image"),o=h(a,"onImageImport",8,I=>{}),r=N(!1),d=N();async function s(I){if(!I||!I.type.startsWith("image/"))return;const k=await Da(I),P=await pa(k,2048);o()(P)}function c(I){const k=I.target.files?.[0];k&&s(k)}function v(I){I.preventDefault(),z(r,!1);const k=I.dataTransfer?.files?.[0];k&&s(k)}function b(I){I.preventDefault(),z(r,!0)}function C(){z(r,!1)}async function S(){const I=await In();if(I){const k=await pa(I,2048);o()(k)}}function x(){n(d)?.click()}Ee();var _=En();let R;var l=f(_),w=f(l,!0);g(l);var D=u(l,4),E=f(D,!0);g(D);var T=u(D,2),M=u(T,2);ht(M,I=>z(d,I),()=>n(d)),g(_),K(()=>{R=ce(_,1,"import-area svelte-f1bndr",null,R,{dragging:n(r)}),Ue(w,e()),Ue(E,t())}),p("click",T,lt(S)),p("change",M,c),p("click",_,x),p("drop",_,v),p("dragover",_,b),p("dragleave",_,C),p("keypress",_,I=>I.key==="Enter"&&x()),L(i,_),Re()}var Pn=F('<div class="action-bar svelte-96zw02"><div class="action-group svelte-96zw02"><button class="action-btn svelte-96zw02" aria-label="Undo"><img src="/icons/icon-undo.svg" alt="" class="action-icon svelte-96zw02"/></button> <button class="action-btn svelte-96zw02" aria-label="Redo"><img src="/icons/icon-redo.svg" alt="" class="action-icon svelte-96zw02"/></button></div> <div class="action-group svelte-96zw02"><button class="action-btn svelte-96zw02" aria-label="Start again"><img src="/icons/icon-startagain.svg" alt="" class="action-icon svelte-96zw02"/></button> <button class="action-btn svelte-96zw02" aria-label="Copy to clipboard"><img src="/icons/icon-copy.svg" alt="" class="action-icon svelte-96zw02"/></button> <button class="action-btn svelte-96zw02" aria-label="Export"><img src="/icons/icon-export.svg" alt="" class="action-icon svelte-96zw02"/></button></div></div>');function la(i,a){let e=h(a,"canUndo",8,!1),t=h(a,"canRedo",8,!1),o=h(a,"onUndo",8,()=>{}),r=h(a,"onRedo",8,()=>{}),d=h(a,"onStartAgain",8,()=>{}),s=h(a,"onCopy",8,()=>{}),c=h(a,"onExport",8,()=>{});var v=Pn(),b=f(v),C=f(b),S=u(C,2);g(b);var x=u(b,2),_=f(x),R=u(_,2),l=u(R,2);g(x),g(v),K(()=>{C.disabled=!e(),S.disabled=!t()}),p("click",C,function(...w){o()?.apply(this,w)}),p("click",S,function(...w){r()?.apply(this,w)}),p("click",_,function(...w){d()?.apply(this,w)}),p("click",R,function(...w){s()?.apply(this,w)}),p("click",l,function(...w){c()?.apply(this,w)}),L(i,v)}var Tn=F("<button> </button>"),Dn=F('<div class="sub-menu-tabs svelte-tv6tw8"></div>');function sa(i,a){ze(a,!1);let e=h(a,"tabs",24,()=>[]),t=h(a,"activeTab",8,""),o=h(a,"onTabChange",8,d=>{});Ee();var r=Dn();dt(r,5,e,ct,(d,s)=>{var c=Tn();let v;var b=f(c,!0);g(c),K(()=>{v=ce(c,1,"sub-menu-tab svelte-tv6tw8",null,v,{active:t()===n(s).id}),Ue(b,(n(s),m(()=>n(s).label)))}),p("click",c,()=>o()(n(s).id)),L(d,c)}),g(r),L(i,r),Re()}var Mn=F('<div class="modal-overlay svelte-qik81a" role="dialog" aria-modal="true" tabindex="-1"><div class="modal svelte-qik81a" role="document"><p class="modal-message svelte-qik81a"> </p> <div class="modal-actions svelte-qik81a"><button class="btn-text svelte-qik81a"> </button> <button class="btn-text btn-confirm svelte-qik81a"> </button></div></div></div>');function ta(i,a){ze(a,!1);let e=h(a,"message",8,""),t=h(a,"confirmText",8,"Yes"),o=h(a,"cancelText",8,"Cancel"),r=h(a,"onConfirm",8,()=>{}),d=h(a,"onCancel",8,()=>{});Ee();var s=Mn(),c=f(s),v=f(c),b=f(v,!0);g(v);var C=u(v,2),S=f(C),x=f(S,!0);g(S);var _=u(S,2),R=f(_,!0);g(_),g(C),g(c),g(s),K(()=>{Ue(b,e()),Ue(x,o()),Ue(R,t())}),p("click",S,function(...l){d()?.apply(this,l)}),p("click",_,function(...l){r()?.apply(this,l)}),p("click",c,lt(function(l){Kt.call(this,a,l)})),p("keydown",c,lt(function(l){Kt.call(this,a,l)})),p("click",s,function(...l){d()?.apply(this,l)}),p("keydown",s,l=>l.key==="Escape"&&d()()),L(i,s),Re()}var Ln=F('<canvas class="blur-canvas svelte-pjowa5"></canvas>'),An=F('<div class="blur-brush-indicator svelte-pjowa5"></div>'),Fn=F('<div class="blur-brush-preview svelte-pjowa5"></div>'),qn=F('<div class="crop-overlay svelte-pjowa5"><div class="overlay-top svelte-pjowa5"></div> <div class="overlay-bottom svelte-pjowa5"></div> <div class="overlay-left svelte-pjowa5"></div> <div class="overlay-right svelte-pjowa5"></div> <div class="crop-box svelte-pjowa5" role="button" aria-label="Drag to move crop area" tabindex="0"><div class="crop-border svelte-pjowa5"></div> <div class="corner-handle top-left svelte-pjowa5" role="button" aria-label="Resize top-left corner" tabindex="0"></div> <div class="corner-handle top-right svelte-pjowa5" role="button" aria-label="Resize top-right corner" tabindex="0"></div> <div class="corner-handle bottom-left svelte-pjowa5" role="button" aria-label="Resize bottom-left corner" tabindex="0"></div> <div class="corner-handle bottom-right svelte-pjowa5" role="button" aria-label="Resize bottom-right corner" tabindex="0"></div></div></div>'),On=F('<div class="crop-canvas svelte-pjowa5" role="application" aria-label="Image crop canvas"><div class="image-wrapper svelte-pjowa5"><img alt="Crop preview" class="canvas-image svelte-pjowa5" draggable="false"/> <!></div> <!> <!> <!></div>');function Un(i,a){ze(a,!1);const e=N(),t=N(),o=N(),r=N();let d=h(a,"imageSrc",8,""),s=h(a,"cropBox",24,()=>({x:10,y:10,width:80,height:80})),c=h(a,"isCropping",8,!1),v=h(a,"scale",8,1),b=h(a,"offsetX",8,0),C=h(a,"offsetY",8,0),S=h(a,"imageWidth",8,0),x=h(a,"imageHeight",8,0),_=h(a,"editFilters",8,""),R=h(a,"blurEnabled",8,!1),l=h(a,"blurBrushSize",8,50),w=h(a,"blurStrength",8,50),D=h(a,"blurSoften",8,50),E=h(a,"blurInvert",8,!1),T=h(a,"blurMask",24,()=>[]),M=h(a,"showBrushPreview",8,!1);const I=gn();let k=N(),P=N(),j=N({width:0,height:0}),X=!1,te=null,ue=0,le=0,$=null,be=0,q=1,H=!1,oe=N({x:0,y:0,visible:!1}),ge=N(null),Se=N("");async function we(){z(Se,d());const B=new Image;B.crossOrigin="anonymous",B.onload=()=>{z(ge,B)},B.src=d()}function Je(B){const V=document.createElement("canvas");V.width=n(ge).naturalWidth,V.height=n(ge).naturalHeight;const ne=V.getContext("2d");return ne.filter=`blur(${B}px)`,ne.drawImage(n(ge),0,0),V}function Ae(){if(!n(P)||!n(ge)||!T())return;const B=n(P).getContext("2d"),V=n(P).width,ne=n(P).height;if(B.clearRect(0,0,V,ne),T().length===0)return;const Y=V/S(),me=ne/x();if(T().some(ae=>ae.invert)){const ae=T().reduce((J,re)=>J+(re.strength||50),0)/T().length;T().reduce((J,re)=>J+(re.soften||50),0)/T().length;const y=.5+ae/100*9.5,A=Je(y);B.drawImage(A,0,0,V,ne),B.globalCompositeOperation="destination-out";for(const J of T()){if(!J.invert)continue;const re=J.x*Y,G=J.y*me,xe=J.radius*Math.min(Y,me),ke=(J.soften||50)/100,Me=Math.max(0,.3-ke*.3),Ie=.3+(1-ke)*.4,_e=B.createRadialGradient(re,G,0,re,G,xe);_e.addColorStop(Me,"rgba(0,0,0,1)"),_e.addColorStop(Ie,`rgba(0,0,0,${.5+ke*.3})`),_e.addColorStop(1,"rgba(0,0,0,0)"),B.fillStyle=_e,B.beginPath(),B.arc(re,G,xe,0,Math.PI*2),B.fill()}B.globalCompositeOperation="source-over"}else for(const ae of T()){const y=ae.x*Y,A=ae.y*me,J=ae.radius*Math.min(Y,me),re=ae.strength||50,G=(ae.soften||50)/100,xe=.5+re/100*9.5,ke=Je(xe);B.save();const Me=Math.max(0,.2-G*.2),Ie=.2+(1-G)*.5,_e=B.createRadialGradient(y,A,0,y,A,J);_e.addColorStop(Me,"rgba(255,255,255,1)"),_e.addColorStop(Ie,`rgba(255,255,255,${.4+G*.3})`),_e.addColorStop(1,"rgba(255,255,255,0)"),B.beginPath(),B.arc(y,A,J,0,Math.PI*2),B.clip(),B.drawImage(ke,0,0,V,ne),B.restore()}}Bt(()=>(He(),window.addEventListener("resize",He),()=>window.removeEventListener("resize",He)));function He(){if(n(k)){const B=n(k).getBoundingClientRect();z(j,{width:B.width,height:B.height})}}function U(B){return B.touches&&B.touches.length>0?{x:B.touches[0].clientX,y:B.touches[0].clientY}:{x:B.clientX,y:B.clientY}}function W(B){if(B.touches&&B.touches.length>=2){const V=B.touches[0].clientX-B.touches[1].clientX,ne=B.touches[0].clientY-B.touches[1].clientY;return Math.sqrt(V*V+ne*ne)}return 0}function Z(B,V="move"){if(!c())return;if(B.touches&&B.touches.length>=2){be=W(B),q=v(),te="pinch";return}B.preventDefault(),X=!0,te=V;const ne=U(B);ue=ne.x,le=ne.y,$={...s()}}function de(B){if(!c())return;if(te==="pinch"&&B.touches&&B.touches.length>=2){const De=W(B),ae=q*(De/be);I("scaleChange",{scale:Math.max(.5,Math.min(3,ae))});return}if(!X||!$)return;B.preventDefault();const V=U(B),ne=(V.x-ue)/n(e)*100,Y=(V.y-le)/n(t)*100;let me={...$};if(te==="move")me.x=Math.max(0,Math.min(100-$.width,$.x+ne)),me.y=Math.max(0,Math.min(100-$.height,$.y+Y));else if(te.includes("corner")){if(te.includes("left")){const ae=$.x+ne,y=$.width-ne;y>=10&&ae>=0&&(me.x=ae,me.width=y)}if(te.includes("right")){const ae=$.width+ne;ae>=10&&$.x+ae<=100&&(me.width=ae)}if(te.includes("top")){const ae=$.y+Y,y=$.height-Y;y>=10&&ae>=0&&(me.y=ae,me.height=y)}if(te.includes("bottom")){const ae=$.height+Y;ae>=10&&$.y+ae<=100&&(me.height=ae)}}I("cropChange",{cropBox:me})}function he(){X=!1,te=null,$=null,H&&(H=!1)}function Pe(B){R()&&(B.preventDefault(),H=!0,We(B))}function Be(B){if(!R())return;const V=n(k).getBoundingClientRect(),ne=U(B);z(oe,{x:ne.x-V.left,y:ne.y-V.top,visible:!0}),H&&We(B)}function Fe(){z(oe,{...n(oe),visible:!1}),H&&(H=!1)}function We(B){const V=n(k).getBoundingClientRect(),ne=U(B),Y=(ne.x-V.left)/n(e)*S(),me=(ne.y-V.top)/n(t)*x(),De=l()/100*Math.min(S(),x())*.15;I("blurPaint",{point:{x:Y,y:me,radius:De,strength:w(),soften:D(),invert:E()}})}Ne(()=>n(j),()=>{z(e,n(j).width)}),Ne(()=>(Le(x()),Le(S()),n(e)),()=>{z(t,x()&&S()?n(e)*x()/S():0)}),Ne(()=>(Le(l()),n(e),n(t)),()=>{z(o,l()/100*Math.min(n(e),n(t))*.3)}),Ne(()=>(Le(d()),n(P),n(Se)),()=>{d()&&n(P)&&d()!==n(Se)&&we()}),Ne(()=>(Le(T()),n(P),n(ge)),()=>{T()&&Array.isArray(T())&&T().length>0&&n(P)&&n(ge)&&Ae()}),Ne(()=>(Le(s()),n(e),n(t)),()=>{z(r,{x:s().x/100*n(e),y:s().y/100*n(t),width:s().width/100*n(e),height:s().height/100*n(t)})}),mt(),Ee();var ve=On(),je=f(ve),O=f(je),qe=u(O,2);{var nt=B=>{var V=Ln();ht(V,ne=>z(P,ne),()=>n(P)),K(()=>{Ce(V,"width",n(e)),Ce(V,"height",n(t)),ye(V,`filter: ${_()??""};`)}),L(B,V)};ee(qe,B=>{R()&&n(e)>0&&n(t)>0&&B(nt)})}g(je);var Oe=u(je,2);{var Te=B=>{var V=An();K(()=>ye(V,`
				left: ${n(oe),m(()=>n(oe).x)??""}px;
				top: ${n(oe),m(()=>n(oe).y)??""}px;
				width: ${n(o)??""}px;
				height: ${n(o)??""}px;
			`)),L(B,V)};ee(Oe,B=>{Le(R()),n(oe),m(()=>R()&&n(oe).visible)&&B(Te)})}var ie=u(Oe,2);{var fe=B=>{var V=Fn();K(()=>ye(V,`
				left: ${n(e)/2}px;
				top: ${n(t)/2}px;
				width: ${n(o)??""}px;
				height: ${n(o)??""}px;
			`)),L(B,V)};ee(ie,B=>{M()&&n(e)>0&&n(t)>0&&B(fe)})}var Xe=u(ie,2);{var Ye=B=>{var V=qn(),ne=f(V),Y=u(ne,2),me=u(Y,2),De=u(me,2),ae=u(De,2),y=u(f(ae),2),A=u(y,2),J=u(A,2),re=u(J,2);g(ae),g(V),K(()=>{ye(ne,`height: ${n(r),m(()=>n(r).y)??""}px;`),ye(Y,`top: ${n(r),m(()=>n(r).y+n(r).height)??""}px; height: ${n(t),n(r),m(()=>n(t)-n(r).y-n(r).height)??""}px;`),ye(me,`top: ${n(r),m(()=>n(r).y)??""}px; height: ${n(r),m(()=>n(r).height)??""}px; width: ${n(r),m(()=>n(r).x)??""}px;`),ye(De,`top: ${n(r),m(()=>n(r).y)??""}px; height: ${n(r),m(()=>n(r).height)??""}px; left: ${n(r),m(()=>n(r).x+n(r).width)??""}px; width: ${n(e),n(r),m(()=>n(e)-n(r).x-n(r).width)??""}px;`),ye(ae,`left: ${n(r),m(()=>n(r).x)??""}px; top: ${n(r),m(()=>n(r).y)??""}px; width: ${n(r),m(()=>n(r).width)??""}px; height: ${n(r),m(()=>n(r).height)??""}px;`)}),p("mousedown",y,lt(G=>Z(G,"corner-top-left"))),p("touchstart",y,lt(G=>Z(G,"corner-top-left"))),p("mousedown",A,lt(G=>Z(G,"corner-top-right"))),p("touchstart",A,lt(G=>Z(G,"corner-top-right"))),p("mousedown",J,lt(G=>Z(G,"corner-bottom-left"))),p("touchstart",J,lt(G=>Z(G,"corner-bottom-left"))),p("mousedown",re,lt(G=>Z(G,"corner-bottom-right"))),p("touchstart",re,lt(G=>Z(G,"corner-bottom-right"))),p("mousedown",ae,G=>Z(G,"move")),p("touchstart",ae,G=>Z(G,"move")),L(B,V)};ee(Xe,B=>{c()&&n(t)>0&&B(Ye)})}g(ve),ht(ve,B=>z(k,B),()=>n(k)),K(()=>{ye(je,`transform: scale(${v()??""}) translate(${b()??""}px, ${C()??""}px);`),Ce(O,"src",d()),ye(O,`filter: ${_()??""};`)}),p("mousemove",ve,function(...B){(R()?Be:de)?.apply(this,B)}),p("mouseup",ve,he),p("mouseleave",ve,function(...B){(R()?Fe:he)?.apply(this,B)}),p("touchmove",ve,function(...B){(R()?Be:de)?.apply(this,B)}),p("touchend",ve,he),p("mousedown",ve,function(...B){(R()?Pe:null)?.apply(this,B)}),p("touchstart",ve,function(...B){(R()?Pe:null)?.apply(this,B)}),L(i,ve),Re()}var Hn=F('<img alt="" class="toggle-icon svelte-1gdqxne"/>'),Wn=F('<span class="toggle-label svelte-1gdqxne"> </span>'),jn=F("<div><button><!></button> <!></div>"),Nn=F("<div></div>");function Aa(i,a){ze(a,!1);let e=h(a,"options",24,()=>[]),t=h(a,"value",8,""),o=h(a,"onChange",8,v=>{}),r=h(a,"showLabels",8,!0),d=h(a,"centered",8,!1);Ee();var s=Nn();let c;dt(s,5,e,ct,(v,b)=>{var C=jn();let S;var x=f(C);let _;var R=f(x);{var l=E=>{var T=Hn();K(()=>Ce(T,"src",`/icons/${n(b),m(()=>n(b).icon)??""}.svg`)),L(E,T)};ee(R,E=>{n(b),m(()=>n(b).icon)&&E(l)})}g(x);var w=u(x,2);{var D=E=>{var T=Wn(),M=f(T,!0);g(T),K(()=>Ue(M,(n(b),m(()=>n(b).label)))),L(E,T)};ee(w,E=>{Le(r()),n(b),m(()=>r()&&n(b).label)&&E(D)})}g(C),K(()=>{S=ce(C,1,"toggle-item svelte-1gdqxne",null,S,{active:t()===n(b).id}),_=ce(x,1,"toggle-btn svelte-1gdqxne",null,_,{active:t()===n(b).id}),Ce(x,"aria-label",(n(b),m(()=>n(b).label)))}),p("click",x,()=>o()(n(b).id)),L(v,C)}),g(s),K(()=>c=ce(s,1,"toggle-group svelte-1gdqxne",null,c,{centered:d()})),L(i,s),Re()}var Yn=F('<label class="input-label svelte-1r47u3b"> <input class="input svelte-1r47u3b"/></label>'),Xn=F('<input class="input svelte-1r47u3b"/>'),Gn=F('<div class="input-field svelte-1r47u3b"><!></div>');function wa(i,a){ze(a,!1);let e=h(a,"label",8,""),t=h(a,"value",12,""),o=h(a,"type",8,"text"),r=h(a,"placeholder",8,""),d=h(a,"disabled",8,!1),s=h(a,"onChange",8,x=>{});function c(x){t(x.target.value),s()(t())}Ee();var v=Gn(),b=f(v);{var C=x=>{var _=Yn(),R=f(_),l=u(R);Ft(l),g(_),K(()=>{Ue(R,`${e()??""} `),Ce(l,"type",o()),qt(l,t()),Ce(l,"placeholder",r()),l.disabled=d()}),p("input",l,c),L(x,_)},S=x=>{var _=Xn();Ft(_),K(()=>{Ce(_,"type",o()),qt(_,t()),Ce(_,"placeholder",r()),_.disabled=d()}),p("input",_,c),L(x,_)};ee(b,x=>{e()?x(C):x(S,!1)})}g(v),L(i,v),Re()}var Qn=F('<span class="slider-value svelte-jchife"> </span>'),Vn=F('<div class="slider-header svelte-jchife"><span class="slider-label svelte-jchife"> </span> <!></div>'),Jn=F('<div class="slider-container svelte-jchife"><!> <input type="range" class="slider svelte-jchife"/></div>');function Ve(i,a){ze(a,!1);let e=h(a,"label",8,""),t=h(a,"min",8,0),o=h(a,"max",8,100),r=h(a,"value",8,50),d=h(a,"step",8,1),s=h(a,"showValue",8,!1),c=h(a,"onChange",8,D=>{}),v=h(a,"onInteractionStart",8,()=>{}),b=h(a,"onInteractionEnd",8,()=>{});function C(D){const E=Number(D.target.value);c()(E)}function S(){v()()}function x(){b()()}Ee();var _=Jn(),R=f(_);{var l=D=>{var E=Vn(),T=f(E),M=f(T,!0);g(T);var I=u(T,2);{var k=P=>{var j=Qn(),X=f(j,!0);g(j),K(()=>Ue(X,r())),L(P,j)};ee(I,P=>{s()&&P(k)})}g(E),K(()=>Ue(M,e())),L(D,E)};ee(R,D=>{e()&&D(l)})}var w=u(R,2);Ft(w),g(_),K(()=>{Ce(w,"min",t()),Ce(w,"max",o()),Ce(w,"step",d()),qt(w,r())}),p("input",w,C),p("mousedown",w,S),p("touchstart",w,S),p("mouseup",w,x),p("touchend",w,x),L(i,_),Re()}var Zn=F('<div class="apply-row svelte-17iy3mz"><button class="btn-apply svelte-17iy3mz">Apply</button></div>'),Kn=F('<div class="crop-controls svelte-17iy3mz"><!> <div class="dimensions-row svelte-17iy3mz"><div class="dimension-input svelte-17iy3mz"><!></div> <button class="icon-btn svelte-17iy3mz"><img alt="" class="icon-btn-img svelte-17iy3mz"/></button> <div class="dimension-input svelte-17iy3mz"><!></div> <button class="icon-btn svelte-17iy3mz" aria-label="Flip horizontal"><img src="/icons/icon-flip-horizontal.svg" alt="" class="icon-btn-img svelte-17iy3mz"/></button> <button class="icon-btn svelte-17iy3mz" aria-label="Rotate"><img src="/icons/icon-rotate.svg" alt="" class="icon-btn-img svelte-17iy3mz"/></button></div> <!> <!></div>');function $n(i,a){ze(a,!1);let e=h(a,"aspectRatio",8,"9:16"),t=h(a,"cropWidth",8,1080),o=h(a,"cropHeight",8,1920),r=h(a,"ratioLocked",8,!0),d=h(a,"scale",8,100),s=h(a,"cropPending",8,!1),c=h(a,"onRatioChange",8,q=>{}),v=h(a,"onDimensionsChange",8,({width:q,height:H})=>{}),b=h(a,"onLockToggle",8,()=>{}),C=h(a,"onFlip",8,()=>{}),S=h(a,"onRotate",8,()=>{}),x=h(a,"onScaleChange",8,q=>{}),_=h(a,"onApply",8,()=>{});const R=[{id:"9:16",label:"9:16",icon:"icon-vertical"},{id:"1:1",label:"1:1",icon:"icon-square"},{id:"16:9",label:"16:9",icon:"icon-horizontal"},{id:"custom",label:"Custom",icon:"icon-custom"}];function l(q){const H=parseInt(q)||0;v()({width:H,height:o()})}function w(q){const H=parseInt(q)||0;v()({width:t(),height:H})}Ee();var D=Kn(),E=f(D);Aa(E,{get options(){return R},get value(){return e()},get onChange(){return c()},showLabels:!0});var T=u(E,2),M=f(T),I=f(M);{let q=st(()=>(Le(t()),m(()=>t().toString())));wa(I,{label:"Width",type:"number",get value(){return n(q)},onChange:l})}g(M);var k=u(M,2),P=f(k);g(k);var j=u(k,2),X=f(j);{let q=st(()=>(Le(o()),m(()=>o().toString())));wa(X,{label:"Height",type:"number",get value(){return n(q)},onChange:w})}g(j);var te=u(j,2),ue=u(te,2);g(T);var le=u(T,2);Ve(le,{label:"Scale",min:50,max:200,get value(){return d()},step:1,showValue:!0,get onChange(){return x()}});var $=u(le,2);{var be=q=>{var H=Zn(),oe=f(H);g(H),p("click",oe,function(...ge){_()?.apply(this,ge)}),L(q,H)};ee($,q=>{s()&&q(be)})}g(D),K(()=>{Ce(k,"aria-label",r()?"Unlock aspect ratio":"Lock aspect ratio"),Ce(P,"src",`/icons/${r()?"icon-lock":"icon-unlock"}.svg`)}),p("click",k,function(...q){b()?.apply(this,q)}),p("click",te,function(...q){C()?.apply(this,q)}),p("click",ue,function(...q){S()?.apply(this,q)}),L(i,D),Re()}var ei=F("<button> </button>"),ti=F("<button> </button>"),ai=F('<div class="blur-controls svelte-1e1k0ax"><div class="blur-control-row svelte-1e1k0ax"><!> <label class="invert-checkbox svelte-1e1k0ax"><input type="checkbox" class="svelte-1e1k0ax"/> <span class="checkbox-label svelte-1e1k0ax">Invert</span></label></div> <div class="slider-row svelte-1e1k0ax"><div class="slider-track svelte-1e1k0ax"><!></div> <button class="reset-btn svelte-1e1k0ax" aria-label="Reset"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-1e1k0ax"/></button></div> <div class="zoom-row svelte-1e1k0ax"><span class="zoom-label svelte-1e1k0ax">Zoom in</span> <div class="zoom-slider-row svelte-1e1k0ax"><div class="slider-track svelte-1e1k0ax"><!></div> <button class="reset-btn svelte-1e1k0ax" aria-label="Reset zoom"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-1e1k0ax"/></button></div></div> <div class="nudge-row svelte-1e1k0ax"><button class="nudge-btn svelte-1e1k0ax" aria-label="Nudge up"><img src="/icons/icon-nudge-up.svg" alt="" class="svelte-1e1k0ax"/></button> <button class="nudge-btn svelte-1e1k0ax" aria-label="Nudge down"><img src="/icons/icon-nudge-down.svg" alt="" class="svelte-1e1k0ax"/></button> <button class="nudge-btn svelte-1e1k0ax" aria-label="Nudge left"><img src="/icons/icon-nudge-left.svg" alt="" class="svelte-1e1k0ax"/></button> <button class="nudge-btn svelte-1e1k0ax" aria-label="Nudge right"><img src="/icons/icon-nudge-right.svg" alt="" class="svelte-1e1k0ax"/></button></div></div>'),ni=F('<div class="edit-controls svelte-1e1k0ax"><div class="enhancement-row svelte-1e1k0ax"></div> <div class="slider-row svelte-1e1k0ax"><div class="slider-track svelte-1e1k0ax"><!></div> <button class="reset-btn svelte-1e1k0ax" aria-label="Reset"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-1e1k0ax"/></button></div> <div class="blur-section svelte-1e1k0ax"><div class="blur-header svelte-1e1k0ax"><button class="chevron-btn svelte-1e1k0ax"><img alt=""/></button> <span class="blur-label svelte-1e1k0ax">Blur</span> <button><span class="toggle-thumb svelte-1e1k0ax"></span></button></div> <!></div></div>');function ii(i,a){ze(a,!1);const e=N(),t=N(),o=N(),r=N(),d=N(),s=N();let c=h(a,"brightness",8,0),v=h(a,"shadows",8,0),b=h(a,"contrast",8,0),C=h(a,"hdr",8,0),S=h(a,"blurBrushSize",8,50),x=h(a,"blurStrength",8,50),_=h(a,"blurSoften",8,50),R=h(a,"blurInvert",8,!1),l=h(a,"zoomLevel",8,1),w=h(a,"blurEnabled",8,!1),D=h(a,"onBrightnessChange",8,Y=>{}),E=h(a,"onShadowsChange",8,Y=>{}),T=h(a,"onContrastChange",8,Y=>{}),M=h(a,"onHdrChange",8,Y=>{}),I=h(a,"onBlurBrushSizeChange",8,Y=>{}),k=h(a,"onBlurStrengthChange",8,Y=>{}),P=h(a,"onBlurSoftenChange",8,Y=>{}),j=h(a,"onBlurInvertChange",8,Y=>{}),X=h(a,"onZoomChange",8,Y=>{}),te=h(a,"onNudge",8,Y=>{}),ue=h(a,"onResetZoom",8,()=>{}),le=h(a,"onBlurToggle",8,Y=>{}),$=h(a,"onBrushPreviewChange",8,Y=>{}),be=h(a,"onEditEnd",8,()=>{}),q=N("brightness"),H=N(w()),oe=N("brushSize");const ge=[{id:"brightness",label:"Brightness"},{id:"shadows",label:"Shadows"},{id:"contrast",label:"Contrast"},{id:"hdr",label:"HDR"}],Se=[{id:"brushSize",label:"Brush size"},{id:"strength",label:"Strength"},{id:"soften",label:"Soften edges"}];function we(Y){switch(n(q)){case"brightness":D()(Y);break;case"shadows":E()(Y);break;case"contrast":T()(Y);break;case"hdr":M()(Y);break}}function Je(){we(0)}function Ae(Y){switch(n(oe)){case"brushSize":I()(Y);break;case"strength":k()(Y);break;case"soften":P()(Y);break}}function He(){Ae(50)}function U(){const Y=!w();le()(Y),z(H,Y)}function W(){w()&&z(H,!n(H))}function Z(){j()(!R())}function de(Y){z(q,Y),z(H,!1)}function he(Y){z(oe,Y)}function Pe(){be()()}function Be(){n(oe)==="brushSize"&&$()(!0)}function Fe(){$()(!1),be()()}Ne(()=>(n(q),Le(c()),Le(v()),Le(b()),Le(C())),()=>{z(e,(()=>{switch(n(q)){case"brightness":return c();case"shadows":return v();case"contrast":return b();case"hdr":return C();default:return 0}})())}),Ne(()=>n(q),()=>{z(t,n(q)==="hdr"?0:-100)}),Ne(()=>{},()=>{z(o,100)}),Ne(()=>(n(oe),Le(S()),Le(x()),Le(_())),()=>{z(r,(()=>{switch(n(oe)){case"brushSize":return S();case"strength":return x();case"soften":return _();default:return 50}})())}),Ne(()=>{},()=>{z(d,1)}),Ne(()=>{},()=>{z(s,100)}),mt(),Ee();var We=ni(),ve=f(We);dt(ve,5,()=>ge,ct,(Y,me)=>{var De=ei();let ae;var y=f(De,!0);g(De),K(()=>{ae=ce(De,1,"enhancement-btn svelte-1e1k0ax",null,ae,{active:n(q)===n(me).id}),Ue(y,(n(me),m(()=>n(me).label)))}),p("click",De,()=>de(n(me).id)),L(Y,De)}),g(ve);var je=u(ve,2),O=f(je),qe=f(O);Ve(qe,{get min(){return n(t)},get max(){return n(o)},get value(){return n(e)},step:1,onChange:we,onInteractionEnd:Pe}),g(O);var nt=u(O,2);g(je);var Oe=u(je,2),Te=f(Oe),ie=f(Te),fe=f(ie);let Xe;g(ie);var Ye=u(ie,4);let B;g(Te);var V=u(Te,2);{var ne=Y=>{var me=ai(),De=f(me),ae=f(De);dt(ae,1,()=>Se,ct,(Q,pe)=>{var Ke=ti();let tt;var Et=f(Ke,!0);g(Ke),K(()=>{tt=ce(Ke,1,"blur-control-btn svelte-1e1k0ax",null,tt,{active:n(oe)===n(pe).id}),Ue(Et,(n(pe),m(()=>n(pe).label)))}),p("click",Ke,()=>he(n(pe).id)),L(Q,Ke)});var y=u(ae,2),A=f(y);Ft(A),_t(2),g(y),g(De);var J=u(De,2),re=f(J),G=f(re);Ve(G,{get min(){return n(d)},get max(){return n(s)},get value(){return n(r)},step:1,onChange:Ae,onInteractionStart:Be,onInteractionEnd:Fe}),g(re);var xe=u(re,2);g(J);var ke=u(J,2),Me=u(f(ke),2),Ie=f(Me),_e=f(Ie);Ve(_e,{min:1,max:3,step:.1,get value(){return l()},get onChange(){return X()}}),g(Ie);var ot=u(Ie,2);g(Me),g(ke);var Ze=u(ke,2),pt=f(Ze),$e=u(pt,2),rt=u($e,2),yt=u(rt,2);g(Ze),g(me),K(()=>_n(A,R())),p("change",A,Z),p("click",xe,He),p("click",ot,function(...Q){ue()?.apply(this,Q)}),p("click",pt,()=>te()("up")),p("click",$e,()=>te()("down")),p("click",rt,()=>te()("left")),p("click",yt,()=>te()("right")),L(Y,me)};ee(V,Y=>{n(H)&&w()&&Y(ne)})}g(Oe),g(We),K(()=>{ie.disabled=!w(),Ce(ie,"aria-label",n(H)?"Collapse":"Expand"),Ce(fe,"src",`/icons/${n(H)?"icon-collapse":"icon-expand"}.svg`),Xe=ce(fe,1,"chevron-icon svelte-1e1k0ax",null,Xe,{disabled:!w()}),B=ce(Ye,1,"toggle-switch svelte-1e1k0ax",null,B,{active:w()}),Ce(Ye,"aria-label",w()?"Disable blur":"Enable blur")}),p("click",nt,Je),p("click",ie,W),p("click",Ye,U),L(i,We),Re()}var oi=F('<button><div class="filter-preview svelte-183y0dt"></div> <span> </span></button>'),ri=F('<div class="filter-grid svelte-183y0dt"></div>');function li(i,a){ze(a,!1);let e=h(a,"filters",24,()=>[]),t=h(a,"value",8,"original"),o=h(a,"imageUrl",8,""),r=h(a,"onChange",8,s=>{});Ee();var d=ri();dt(d,5,e,ct,(s,c)=>{var v=oi();let b;var C=f(v),S=u(C,2);let x;var _=f(S,!0);g(S),g(v),K(()=>{b=ce(v,1,"filter-card svelte-183y0dt",null,b,{active:t()===n(c).id}),ye(C,`
					background-image: url(${o()??""});
					filter: ${n(c),m(()=>n(c).css||"none")??""};
				`),x=ce(S,1,"filter-label svelte-183y0dt",null,x,{active:t()===n(c).id}),Ue(_,(n(c),m(()=>n(c).label)))}),p("click",v,()=>r()(n(c).id)),L(s,v)}),g(d),L(i,d),Re()}var si=F('<div class="filter-controls svelte-1274k9v"><!> <div><div class="slider-track svelte-1274k9v"><!></div> <button class="reset-btn svelte-1274k9v" aria-label="Reset filter"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-1274k9v"/></button></div></div>');function ci(i,a){ze(a,!1);const e=N();let t=h(a,"imageUrl",8,""),o=h(a,"activeFilter",8,"original"),r=h(a,"filterStrength",8,50),d=h(a,"onFilterChange",8,w=>{}),s=h(a,"onStrengthChange",8,w=>{}),c=h(a,"onReset",8,()=>{});const v=[{id:"original",label:"Original",css:"none"},{id:"greyscale",label:"Greyscale",css:"grayscale(100%)"},{id:"sepia",label:"Sepia",css:"sepia(100%)"},{id:"sunset",label:"Sunset",css:"sepia(30%) saturate(140%) brightness(110%) hue-rotate(-10deg)"},{id:"azure",label:"Azure",css:"saturate(120%) brightness(105%) hue-rotate(180deg)"},{id:"teal",label:"Teal",css:"saturate(130%) hue-rotate(140deg)"}];Ne(()=>Le(o()),()=>{z(e,o()==="original")}),mt();var b=si(),C=f(b);li(C,{get filters(){return v},get value(){return o()},get imageUrl(){return t()},get onChange(){return d()}});var S=u(C,2);let x;var _=f(S),R=f(_);{let w=st(()=>n(e)?()=>{}:s());Ve(R,{label:"Strength",min:0,max:100,get value(){return r()},get onChange(){return n(w)}})}g(_);var l=u(_,2);g(S),g(b),K(()=>x=ce(S,1,"slider-row svelte-1274k9v",null,x,{disabled:n(e)})),p("click",l,function(...w){c()?.apply(this,w)}),L(i,b),Re()}const xa=[{id:"original",label:"Original",css:"none"},{id:"greyscale",label:"Greyscale",css:"grayscale(100%)"},{id:"sepia",label:"Sepia",css:"sepia(100%)"},{id:"sunset",label:"Sunset",css:"sepia(30%) saturate(140%) brightness(110%) hue-rotate(-10deg)"},{id:"azure",label:"Azure",css:"saturate(120%) brightness(105%) hue-rotate(180deg)"},{id:"teal",label:"Teal",css:"saturate(130%) hue-rotate(140deg)"}];function di(i){const a=[i];let e=0,t=0;const o=ft({canUndo:!1,canRedo:!1}),{subscribe:r,set:d,update:s}=ft(i);function c(){o.set({canUndo:e>t,canRedo:e<a.length-1})}return{subscribe:r,undoState:o,set:v=>{a.splice(e+1),a.push(v),e=a.length-1,d(v),c()},update:v=>{s(b=>{const C=v(b);return a.splice(e+1),a.push(C),e=a.length-1,c(),C})},silentUpdate:v=>{s(v)},setBaseState:()=>{t=e,c()},undo:()=>{e>t&&(e--,d(a[e]),c())},redo:()=>{e<a.length-1&&(e++,d(a[e]),c())},canUndo:()=>e>t,canRedo:()=>e<a.length-1,reset:()=>{a.length=0,a.push(i),e=0,t=0,d(i),c()}}}const vi={originalImage:null,currentImage:null,aspectRatio:"custom",width:0,height:0,ratioLocked:!1,scale:1,offsetX:0,offsetY:0,brightness:0,contrast:0,shadows:0,hdr:0,activeFilter:"original",filterStrength:50,cropBox:{x:0,y:0,width:0,height:0},isCropping:!1,cropPending:!1,imageWidth:0,imageHeight:0,blurEnabled:!1,blurBrushSize:50,blurStrength:50,blurSoften:50,blurInvert:!1,blurMask:null,showBrushPreview:!1,zoomLevel:1,zoomOffsetX:0,zoomOffsetY:0},se=di(vi),At=ft("none"),ui=ia(se,i=>i.currentImage!==null);function gi(){se.reset(),At.set("none")}var hi=F('<div class="controls-panel svelte-c9tnuw"><!></div>'),fi=F('<div class="controls-panel svelte-c9tnuw"><!></div>'),bi=F("<!> <!> <!> <!>",1),mi=F('<div class="crop-tab svelte-c9tnuw"><!> <!> <!></div>');function pi(i,a){ze(a,!1);const e=()=>it(se,"$cropState",d),t=()=>it(At,"$activeSubMenu",d),o=()=>it(ui,"$hasImage",d),r=()=>it(C,"$undoState",d),[d,s]=Rt(),c=N(),v=N(),b=N(),C=se.undoState,S=[{id:"crop",label:"Crop"},{id:"edit",label:"Edit"},{id:"filter",label:"Filter"}];let x=N(null),_=null;async function R(y){const A=await Ht(y);se.set({...e(),originalImage:y,currentImage:y,imageWidth:A.width,imageHeight:A.height,width:A.width,height:A.height,cropBox:{x:0,y:0,width:100,height:100},isCropping:!0,cropPending:!1,aspectRatio:"custom",ratioLocked:!1}),se.setBaseState(),At.set("crop")}function l(y){if(e().cropPending&&t()==="crop"&&y!=="crop"){_=()=>{At.set(y),se.silentUpdate(A=>({...A,isCropping:!1}))},z(x,"save");return}y==="crop"?se.silentUpdate(A=>({...A,isCropping:!0})):se.silentUpdate(A=>({...A,isCropping:!1})),At.set(t()===y?"none":y)}async function w(){return await Bn(e().currentImage,n(b),e().blurMask)}async function D(){if(e().cropPending){_=async()=>{const y=await w();await $t(y)},z(x,"save");return}if(e().currentImage){const y=await w();await $t(y)}}async function E(){if(e().cropPending){_=async()=>{const y=await w();ea(y,"picflam-export.png")},z(x,"save");return}if(e().currentImage){const y=await w();ea(y,"picflam-export.png")}}function T(){z(x,"startAgain")}function M(){se.undo()}function I(){se.redo()}async function k(){z(x,null),await te(),_&&(await _(),_=null)}function P(){z(x,null),_=null}function j(){z(x,null),gi()}function X(){z(x,null)}async function te(){const y=e();if(!y.currentImage||!y.cropPending)return;const A=await Ma(y.currentImage,y.cropBox,y.imageWidth,y.imageHeight),J=await Ht(A);se.set({...y,currentImage:A,imageWidth:J.width,imageHeight:J.height,width:J.width,height:J.height,cropBox:{x:0,y:0,width:100,height:100},cropPending:!1})}function ue(y){if(y==="custom"){se.silentUpdate(xe=>({...xe,aspectRatio:"custom",cropBox:{x:0,y:0,width:100,height:100},ratioLocked:!1,cropPending:!1}));return}const J={"9:16":9/16,"1:1":1,"16:9":16/9}[y],re=e().imageWidth/e().imageHeight;let G;if(y==="9:16"){const ke=J/re*100;if(ke<=100)G={x:(100-ke)/2,y:0,width:ke,height:100};else{const Me=re/J*100;G={x:0,y:(100-Me)/2,width:100,height:Me}}}else if(y==="16:9"){const ke=re/J*100;if(ke<=100)G={x:0,y:(100-ke)/2,width:100,height:ke};else{const Me=J/re*100;G={x:(100-Me)/2,y:0,width:Me,height:100}}}else if(y==="1:1")if(re>1){const xe=100/re;G={x:(100-xe)/2,y:0,width:xe,height:100}}else{const xe=100*re;G={x:0,y:(100-xe)/2,width:100,height:xe}}se.silentUpdate(xe=>({...xe,aspectRatio:y,cropBox:G,cropPending:!0,isCropping:!0,ratioLocked:!0}))}function le({width:y,height:A}){const J=e().imageWidth,re=e().imageHeight,G=Math.min(Math.max(1,y),J),xe=Math.min(Math.max(1,A),re),ke=G/J*100,Me=xe/re*100;let Ie;if(e().ratioLocked){const _e=n(c)/n(v);if(y!==n(c)){const Ze=G/_e/re*100;Ie={x:(100-ke)/2,y:(100-Math.min(100,Ze))/2,width:ke,height:Math.min(100,Ze)}}else{const Ze=xe*_e/J*100;Ie={x:(100-Math.min(100,Ze))/2,y:(100-Me)/2,width:Math.min(100,Ze),height:Me}}}else Ie={x:(100-ke)/2,y:(100-Me)/2,width:ke,height:Me};se.silentUpdate(_e=>({..._e,cropBox:Ie,cropPending:!0}))}function $(){se.silentUpdate(y=>({...y,ratioLocked:!y.ratioLocked}))}async function be(){const y=await Rn(e().currentImage);se.set({...e(),currentImage:y})}async function q(){const y=await zn(e().currentImage,90),A=await Ht(y);se.set({...e(),currentImage:y,imageWidth:A.width,imageHeight:A.height,cropBox:{x:0,y:0,width:100,height:100},cropPending:!1})}function H(y){se.silentUpdate(A=>({...A,scale:y/100}))}function oe(y){const A=y.detail.cropBox;if(e().ratioLocked&&e().aspectRatio!=="custom"){const re={"9:16":.5625,"1:1":1,"16:9":1.7777777777777777}[e().aspectRatio];e().imageWidth/e().imageHeight;const G=A.width*e().imageWidth/(A.height*e().imageHeight);if(Math.abs(G-re)>.01){const Me=A.width/100*e().imageWidth/re/e().imageHeight*100;A.height=Math.min(100,Me),A.y+A.height>100&&(A.y=100-A.height)}}se.silentUpdate(J=>({...J,cropBox:A,cropPending:!0}))}function ge(){te()}let Se=null;function we(){Se===null&&(Se={...e()})}function Je(){Se!==null&&(se.set(e()),Se=null)}function Ae(y){we(),se.silentUpdate(A=>({...A,brightness:y}))}function He(y){we(),se.silentUpdate(A=>({...A,shadows:y}))}function U(y){we(),se.silentUpdate(A=>({...A,contrast:y}))}function W(y){we(),se.silentUpdate(A=>({...A,hdr:y}))}function Z(y){se.set({...e(),blurEnabled:y})}function de(y){we(),se.silentUpdate(A=>({...A,blurBrushSize:y}))}function he(y){we(),se.silentUpdate(A=>({...A,blurStrength:y}))}function Pe(y){we(),se.silentUpdate(A=>({...A,blurSoften:y}))}function Be(y){se.set({...e(),blurInvert:y})}function Fe(y){se.silentUpdate(A=>({...A,showBrushPreview:y}))}function We(){Je()}let ve=null,je=[],O=null;function qe(y){const A=y.detail.point;O===null&&(O=e().blurMask?[...e().blurMask]:[]),je.push(A),se.silentUpdate(J=>({...J,blurMask:[...J.blurMask||[],A]})),ve&&clearTimeout(ve),ve=setTimeout(()=>{if(je.length>0){const J=[...O,...je];se.set({...e(),blurMask:J}),je=[],O=null}ve=null},300)}function nt(y){se.silentUpdate(A=>({...A,zoomLevel:y}))}function Oe(y){se.silentUpdate(J=>{let{zoomOffsetX:re,zoomOffsetY:G}=J;switch(y){case"up":G-=20;break;case"down":G+=20;break;case"left":re-=20;break;case"right":re+=20;break}return{...J,zoomOffsetX:re,zoomOffsetY:G}})}function Te(){se.silentUpdate(y=>({...y,zoomLevel:1,zoomOffsetX:0,zoomOffsetY:0}))}function ie(y){se.silentUpdate(A=>({...A,activeFilter:y}))}function fe(y){we(),se.silentUpdate(A=>({...A,filterStrength:y}))}function Xe(){se.set({...e(),activeFilter:"original",filterStrength:50})}Ne(()=>e(),()=>{z(c,Math.round(e().imageWidth*e().cropBox.width/100))}),Ne(()=>e(),()=>{z(v,Math.round(e().imageHeight*e().cropBox.height/100))}),Ne(()=>(e(),xa),()=>{z(b,(()=>{let y=[];if(e().brightness!==0&&y.push(`brightness(${1+e().brightness/100})`),e().contrast!==0&&y.push(`contrast(${1+e().contrast/100})`),e().shadows!==0){const A=1+e().shadows/200;y.push(`brightness(${A})`)}if(e().hdr!==0){const A=1+e().hdr/100*.3,J=1+e().hdr/100*.2;y.push(`saturate(${A}) contrast(${J})`)}if(e().activeFilter!=="original"){const A=xa.find(J=>J.id===e().activeFilter);if(A&&A.css!=="none"){const J=e().filterStrength/100,re=A.css.replace(/(\d+)%/g,(G,xe)=>`${Math.round(parseInt(xe)*J)}%`);y.push(re)}}return y.length>0?y.join(" "):"none"})())}),mt(),Ee();var Ye=mi(),B=f(Ye);{var V=y=>{La(y,{title:"Crop, edit and add filters to photos",hint:"Import, drag or paste an image",onImageImport:R})},ne=y=>{var A=bi(),J=Ge(A);la(J,{get canUndo(){return r(),m(()=>r().canUndo)},get canRedo(){return r(),m(()=>r().canRedo)},onUndo:M,onRedo:I,onStartAgain:T,onCopy:D,onExport:E});var re=u(J,2);{let Ie=st(()=>(t(),e(),m(()=>t()==="edit"?e().zoomLevel:e().scale))),_e=st(()=>(t(),e(),m(()=>t()==="edit"?e().zoomOffsetX:e().offsetX))),ot=st(()=>(t(),e(),m(()=>t()==="edit"?e().zoomOffsetY:e().offsetY))),Ze=st(()=>(e(),m(()=>e().blurMask||[])));Un(re,{get imageSrc(){return e(),m(()=>e().currentImage)},get cropBox(){return e(),m(()=>e().cropBox)},get isCropping(){return e(),m(()=>e().isCropping)},get scale(){return n(Ie)},get offsetX(){return n(_e)},get offsetY(){return n(ot)},get imageWidth(){return e(),m(()=>e().imageWidth)},get imageHeight(){return e(),m(()=>e().imageHeight)},get editFilters(){return n(b)},get blurEnabled(){return e(),m(()=>e().blurEnabled)},get blurBrushSize(){return e(),m(()=>e().blurBrushSize)},get blurStrength(){return e(),m(()=>e().blurStrength)},get blurSoften(){return e(),m(()=>e().blurSoften)},get blurInvert(){return e(),m(()=>e().blurInvert)},get blurMask(){return n(Ze)},get showBrushPreview(){return e(),m(()=>e().showBrushPreview)},$$events:{cropChange:oe,blurPaint:qe}})}var G=u(re,2);sa(G,{get tabs(){return S},get activeTab(){return t()},onTabChange:l});var xe=u(G,2);{var ke=Ie=>{{let _e=st(()=>(e(),m(()=>Math.round(e().scale*100))));$n(Ie,{get aspectRatio(){return e(),m(()=>e().aspectRatio)},get cropWidth(){return n(c)},get cropHeight(){return n(v)},get ratioLocked(){return e(),m(()=>e().ratioLocked)},get scale(){return n(_e)},get cropPending(){return e(),m(()=>e().cropPending)},onRatioChange:ue,onDimensionsChange:le,onLockToggle:$,onFlip:be,onRotate:q,onScaleChange:H,onApply:ge})}},Me=Ie=>{var _e=ut(),ot=Ge(_e);{var Ze=$e=>{var rt=hi(),yt=f(rt);ii(yt,{get brightness(){return e(),m(()=>e().brightness)},get shadows(){return e(),m(()=>e().shadows)},get contrast(){return e(),m(()=>e().contrast)},get hdr(){return e(),m(()=>e().hdr)},get blurEnabled(){return e(),m(()=>e().blurEnabled)},get blurBrushSize(){return e(),m(()=>e().blurBrushSize)},get blurStrength(){return e(),m(()=>e().blurStrength)},get blurSoften(){return e(),m(()=>e().blurSoften)},get blurInvert(){return e(),m(()=>e().blurInvert)},get zoomLevel(){return e(),m(()=>e().zoomLevel)},onBrightnessChange:Ae,onShadowsChange:He,onContrastChange:U,onHdrChange:W,onBlurToggle:Z,onBlurBrushSizeChange:de,onBlurStrengthChange:he,onBlurSoftenChange:Pe,onBlurInvertChange:Be,onZoomChange:nt,onNudge:Oe,onResetZoom:Te,onBrushPreviewChange:Fe,onEditEnd:We}),g(rt),L($e,rt)},pt=$e=>{var rt=ut(),yt=Ge(rt);{var Q=pe=>{var Ke=fi(),tt=f(Ke);ci(tt,{get imageUrl(){return e(),m(()=>e().currentImage)},get activeFilter(){return e(),m(()=>e().activeFilter)},get filterStrength(){return e(),m(()=>e().filterStrength)},onFilterChange:ie,onStrengthChange:fe,onReset:Xe}),g(Ke),L(pe,Ke)};ee(yt,pe=>{t()==="filter"&&pe(Q)},!0)}L($e,rt)};ee(ot,$e=>{t()==="edit"?$e(Ze):$e(pt,!1)},!0)}L(Ie,_e)};ee(xe,Ie=>{t()==="crop"?Ie(ke):Ie(Me,!1)})}L(y,A)};ee(B,y=>{o()?y(ne,!1):y(V)})}var Y=u(B,2);{var me=y=>{ta(y,{message:"Save changes?",confirmText:"Yes",cancelText:"Cancel",onConfirm:k,onCancel:P})};ee(Y,y=>{n(x)==="save"&&y(me)})}var De=u(Y,2);{var ae=y=>{ta(y,{message:"Start again? Your changes will be lost.",confirmText:"Yes",cancelText:"Cancel",onConfirm:j,onCancel:X})};ee(De,y=>{n(x)==="startAgain"&&y(ae)})}g(Ye),L(i,Ye),Re(),s()}var wi=F('<div class="before-after-container svelte-1i0ztfp" role="slider" aria-label="Before and after comparison" tabindex="0"><div class="before-image svelte-1i0ztfp"><img alt="Before" class="svelte-1i0ztfp"/></div> <div class="after-image svelte-1i0ztfp"><img alt="After" class="svelte-1i0ztfp"/></div> <div class="slider-handle svelte-1i0ztfp" role="presentation"><div class="slider-line svelte-1i0ztfp"></div> <div class="slider-thumb svelte-1i0ztfp"><img src="/icons/icon-ai-slider.svg" alt="" class="slider-icon svelte-1i0ztfp"/></div></div></div>');function xi(i,a){ze(a,!1);let e=h(a,"beforeImage",8,""),t=h(a,"afterImage",8,""),o=h(a,"position",12,50),r=h(a,"onChange",8,()=>{}),d=N(),s=!1;Bt(()=>(window.addEventListener("mousemove",b),window.addEventListener("touchmove",C,{passive:!1}),window.addEventListener("mouseup",S),window.addEventListener("touchend",S),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("touchmove",C),window.removeEventListener("mouseup",S),window.removeEventListener("touchend",S)}));function c(){s=!0}function v(M){M.touches.length===1&&(s=!0)}function b(M){!s||!n(d)||x(M.clientX)}function C(M){!s||!n(d)||M.touches.length!==1||(M.preventDefault(),x(M.touches[0].clientX))}function S(){s=!1}function x(M){const I=n(d).getBoundingClientRect(),k=Math.max(0,Math.min(100,(M-I.left)/I.width*100));o(k),r()(k)}function _(M){if(!n(d))return;const I=n(d).getBoundingClientRect(),k=(M.clientX-I.left)/I.width*100;o(Math.max(0,Math.min(100,k))),r()(o())}Ee();var R=wi(),l=f(R),w=f(l);g(l);var D=u(l,2),E=f(D);g(D);var T=u(D,2);g(R),ht(R,M=>z(d,M),()=>n(d)),K(()=>{Ce(w,"src",e()),ye(D,`clip-path: inset(0 ${100-o()}% 0 0)`),Ce(E,"src",t()),ye(T,`left: ${o()??""}%`)}),p("mousedown",T,c),p("touchstart",T,v),p("click",R,_),L(i,R),Re()}const _a={originalImage:null,currentImage:null,processedImage:null,isProcessing:!1,processingType:null,upscaleFactor:1,showComparison:!1,comparisonPosition:50};function _i(){const{subscribe:i,set:a,update:e}=ft(_a);return{subscribe:i,setImage:t=>e(o=>({...o,originalImage:t,currentImage:t,processedImage:null})),startProcessing:t=>e(o=>({...o,isProcessing:!0,processingType:t})),finishProcessing:t=>e(o=>({...o,isProcessing:!1,processingType:null,processedImage:t,currentImage:t,showComparison:!0})),cancelProcessing:()=>e(t=>({...t,isProcessing:!1,processingType:null})),setUpscaleFactor:t=>e(o=>({...o,upscaleFactor:t})),setComparisonPosition:t=>e(o=>({...o,comparisonPosition:t})),reset:()=>a(_a)}}const et=_i(),ya=ft("enhance"),yi=ia(et,i=>i.currentImage!==null);let Tt=null;async function Ci(i,a=4,e){e?.("Uploading image...");const t=await fetch("/api/face-enhance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:i,scale:a,faceEnhance:.5})}),o=await t.json();if(!t.ok)throw new Error(o.error||`API error: ${t.status}`);if(o.status==="succeeded"&&o.output)return e?.("Downloading result..."),await Fa(o.output);if(o.status==="processing"||o.status==="starting")return e?.("Processing with CodeFormer..."),await ki(o.pollUrl,e);throw new Error("Unexpected response")}async function ki(i,a,e=60){for(let t=0;t<e;t++){await new Promise(d=>setTimeout(d,2e3));const o=await fetch(`/api/upscale?pollUrl=${encodeURIComponent(i)}`),r=await o.json();if(!o.ok)throw new Error(r.error||`Polling error: ${o.status}`);if(r.status==="succeeded"&&r.output)return a?.("Downloading result..."),await Fa(r.output);if(r.status==="failed")throw new Error(r.error||"Upscaling failed");a?.(`Processing in cloud (${(t+1)*2}s)...`)}throw new Error("Timeout waiting for result")}async function Fa(i){const e=await(await fetch(i)).blob();return new Promise((t,o)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=o,r.readAsDataURL(e)})}async function Si(i){if(Tt)return Tt;console.log("[AI] Loading RMBG background removal model..."),i?.("Downloading model (first time only)...");const{pipeline:a,env:e}=await un(async()=>{const{pipeline:t,env:o}=await import("../chunks/bLAnV4ll.js");return{pipeline:t,env:o}},[],import.meta.url);e.allowLocalModels=!1;try{Tt=await a("image-segmentation","briaai/RMBG-1.4",{device:"webgpu",dtype:"fp32"}),console.log("[AI] RMBG model ready (WebGPU)")}catch(t){console.log("[AI] WebGPU not available, falling back to WASM...",t.message),Tt=await a("image-segmentation","briaai/RMBG-1.4",{dtype:"q8"}),console.log("[AI] RMBG model ready (WASM)")}return Tt}async function Ii(i,a){try{console.log("[AI] Starting background removal...");const e=await Si(a);a?.("Processing image...");const t=await e(i);if(console.log("[AI] Segmentation result:",t),!t||t.length===0)throw new Error("No segmentation result returned");const o=t[0];if(console.log("[AI] Segment keys:",Object.keys(o)),o.mask&&o.mask.toDataURL)return console.log("[AI] Background removal complete (RawImage mask)"),await Ca(i,o.mask);if(o.mask&&o.mask.data)return console.log("[AI] Background removal complete (data mask)"),await Ca(i,o.mask);if(typeof o=="string"&&o.startsWith("data:"))return console.log("[AI] Background removal complete (direct output)"),o;throw console.log("[AI] Segment structure:",JSON.stringify(o,null,2).substring(0,500)),new Error("Unexpected segmentation result format")}catch(e){throw console.error("[AI] Background removal failed:",e),new Error("Background removal failed: "+e.message)}}async function Ca(i,a){return new Promise((e,t)=>{const o=new Image;o.onload=async()=>{try{const r=document.createElement("canvas");r.width=o.width,r.height=o.height;const d=r.getContext("2d");d.drawImage(o,0,0);const s=d.getImageData(0,0,r.width,r.height),c=s.data;let v,b,C;if(a.toDataURL){const x=document.createElement("canvas");x.width=a.width,x.height=a.height;const _=x.getContext("2d"),R=new Image;R.onload=()=>{_.drawImage(R,0,0);const l=_.getImageData(0,0,a.width,a.height);ka(c,l.data,r.width,r.height,a.width,a.height,!0),d.putImageData(s,0,0),e(r.toDataURL("image/png"))},R.onerror=t,R.src=a.toDataURL();return}else v=a.data,b=a.width,C=a.height;const S=v.length===b*C*4;ka(c,v,r.width,r.height,b,C,S),d.putImageData(s,0,0),e(r.toDataURL("image/png"))}catch(r){t(r)}},o.onerror=t,o.src=i})}function ka(i,a,e,t,o,r,d){const s=o/e,c=r/t;for(let v=0;v<t;v++)for(let b=0;b<e;b++){const C=Math.floor(b*s),S=Math.floor(v*c);let x;if(d){const R=(S*o+C)*4;x=a[R]}else{const R=S*o+C;x=a[R]||0}const _=(v*e+b)*4;i[_+3]=x}}var zi=F('<div class="size-display svelte-1rgvkgu"> </div>'),Ri=F('<button class="processing-btn svelte-1rgvkgu" disabled><span class="spinner svelte-1rgvkgu"></span> </button> <button class="cancel-btn svelte-1rgvkgu">Cancel</button>',1),Bi=F('<button class="upscale-btn svelte-1rgvkgu"><img src="/icons/icon-ai.svg" alt="" class="btn-icon svelte-1rgvkgu"/> Upscale image</button> <p class="hint svelte-1rgvkgu">Upscales, sharpens and enhances images</p>',1),Ei=F('<div class="error-message svelte-1rgvkgu"> </div>'),Pi=F('<div class="upscale-controls svelte-1rgvkgu"><div class="controls-content svelte-1rgvkgu"><!> <!> <!></div></div>');function Ti(i,a){ze(a,!1);const e=()=>it(et,"$aiState",t),[t,o]=Rt(),r=4;let d=N(!1),s=N(""),c=N(null),v=N(null);async function b(){try{const I=await bt(e().originalImage),k=Math.round(I.naturalWidth*r),P=Math.round(I.naturalHeight*r);z(v,`${k} x ${P}`)}catch(I){console.error("Failed to get image dimensions:",I)}}async function C(){if(e().originalImage)try{z(d,!0),z(c,null),z(s,"Starting..."),et.startProcessing("upscale");const I=await Ci(e().originalImage,r,k=>{z(s,k)});et.finishProcessing(I)}catch(I){z(c,I.message||"Upscaling failed"),et.cancelProcessing()}finally{z(d,!1),z(s,"")}}function S(){z(d,!1),z(s,""),z(c,null),et.cancelProcessing()}Ne(()=>e(),()=>{e().originalImage&&b()}),mt(),Ee();var x=Pi(),_=f(x),R=f(_);{var l=I=>{var k=zi(),P=f(k);g(k),K(()=>Ue(P,`Output: ${n(v)??""}`)),L(I,k)};ee(R,I=>{n(v)&&I(l)})}var w=u(R,2);{var D=I=>{var k=Ri(),P=Ge(k),j=u(f(P));g(P);var X=u(P,2);K(()=>Ue(j,` ${n(s)||"Processing..."}`)),p("click",X,S),L(I,k)},E=I=>{var k=Bi(),P=Ge(k);_t(2),p("click",P,C),L(I,k)};ee(w,I=>{n(d)?I(D):I(E,!1)})}var T=u(w,2);{var M=I=>{var k=Ei(),P=f(k,!0);g(k),K(()=>Ue(P,n(c))),L(I,k)};ee(T,I=>{n(c)&&I(M)})}g(_),g(x),L(i,x),Re(),o()}var Di=F('<img alt="Original" class="compare-overlay svelte-1ibkqf6"/>'),Mi=F('<div class="brush-indicator svelte-1ibkqf6"></div>'),Li=F('<div class="brush-preview svelte-1ibkqf6"></div>'),Ai=F('<div class="drawer-overlay svelte-1ibkqf6" role="presentation"><div class="drawer svelte-1ibkqf6" role="dialog"><div class="drawer-header svelte-1ibkqf6"><button class="icon-btn svelte-1ibkqf6" title="Undo"><img src="/icons/icon-undo.svg" alt="Undo" class="svelte-1ibkqf6"/></button> <button class="icon-btn svelte-1ibkqf6" title="Redo"><img src="/icons/icon-redo.svg" alt="Redo" class="svelte-1ibkqf6"/></button> <div class="spacer svelte-1ibkqf6"></div> <button title="Compare"><img src="/icons/icon-compare.svg" alt="Compare" class="svelte-1ibkqf6"/></button></div> <div class="canvas-container svelte-1ibkqf6"><div class="canvas-wrapper svelte-1ibkqf6" role="presentation"><canvas class="svelte-1ibkqf6"></canvas> <!> <!> <!></div></div> <div class="controls-section svelte-1ibkqf6"><div class="button-group svelte-1ibkqf6"><button><img src="/icons/icon-erase.svg" alt="" class="svelte-1ibkqf6"/> Erase</button> <button><img src="/icons/icon-restore.svg" alt="" class="svelte-1ibkqf6"/> Restore</button></div> <div class="control-row svelte-1ibkqf6"><label class="svelte-1ibkqf6">Brush size</label> <div class="control-item svelte-1ibkqf6"><!> <button class="reset-btn svelte-1ibkqf6" title="Reset"><img src="/icons/icon-reset.svg" alt="Reset" class="svelte-1ibkqf6"/></button></div></div> <div class="control-row svelte-1ibkqf6"><label class="svelte-1ibkqf6">Soften edges</label> <div class="control-item svelte-1ibkqf6"><!> <button class="reset-btn svelte-1ibkqf6" title="Reset"><img src="/icons/icon-reset.svg" alt="Reset" class="svelte-1ibkqf6"/></button></div></div> <div class="control-row svelte-1ibkqf6"><label class="svelte-1ibkqf6">Zoom in</label> <div class="control-item svelte-1ibkqf6"><!> <button class="reset-btn svelte-1ibkqf6" title="Reset"><img src="/icons/icon-reset.svg" alt="Reset" class="svelte-1ibkqf6"/></button></div></div> <div class="nudge-buttons svelte-1ibkqf6"><button class="nudge-btn svelte-1ibkqf6">â</button> <button class="nudge-btn svelte-1ibkqf6">â</button> <button class="nudge-btn svelte-1ibkqf6">â</button> <button class="nudge-btn svelte-1ibkqf6">â</button></div> <div class="drawer-footer svelte-1ibkqf6"><button class="btn-cancel svelte-1ibkqf6">Cancel</button> <button class="btn-done svelte-1ibkqf6">Done</button></div></div></div></div>');function Fi(i,a){ze(a,!1);const e=N();let t=h(a,"image",8,""),o=h(a,"originalFullImage",8,""),r=h(a,"onClose",8,()=>{}),d=h(a,"onSave",8,()=>{}),s=N(),c=N(),v,b=N(!0),C=N(20),S=N(50),x=N(1),_=N(0),R=N(0),l=!1,w=[],D=0,E=null,T=N({x:0,y:0,visible:!1}),M=N(!1),I=N(0),k=N(0),P=N(!1);Bt(async()=>{const Q=await bt(t());ga(s,n(s).width=Q.naturalWidth),ga(s,n(s).height=Q.naturalHeight),v=n(s).getContext("2d"),v.drawImage(Q,0,0),o()?E=await bt(o()):E=Q,j(),X()});function j(){if(n(c)){const Q=n(c).getBoundingClientRect();z(I,Q.width),z(k,Q.height)}}function X(){w=w.slice(0,D+1),w.push(n(s).toDataURL()),D=w.length-1}function te(){D>0&&(D--,le())}function ue(){D<w.length-1&&(D++,le())}function le(){const Q=new Image;Q.onload=()=>{v.clearRect(0,0,n(s).width,n(s).height),v.drawImage(Q,0,0)},Q.src=w[D]}function $(Q){const pe=n(c).getBoundingClientRect(),Ke=n(s).width/pe.width,tt=n(s).height/pe.height,Et=(Q.clientX-pe.left)*Ke,Ot=(Q.clientY-pe.top)*tt;return{x:Et,y:Ot}}function be(Q){l=!0;const{x:pe,y:Ke}=$(Q);ge(pe,Ke)}function q(Q){const pe=n(c).getBoundingClientRect();if(z(T,{x:Q.clientX-pe.left,y:Q.clientY-pe.top,visible:!0}),!l)return;const{x:Ke,y:tt}=$(Q);ge(Ke,tt)}function H(){l&&(l=!1,X())}function oe(){z(T,{...n(T),visible:!1}),l&&(l=!1,X())}function ge(Q,pe){const Ke=n(s).width/n(c).getBoundingClientRect().width,tt=n(e)/2*Ke,Et=n(S)/100,Ot=Math.min(tt-.001,tt*(1-Et));v.save();try{if(n(b)){const vt=v.createRadialGradient(Q,pe,Ot,Q,pe,tt);vt.addColorStop(0,"rgba(0,0,0,1)"),vt.addColorStop(1,"rgba(0,0,0,0)"),v.globalCompositeOperation="destination-out",v.fillStyle=vt,v.beginPath(),v.arc(Q,pe,tt,0,Math.PI*2),v.fill()}else{if(!E)return;const vt=document.createElement("canvas");vt.width=n(s).width,vt.height=n(s).height;const wt=vt.getContext("2d"),Wt=wt.createRadialGradient(Q,pe,Ot,Q,pe,tt);Wt.addColorStop(0,"rgba(0,0,0,1)"),Wt.addColorStop(1,"rgba(0,0,0,0)"),wt.globalCompositeOperation="source-over",wt.drawImage(E,0,0,vt.width,vt.height),wt.globalCompositeOperation="destination-in",wt.fillStyle=Wt,wt.beginPath(),wt.arc(Q,pe,tt,0,Math.PI*2),wt.fill(),v.globalCompositeOperation="source-over",v.drawImage(vt,0,0)}}finally{v.restore()}}function Se(){z(C,20)}function we(){z(S,50)}function Je(){z(x,1),z(_,0),z(R,0)}function Ae(Q){switch(Q){case"up":z(R,n(R)-10);break;case"down":z(R,n(R)+10);break;case"left":z(_,n(_)-10);break;case"right":z(_,n(_)+10);break}}function He(){r()()}function U(){const Q=n(s).toDataURL("image/png");d()(Q)}Ne(()=>(n(C),n(I),n(k)),()=>{z(e,n(C)/100*Math.min(n(I)||300,n(k)||300)*.5)}),mt(),Ee();var W=Ai(),Z=f(W),de=f(Z),he=f(de),Pe=u(he,2),Be=u(Pe,4);let Fe;g(de);var We=u(de,2),ve=f(We),je=f(ve);ht(je,Q=>z(s,Q),()=>n(s));var O=u(je,2);{var qe=Q=>{var pe=Di();K(()=>Ce(pe,"src",o())),L(Q,pe)};ee(O,Q=>{n(P)&&o()&&Q(qe)})}var nt=u(O,2);{var Oe=Q=>{var pe=Mi();K(()=>ye(pe,`
							left: ${n(T),m(()=>n(T).x)??""}px;
							top: ${n(T),m(()=>n(T).y)??""}px;
							width: ${n(e)??""}px;
							height: ${n(e)??""}px;
						`)),L(Q,pe)};ee(nt,Q=>{n(T),n(I),m(()=>n(T).visible&&n(I)>0)&&Q(Oe)})}var Te=u(nt,2);{var ie=Q=>{var pe=Li();K(()=>ye(pe,`
						left: ${n(I)/2}px;
						top: ${n(k)/2}px;
						width: ${n(e)??""}px;
						height: ${n(e)??""}px;
					`)),L(Q,pe)};ee(Te,Q=>{n(M)&&n(I)>0&&n(k)>0&&Q(ie)})}g(ve),ht(ve,Q=>z(c,Q),()=>n(c)),g(We);var fe=u(We,2),Xe=f(fe),Ye=f(Xe);let B;var V=u(Ye,2);let ne;g(Xe);var Y=u(Xe,2),me=u(f(Y),2),De=f(me);Ve(De,{min:5,max:100,step:1,get value(){return n(C)},onChange:Q=>z(C,Q),onInteractionStart:()=>{j(),z(M,!0)},onInteractionEnd:()=>z(M,!1)});var ae=u(De,2);g(me),g(Y);var y=u(Y,2),A=u(f(y),2),J=f(A);Ve(J,{min:0,max:100,step:1,get value(){return n(S)},onChange:Q=>z(S,Q)});var re=u(J,2);g(A),g(y);var G=u(y,2),xe=u(f(G),2),ke=f(xe);Ve(ke,{min:1,max:3,step:.1,get value(){return n(x)},onChange:Q=>z(x,Q)});var Me=u(ke,2);g(xe),g(G);var Ie=u(G,2),_e=f(Ie),ot=u(_e,2),Ze=u(ot,2),pt=u(Ze,2);g(Ie);var $e=u(Ie,2),rt=f($e),yt=u(rt,2);g($e),g(fe),g(Z),g(W),K(()=>{Fe=ce(Be,1,"icon-btn svelte-1ibkqf6",null,Fe,{active:n(P)}),ye(ve,`transform: scale(${n(x)??""}) translate(${n(_)??""}px, ${n(R)??""}px)`),B=ce(Ye,1,"mode-btn svelte-1ibkqf6",null,B,{active:n(b)}),ne=ce(V,1,"mode-btn svelte-1ibkqf6",null,ne,{active:!n(b)})}),p("click",he,te),p("click",Pe,ue),p("mousedown",Be,()=>z(P,!0)),p("mouseup",Be,()=>z(P,!1)),p("mouseleave",Be,()=>z(P,!1)),p("touchstart",Be,()=>z(P,!0)),p("touchend",Be,()=>z(P,!1)),p("mousedown",ve,be),p("mousemove",ve,q),p("mouseup",ve,H),p("mouseleave",ve,oe),p("click",Ye,()=>z(b,!0)),p("click",V,()=>z(b,!1)),p("click",ae,Se),p("click",re,we),p("click",Me,Je),p("click",_e,()=>Ae("up")),p("click",ot,()=>Ae("down")),p("click",Ze,()=>Ae("left")),p("click",pt,()=>Ae("right")),p("click",rt,He),p("click",yt,U),p("click",Z,lt(function(Q){Kt.call(this,a,Q)})),p("click",W,He),L(i,W),Re()}var qi=F('<button class="processing-btn svelte-1wdmsm1" disabled><span class="spinner svelte-1wdmsm1"></span> </button> <button class="cancel-btn svelte-1wdmsm1">Cancel</button>',1),Oi=F('<button class="remove-btn svelte-1wdmsm1"><img src="/icons/icon-ai.svg" alt="" class="btn-icon svelte-1wdmsm1"/> Remove background</button> <p class="hint svelte-1wdmsm1">Remove image background with AI</p> <button class="erase-btn svelte-1wdmsm1"><img src="/icons/icon-erase.svg" alt="" class="btn-icon svelte-1wdmsm1"/> Erase and restore</button> <p class="hint svelte-1wdmsm1">Manually clean up background</p>',1),Ui=F('<div class="error-message svelte-1wdmsm1"> </div>'),Hi=F('<div class="background-controls svelte-1wdmsm1"><div class="controls-content svelte-1wdmsm1"><!> <!></div> <!></div>');function Wi(i,a){ze(a,!1);const e=()=>it(et,"$aiState",t),[t,o]=Rt(),r=N();let d=N(!1),s=N(""),c=N(null),v=N(!1);async function b(){if(e().originalImage)try{z(d,!0),z(c,null),z(s,"Starting..."),et.startProcessing("background");const k=await Ii(e().originalImage,P=>{z(s,P)});et.finishProcessing(k)}catch(k){z(c,k.message||"Background removal failed"),et.cancelProcessing()}finally{z(d,!1),z(s,"")}}function C(){z(d,!1),z(s,""),z(c,null),et.cancelProcessing()}function S(){z(v,!0)}function x(){z(v,!1)}Ne(()=>e(),()=>{z(r,e().showComparison&&e().processedImage)}),mt(),Ee();var _=Hi(),R=f(_),l=f(R);{var w=k=>{var P=qi(),j=Ge(P),X=u(f(j));g(j);var te=u(j,2);K(()=>Ue(X,` ${n(s)||"Processing..."}`)),p("click",te,C),L(k,P)},D=k=>{var P=Oi(),j=Ge(P),X=u(j,4);_t(2),K(()=>X.disabled=!n(r)),p("click",j,b),p("click",X,S),L(k,P)};ee(l,k=>{n(d)?k(w):k(D,!1)})}var E=u(l,2);{var T=k=>{var P=Ui(),j=f(P,!0);g(P),K(()=>Ue(j,n(c))),L(k,P)};ee(E,k=>{n(c)&&k(T)})}g(R);var M=u(R,2);{var I=k=>{Fi(k,{get image(){return e(),m(()=>e().processedImage)},get originalFullImage(){return e(),m(()=>e().originalImage)},onClose:x,onSave:P=>{et.finishProcessing(P),z(v,!1)}})};ee(M,k=>{n(v)&&k(I)})}g(_),L(i,_),Re(),o()}var ji=F('<img alt="Working image" class="working-image svelte-17agwu4"/>'),Ni=F('<!> <div class="image-container svelte-17agwu4"><!></div> <!> <!>',1),Yi=F('<div class="ai-tab svelte-17agwu4"><!></div>');function Xi(i,a){ze(a,!1);const e=()=>it(et,"$aiState",r),t=()=>it(yi,"$hasAiImage",r),o=()=>it(ya,"$activeAiMenu",r),[r,d]=Rt();let s=N(50);function c(D){z(s,D),et.setComparisonPosition(D)}const v=[{id:"upscale",label:"Upscale"},{id:"background",label:"Remove background"}];function b(D){et.setImage(D)}function C(D){ya.set(D)}async function S(){e().currentImage&&await $t(e().currentImage)}function x(){e().currentImage&&ea(e().currentImage,"picflam-ai.png")}Ee();var _=Yi(),R=f(_);{var l=D=>{La(D,{title:"Upscale and remove backgrounds using AI power",hint:"Import, drag or paste an image",onImageImport:b})},w=D=>{var E=Ni(),T=Ge(E);la(T,{canUndo:!1,canRedo:!1,onUndo:()=>{},onRedo:()=>{},onStartAgain:()=>et.reset(),onCopy:S,onExport:x});var M=u(T,2),I=f(M);{var k=le=>{xi(le,{get beforeImage(){return e().originalImage},get afterImage(){return e().processedImage},get position(){return n(s)},onChange:c})},P=le=>{var $=ji();K(()=>Ce($,"src",e().currentImage)),L(le,$)};ee(I,le=>{e().showComparison&&e().processedImage?le(k):le(P,!1)})}g(M);var j=u(M,2);sa(j,{get tabs(){return v},get activeTab(){return o()},onTabChange:C});var X=u(j,2);{var te=le=>{Ti(le,{})},ue=le=>{var $=ut(),be=Ge($);{var q=H=>{Wi(H,{})};ee(be,H=>{o()==="background"&&H(q)},!0)}L(le,$)};ee(X,le=>{o()==="upscale"?le(te):le(ue,!1)})}L(D,E)};ee(R,D=>{t()?D(w,!1):D(l)})}g(_),L(i,_),Re(),d()}var Gi=F('<div class="size-controls svelte-1l8e210"><!></div>');function Qi(i,a){ze(a,!1);let e=h(a,"canvasSize",8,"1/1"),t=h(a,"onSizeChange",8,c=>{});const o=[{id:"9/16",label:"9:16",icon:"icon-vertical"},{id:"1/1",label:"1:1",icon:"icon-square"},{id:"16/9",label:"16:9",icon:"icon-horizontal"}];function r(c){t()(c)}Ee();var d=Gi(),s=f(d);Aa(s,{get options(){return o},get value(){return e()},onChange:r,showLabels:!0,centered:!0}),g(d),L(i,d),Re()}var Vi=F("<button></button>"),Ji=F('<div class="color-picker-popover svelte-x97jji"><input type="color" class="svelte-x97jji"/></div>'),Zi=F('<button aria-label="Custom color"></button> <!>',1),Ki=F('<div class="color-swatches svelte-x97jji"><!> <!></div>');function zt(i,a){ze(a,!1);let e=h(a,"colors",24,()=>[]),t=h(a,"value",8,""),o=h(a,"onChange",8,S=>{}),r=h(a,"showRainbow",8,!0),d=N(!1),s=N("#5422b0");Ee();var c=Ki(),v=f(c);dt(v,1,e,ct,(S,x)=>{var _=Vi();let R;K(()=>{R=ce(_,1,"swatch svelte-x97jji",null,R,{active:t()===n(x),white:n(x)==="#FFFFFF"}),ye(_,`background-color: ${n(x)??""};`),Ce(_,"aria-label",`Select color ${n(x)??""}`)}),p("click",_,()=>o()(n(x))),L(S,_)});var b=u(v,2);{var C=S=>{var x=Zi(),_=Ge(x);let R;var l=u(_,2);{var w=D=>{var E=Ji(),T=f(E);Ft(T),g(E),Cn(T,()=>n(s),M=>z(s,M)),p("change",T,()=>o()(n(s))),L(D,E)};ee(l,D=>{n(d)&&D(w)})}K(D=>R=ce(_,1,"swatch rainbow svelte-x97jji",null,R,D),[()=>({active:!e().includes(t())&&t()!=="transparent"})]),p("click",_,()=>z(d,!n(d))),L(S,x)};ee(b,S=>{r()&&S(C)})}g(c),L(i,c),Re()}const It={solids:["#FFFFFF","#000000","#007C1F","#00679D","#B20715"],gradients:["linear-gradient(135deg, #5422b0 0%, #4B0082 100%)","linear-gradient(135deg, #15509B 0%, #20244F 100%)","linear-gradient(135deg, #A8076B 0%, #62045F 100%)","linear-gradient(135deg, #EA5C56 0%, #3C0C40 100%)","linear-gradient(135deg, #0A8F9D 0%, #202B54 100%)","linear-gradient(135deg, #D17A29 0%, #41363C 100%)"]},qa=["Inter","Roboto Slab","Saira Condensed","Lora","Playfair Display","Special Elite"],Dt={up:"to top",down:"to bottom",left:"to left",right:"to right"},$i={canvasSize:"1/1",background:{type:"solid",value:"#FFFFFF",direction:"down",gradientColors:["#5422b0","#4B0082"]},text1:"",text1Font:"Inter",text1Size:5,text1YPosition:3,text1LineSpacing:5,text1Color:"#000000",text1HighlightColor:"transparent",text1IsBold:!0,text1Align:"center",text1QuoteStyle:"none",text1QuoteSize:5,text2:"",text2Font:"Inter",text2Size:3,text2YPosition:8,text2LineSpacing:5,text2Color:"#000000",text2LabelColor:"transparent",text2IsBold:!1,text2Align:"center",overlay:null,overlaySize:50,overlayOpacity:100,overlayX:50,overlayY:50,overlayMask:"none",overlayWrap:!1,overlayBorderWidth:0,overlayBorderColor:"#FFFFFF",overlayNaturalWidth:0,overlayNaturalHeight:0};function eo(i){const a=[JSON.parse(JSON.stringify(i))];let e=0;const{subscribe:t,set:o,update:r}=ft(i);return{subscribe:t,set:d=>{a.splice(e+1),a.push(JSON.parse(JSON.stringify(d))),e=a.length-1,o(d)},update:d=>{r(s=>{const c=d(s);return a.splice(e+1),a.push(JSON.parse(JSON.stringify(c))),e=a.length-1,c})},undo:()=>e>0?(e--,o(JSON.parse(JSON.stringify(a[e]))),!0):!1,redo:()=>e<a.length-1?(e++,o(JSON.parse(JSON.stringify(a[e]))),!0):!1,canUndo:()=>e>0,canRedo:()=>e<a.length-1,reset:()=>{const d=JSON.parse(JSON.stringify(i));a.length=0,a.push(d),e=0,o(d)}}}const Qe=eo($i),aa=ft(!0),Ct=ft("none");ia(Qe,i=>i.text1||i.text2||i.overlay||i.background.value!=="#FFFFFF");function to(){Qe.reset(),aa.set(!0),Ct.set("none")}var ao=F('<button aria-label="Select gradient"></button>'),no=F('<div class="background-controls svelte-18tfgkp"><div class="section svelte-18tfgkp"><div class="color-row svelte-18tfgkp"><!></div></div> <div class="section svelte-18tfgkp"><div class="gradient-row svelte-18tfgkp"></div></div> <div class="section svelte-18tfgkp"><div class="gradient-preview-row svelte-18tfgkp"><button class="gradient-endpoint svelte-18tfgkp" aria-label="Edit start color"></button> <div class="gradient-preview svelte-18tfgkp"></div> <button class="gradient-endpoint svelte-18tfgkp" aria-label="Edit end color"></button></div></div> <div class="section svelte-18tfgkp"><div><button aria-label="Gradient direction up"><img src="/icons/icon-nudge-up.svg" alt="" class="direction-icon svelte-18tfgkp"/></button> <button aria-label="Gradient direction down"><img src="/icons/icon-nudge-down.svg" alt="" class="direction-icon svelte-18tfgkp"/></button> <button aria-label="Gradient direction left"><img src="/icons/icon-nudge-left.svg" alt="" class="direction-icon svelte-18tfgkp"/></button> <button aria-label="Gradient direction right"><img src="/icons/icon-nudge-right.svg" alt="" class="direction-icon svelte-18tfgkp"/></button></div></div></div>');function io(i,a){ze(a,!1);const e=N();let t=h(a,"background",24,()=>({type:"solid",value:"#FFFFFF",direction:"down",gradientColors:["#5422b0","#4B0082"]})),o=h(a,"onBackgroundChange",8,q=>{});const r=It.gradients.map(q=>{const H=q.match(/#[A-Fa-f0-9]{6}/g);return H?[H[0],H[1]]:["#5422b0","#4B0082"]});function d(q){o()({...t(),type:"solid",value:q})}function s(q){const H=r[q],oe=Dt[t().direction]||"to bottom";o()({...t(),type:"gradient",value:`linear-gradient(${oe}, ${H[0]} 0%, ${H[1]} 100%)`,gradientColors:H})}function c(q){const H=Dt[q],oe=t().gradientColors||["#5422b0","#4B0082"];o()({...t(),direction:q,value:`linear-gradient(${H}, ${oe[0]} 0%, ${oe[1]} 100%)`})}function v(q,H){const oe=[...t().gradientColors||["#5422b0","#4B0082"]];oe[q]=H;const ge=Dt[t().direction]||"to bottom";o()({...t(),type:"gradient",value:`linear-gradient(${ge}, ${oe[0]} 0%, ${oe[1]} 100%)`,gradientColors:oe})}Ne(()=>(Le(t()),Dt),()=>{z(e,t().type==="gradient"?`linear-gradient(${Dt[t().direction]||"to bottom"}, ${t().gradientColors?.[0]||"#5422b0"} 0%, ${t().gradientColors?.[1]||"#4B0082"} 100%)`:`linear-gradient(to bottom, ${r[0][0]} 0%, ${r[0][1]} 100%)`)}),mt(),Ee();var b=no(),C=f(b),S=f(C),x=f(S);{let q=st(()=>(Le(t()),m(()=>t().type==="solid"?t().value:"")));zt(x,{get colors(){return Le(It),m(()=>It.solids)},get value(){return n(q)},onChange:d,showRainbow:!0})}g(S),g(C);var _=u(C,2),R=f(_);dt(R,5,()=>r,ct,(q,H,oe)=>{var ge=ao();let Se;K(()=>{Se=ce(ge,1,"gradient-swatch svelte-18tfgkp",null,Se,{active:t().type==="gradient"&&t().gradientColors?.[0]===n(H)[0]&&t().gradientColors?.[1]===n(H)[1]}),ye(ge,`background: linear-gradient(135deg, ${n(H),m(()=>n(H)[0])??""} 0%, ${n(H),m(()=>n(H)[1])??""} 100%);`)}),p("click",ge,()=>s(oe)),L(q,ge)}),g(R),g(_);var l=u(_,2),w=f(l),D=f(w),E=u(D,2),T=u(E,2);g(w),g(l);var M=u(l,2),I=f(M);let k;var P=f(I);let j;var X=u(P,2);let te;var ue=u(X,2);let le;var $=u(ue,2);let be;g(I),g(M),g(b),K(()=>{ye(D,`background-color: ${Le(t()),m(()=>t().gradientColors?.[0]||"#5422b0")??""};`),ye(E,`background: ${n(e)??""};`),ye(T,`background-color: ${Le(t()),m(()=>t().gradientColors?.[1]||"#4B0082")??""};`),k=ce(I,1,"direction-row svelte-18tfgkp",null,k,{inactive:t().type!=="gradient"}),j=ce(P,1,"direction-btn svelte-18tfgkp",null,j,{active:t().direction==="up"}),te=ce(X,1,"direction-btn svelte-18tfgkp",null,te,{active:t().direction==="down"}),le=ce(ue,1,"direction-btn svelte-18tfgkp",null,le,{active:t().direction==="left"}),be=ce($,1,"direction-btn svelte-18tfgkp",null,be,{active:t().direction==="right"})}),p("click",D,()=>{const q=document.createElement("input");q.type="color",q.value=t().gradientColors?.[0]||"#5422b0",q.addEventListener("input",H=>v(0,H.target.value)),q.click()}),p("click",T,()=>{const q=document.createElement("input");q.type="color",q.value=t().gradientColors?.[1]||"#4B0082",q.addEventListener("input",H=>v(1,H.target.value)),q.click()}),p("click",P,()=>c("up")),p("click",X,()=>c("down")),p("click",ue,()=>c("left")),p("click",$,()=>c("right")),L(i,b),Re()}var oo=F("<button> </button>"),ro=F('<div class="font-dropdown-menu svelte-fspusj"></div>'),lo=F('<div class="text1-controls svelte-fspusj"><div class="text-input-container svelte-fspusj"><textarea class="text-input svelte-fspusj" placeholder="How to ==highlight== text"></textarea> <div class="resize-handle svelte-fspusj"></div></div> <div class="font-row svelte-fspusj"><span class="row-label svelte-fspusj">Font</span> <div class="font-dropdown-wrapper svelte-fspusj"><button class="font-dropdown-trigger svelte-fspusj"> <span class="dropdown-arrow svelte-fspusj">â¾</span></button> <!></div> <button aria-label="Bold"><img src="/icons/icon-bold.svg" alt="" class="btn-icon svelte-fspusj"/></button> <button class="icon-btn svelte-fspusj"><img alt="" class="btn-icon svelte-fspusj"/></button></div> <div class="slider-row svelte-fspusj"><!> <button class="reset-btn svelte-fspusj" aria-label="Reset size"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-fspusj"/></button></div> <div class="slider-row svelte-fspusj"><!> <button class="reset-btn svelte-fspusj" aria-label="Reset position"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-fspusj"/></button></div> <div class="slider-row svelte-fspusj"><!> <button class="reset-btn svelte-fspusj" aria-label="Reset line spacing"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-fspusj"/></button></div> <div class="color-section svelte-fspusj"><span class="section-label svelte-fspusj">Text colour</span> <!></div> <div class="color-section svelte-fspusj"><span class="section-label svelte-fspusj">Highlight colour</span> <!></div></div>');function so(i,a){ze(a,!1);let e=h(a,"text1",8,""),t=h(a,"text1Font",8,"Inter"),o=h(a,"text1Size",8,5),r=h(a,"text1YPosition",8,3),d=h(a,"text1LineSpacing",8,5),s=h(a,"text1Color",8,"#000000"),c=h(a,"text1HighlightColor",8,"transparent"),v=h(a,"text1IsBold",8,!0),b=h(a,"text1Align",8,"center"),C=h(a,"onChange",8,(O,qe)=>{});const S=It.solids,x=["#FFD700","#000000","#007C1F","#00679D","#B20715"],_=["left","center","right"],R={text1Size:5,text1YPosition:3,text1LineSpacing:5};let l=N(!1),w=N();function D(O){n(w)&&!n(w).contains(O.target)&&z(l,!1)}Bt(()=>{document.addEventListener("click",D)}),oa(()=>{document.removeEventListener("click",D)});function E(O){C()("text1",O.target.value)}function T(O){C()("text1Font",O),z(l,!1)}function M(){C()("text1IsBold",!v())}function I(){const qe=(_.indexOf(b())+1)%_.length;C()("text1Align",_[qe])}function k(O){C()("text1Color",O)}function P(O){C()("text1HighlightColor",O===c()?"transparent":O)}function j(O){C()(O,R[O])}Ee();var X=lo(),te=f(X),ue=f(te);Ta(ue),_t(2),g(te);var le=u(te,2),$=u(f(le),2),be=f($),q=f(be);_t(),g(be);var H=u(be,2);{var oe=O=>{var qe=ro();dt(qe,5,()=>qa,ct,(nt,Oe)=>{var Te=oo();let ie;var fe=f(Te,!0);g(Te),K(()=>{ie=ce(Te,1,"font-option svelte-fspusj",null,ie,{selected:t()===n(Oe)}),ye(Te,`font-family: '${n(Oe)??""}'`),Ue(fe,n(Oe)==="Inter"?"Inter (Default)":n(Oe))}),p("click",Te,()=>T(n(Oe))),L(nt,Te)}),g(qe),L(O,qe)};ee(H,O=>{n(l)&&O(oe)})}g($),ht($,O=>z(w,O),()=>n(w));var ge=u($,2);let Se;var we=u(ge,2),Je=f(we);g(we),g(le);var Ae=u(le,2),He=f(Ae);Ve(He,{label:"Size",min:1,max:10,get value(){return o()},onChange:O=>C()("text1Size",O)});var U=u(He,2);g(Ae);var W=u(Ae,2),Z=f(W);Ve(Z,{label:"Position",min:0,max:10,get value(){return r()},onChange:O=>C()("text1YPosition",O)});var de=u(Z,2);g(W);var he=u(W,2),Pe=f(he);Ve(Pe,{label:"Line spacing",min:1,max:10,get value(){return d()},onChange:O=>C()("text1LineSpacing",O)});var Be=u(Pe,2);g(he);var Fe=u(he,2),We=u(f(Fe),2);zt(We,{get colors(){return S},get value(){return s()},onChange:k,showRainbow:!0}),g(Fe);var ve=u(Fe,2),je=u(f(ve),2);zt(je,{get colors(){return x},get value(){return c()},onChange:P,showRainbow:!0}),g(ve),g(X),K(()=>{qt(ue,e()),ye(be,`font-family: '${t()??""}'`),Ue(q,`${(t()==="Inter"?"Inter (Default)":t())??""} `),Se=ce(ge,1,"icon-btn svelte-fspusj",null,Se,{active:v()}),Ce(we,"aria-label",`Align ${b()??""}`),Ce(Je,"src",`/icons/icon-align-${b()??""}.svg`)}),p("input",ue,E),p("click",be,()=>z(l,!n(l))),p("click",ge,M),p("click",we,I),p("click",U,()=>j("text1Size")),p("click",de,()=>j("text1YPosition")),p("click",Be,()=>j("text1LineSpacing")),L(i,X),Re()}var co=F("<button> </button>"),vo=F('<div class="font-dropdown-menu svelte-n6z268"></div>'),uo=F('<div class="text2-controls svelte-n6z268"><div class="text-input-container svelte-n6z268"><textarea class="text-input svelte-n6z268" placeholder="How to ==highlight== text"></textarea> <div class="resize-handle svelte-n6z268"></div></div> <div class="font-row svelte-n6z268"><span class="row-label svelte-n6z268">Font</span> <div class="font-dropdown-wrapper svelte-n6z268"><button class="font-dropdown-trigger svelte-n6z268"> <span class="dropdown-arrow svelte-n6z268">â¾</span></button> <!></div> <button aria-label="Bold"><img src="/icons/icon-bold.svg" alt="" class="btn-icon svelte-n6z268"/></button> <button class="icon-btn svelte-n6z268"><img alt="" class="btn-icon svelte-n6z268"/></button></div> <div class="slider-row svelte-n6z268"><!> <button class="reset-btn svelte-n6z268" aria-label="Reset size"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-n6z268"/></button></div> <div class="slider-row svelte-n6z268"><!> <button class="reset-btn svelte-n6z268" aria-label="Reset position"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-n6z268"/></button></div> <div class="slider-row svelte-n6z268"><!> <button class="reset-btn svelte-n6z268" aria-label="Reset line spacing"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-n6z268"/></button></div> <div class="color-section svelte-n6z268"><span class="section-label svelte-n6z268">Text colour</span> <!></div> <div class="color-section svelte-n6z268"><span class="section-label svelte-n6z268">Highlight colour</span> <!></div></div>');function go(i,a){ze(a,!1);let e=h(a,"text2",8,""),t=h(a,"text2Font",8,"Inter"),o=h(a,"text2Size",8,3),r=h(a,"text2YPosition",8,8),d=h(a,"text2LineSpacing",8,5),s=h(a,"text2Color",8,"#000000"),c=h(a,"text2LabelColor",8,"transparent"),v=h(a,"text2IsBold",8,!1),b=h(a,"text2Align",8,"center"),C=h(a,"onChange",8,(O,qe)=>{});const S=It.solids,x=["#FFD700","#000000","#007C1F","#00679D","#B20715"],_=["left","center","right"],R={text2Size:3,text2YPosition:8,text2LineSpacing:5};let l=N(!1),w=N();function D(O){n(w)&&!n(w).contains(O.target)&&z(l,!1)}Bt(()=>{document.addEventListener("click",D)}),oa(()=>{document.removeEventListener("click",D)});function E(O){C()("text2",O.target.value)}function T(O){C()("text2Font",O),z(l,!1)}function M(){C()("text2IsBold",!v())}function I(){const qe=(_.indexOf(b())+1)%_.length;C()("text2Align",_[qe])}function k(O){C()("text2Color",O)}function P(O){C()("text2LabelColor",O===c()?"transparent":O)}function j(O){C()(O,R[O])}Ee();var X=uo(),te=f(X),ue=f(te);Ta(ue),_t(2),g(te);var le=u(te,2),$=u(f(le),2),be=f($),q=f(be);_t(),g(be);var H=u(be,2);{var oe=O=>{var qe=vo();dt(qe,5,()=>qa,ct,(nt,Oe)=>{var Te=co();let ie;var fe=f(Te,!0);g(Te),K(()=>{ie=ce(Te,1,"font-option svelte-n6z268",null,ie,{selected:t()===n(Oe)}),ye(Te,`font-family: '${n(Oe)??""}'`),Ue(fe,n(Oe)==="Inter"?"Inter (Default)":n(Oe))}),p("click",Te,()=>T(n(Oe))),L(nt,Te)}),g(qe),L(O,qe)};ee(H,O=>{n(l)&&O(oe)})}g($),ht($,O=>z(w,O),()=>n(w));var ge=u($,2);let Se;var we=u(ge,2),Je=f(we);g(we),g(le);var Ae=u(le,2),He=f(Ae);Ve(He,{label:"Size",min:1,max:10,get value(){return o()},onChange:O=>C()("text2Size",O)});var U=u(He,2);g(Ae);var W=u(Ae,2),Z=f(W);Ve(Z,{label:"Position",min:0,max:10,get value(){return r()},onChange:O=>C()("text2YPosition",O)});var de=u(Z,2);g(W);var he=u(W,2),Pe=f(he);Ve(Pe,{label:"Line spacing",min:1,max:10,get value(){return d()},onChange:O=>C()("text2LineSpacing",O)});var Be=u(Pe,2);g(he);var Fe=u(he,2),We=u(f(Fe),2);zt(We,{get colors(){return S},get value(){return s()},onChange:k,showRainbow:!0}),g(Fe);var ve=u(Fe,2),je=u(f(ve),2);zt(je,{get colors(){return x},get value(){return c()},onChange:P,showRainbow:!0}),g(ve),g(X),K(()=>{qt(ue,e()),ye(be,`font-family: '${t()??""}'`),Ue(q,`${(t()==="Inter"?"Inter (Default)":t())??""} `),Se=ce(ge,1,"icon-btn svelte-n6z268",null,Se,{active:v()}),Ce(we,"aria-label",`Align ${b()??""}`),Ce(Je,"src",`/icons/icon-align-${b()??""}.svg`)}),p("input",ue,E),p("click",be,()=>z(l,!n(l))),p("click",ge,M),p("click",we,I),p("click",U,()=>j("text2Size")),p("click",de,()=>j("text2YPosition")),p("click",Be,()=>j("text2LineSpacing")),L(i,X),Re()}var ho=F('<button><img alt="" class="style-icon svelte-4vqdnp"/></button>'),fo=F('<div class="quote-controls svelte-4vqdnp"><div class="style-row svelte-4vqdnp"></div> <div><!> <button class="reset-btn svelte-4vqdnp" aria-label="Reset size"><img src="/icons/icon-reset.svg" alt="" class="reset-icon svelte-4vqdnp"/></button></div></div>');function bo(i,a){ze(a,!1);let e=h(a,"quoteStyle",8,"none"),t=h(a,"quoteSize",8,5),o=h(a,"onChange",8,(R,l)=>{});const r=[{id:"none",icon:"/icons/icon-none.svg",label:"No quote"},{id:"serif",icon:"/icons/icon-quote-serif.svg",label:"Serif quote"},{id:"slab",icon:"/icons/icon-quote-slab.svg",label:"Slab quote"}],d={quoteSize:5};function s(R){o()("text1QuoteStyle",R)}function c(R){o()("text1QuoteSize",d[R])}Ee();var v=fo(),b=f(v);dt(b,5,()=>r,ct,(R,l)=>{var w=ho();let D;var E=f(w);g(w),K(()=>{D=ce(w,1,"style-btn svelte-4vqdnp",null,D,{active:e()===n(l).id,"is-none":n(l).id==="none"}),Ce(w,"aria-label",(n(l),m(()=>n(l).label))),Ce(E,"src",(n(l),m(()=>n(l).icon)))}),p("click",w,()=>s(n(l).id)),L(R,w)}),g(b);var C=u(b,2);let S;var x=f(C);Ve(x,{label:"Size",min:1,max:10,get value(){return t()},onChange:R=>e()!=="none"&&o()("text1QuoteSize",R)});var _=u(x,2);g(C),g(v),K(()=>{S=ce(C,1,"slider-row svelte-4vqdnp",null,S,{disabled:e()==="none"}),_.disabled=e()==="none"}),p("click",_,()=>c("quoteSize")),L(i,v),Re()}var mo=F('<div class="import-box svelte-qirtgp" role="button" tabindex="0"><label class="import-area svelte-qirtgp"><input type="file" accept="image/*" class="file-input svelte-qirtgp"/> <img src="/icons/icon-upload.svg" alt="" class="upload-icon svelte-qirtgp"/> <span class="import-text svelte-qirtgp">Import, drag or<br/>paste an image</span></label> <button class="paste-btn svelte-qirtgp">Paste</button></div>'),po=F('<div class="slider-row svelte-qirtgp"><!></div> <div class="slider-row svelte-qirtgp"><!></div> <div class="mask-row svelte-qirtgp"><span class="row-label svelte-qirtgp">Mask</span> <div class="mask-buttons svelte-qirtgp"><button aria-label="No mask"><img src="/icons/icon-none.svg" alt="" class="mask-icon svelte-qirtgp"/></button> <button aria-label="Rounded mask"><img src="/icons/icon-square.svg" alt="" class="mask-icon svelte-qirtgp"/></button> <button aria-label="Circle mask"><div class="circle-icon svelte-qirtgp"></div></button></div> <span class="row-label wrap-label svelte-qirtgp">Text wrap</span> <div class="wrap-buttons svelte-qirtgp"><button aria-label="Text wrap on"><img src="/icons/icon-wrap.svg" alt="" class="wrap-icon svelte-qirtgp"/></button> <button aria-label="Text wrap off"><img src="/icons/icon-no-wrap.svg" alt="" class="wrap-icon svelte-qirtgp"/></button></div></div> <div class="slider-row svelte-qirtgp"><!></div> <div class="color-section svelte-qirtgp"><span class="section-label svelte-qirtgp">Border colour</span> <!></div>',1),wo=F('<div class="overlay-controls svelte-qirtgp"><!></div>');function xo(i,a){ze(a,!1);let e=h(a,"overlay",8,null),t=h(a,"overlaySize",8,50),o=h(a,"overlayOpacity",8,100),r=h(a,"overlayMask",8,"none"),d=h(a,"overlayWrap",8,!1),s=h(a,"overlayBorderWidth",8,0),c=h(a,"overlayBorderColor",8,"#FFFFFF"),v=h(a,"onChange",8,(M,I)=>{});const b=It.solids,C=[0,1,2,3];function S(M){const I=M.target.files?.[0];if(I&&I.type.startsWith("image/")){const k=new FileReader;k.onload=P=>{v()("overlay",P.target.result)},k.readAsDataURL(I)}M.target.value=""}function x(M){M.preventDefault();const I=M.dataTransfer?.files?.[0];if(I&&I.type.startsWith("image/")){const k=new FileReader;k.onload=P=>{v()("overlay",P.target.result)},k.readAsDataURL(I)}}function _(M){M.preventDefault()}async function R(){try{const M=await navigator.clipboard.read();for(const I of M){const k=I.types.find(P=>P.startsWith("image/"));if(k){const P=await I.getType(k),j=new FileReader;j.onload=X=>{v()("overlay",X.target.result)},j.readAsDataURL(P);return}}}catch(M){console.error("Paste failed:",M)}}function l(M){const I=C.reduce((k,P)=>Math.abs(P-M)<Math.abs(k-M)?P:k);v()("overlayBorderWidth",I)}Ee();var w=wo(),D=f(w);{var E=M=>{var I=mo(),k=f(I),P=f(k);_t(4),g(k);var j=u(k,2);g(I),p("change",P,S),p("click",j,R),p("drop",I,x),p("dragover",I,_),L(M,I)},T=M=>{var I=po(),k=Ge(I),P=f(k);Ve(P,{label:"Size",min:10,max:100,get value(){return t()},onChange:de=>v()("overlaySize",de)}),g(k);var j=u(k,2),X=f(j);Ve(X,{label:"Opacity",min:0,max:100,get value(){return o()},onChange:de=>v()("overlayOpacity",de)}),g(j);var te=u(j,2),ue=u(f(te),2),le=f(ue);let $;var be=u(le,2);let q;var H=u(be,2);let oe;g(ue);var ge=u(ue,4),Se=f(ge);let we;var Je=u(Se,2);let Ae;g(ge),g(te);var He=u(te,2),U=f(He);Ve(U,{label:"Border width",min:0,max:3,step:1,get value(){return s()},onChange:l}),g(He);var W=u(He,2),Z=u(f(W),2);zt(Z,{get colors(){return b},get value(){return c()},onChange:de=>v()("overlayBorderColor",de),showRainbow:!0}),g(W),K(()=>{$=ce(le,1,"mask-btn svelte-qirtgp",null,$,{active:r()==="none"}),q=ce(be,1,"mask-btn svelte-qirtgp",null,q,{active:r()==="rounded"}),oe=ce(H,1,"mask-btn svelte-qirtgp",null,oe,{active:r()==="circle"}),we=ce(Se,1,"wrap-btn svelte-qirtgp",null,we,{active:d()}),Ae=ce(Je,1,"wrap-btn svelte-qirtgp",null,Ae,{active:!d()})}),p("click",le,()=>v()("overlayMask","none")),p("click",be,()=>v()("overlayMask","rounded")),p("click",H,()=>v()("overlayMask","circle")),p("click",Se,()=>v()("overlayWrap",!0)),p("click",Je,()=>v()("overlayWrap",!1)),L(M,I)};ee(D,M=>{e()?M(T,!1):M(E)})}g(w),L(i,w),Re()}var _o=F('<button class="template-card svelte-fxk5n4"><div class="template-placeholder svelte-fxk5n4"> </div></button>'),yo=F('<div class="template-picker svelte-fxk5n4"><p class="picker-title svelte-fxk5n4">Create quotes and cards. Start with a template or blank canvas</p> <button class="blank-canvas-btn svelte-fxk5n4"><img src="/icons/icon-add.svg" alt="" class="add-icon svelte-fxk5n4"/></button> <div class="template-grid svelte-fxk5n4"></div></div>'),Co=F('<div class="canvas-quote svelte-fxk5n4">&#8220;</div>'),ko=F('<div class="text1-wrapper svelte-fxk5n4"><!> <div class="canvas-text text1 svelte-fxk5n4"><!></div></div>'),So=F('<div class="canvas-text text2 svelte-fxk5n4"><!></div>'),Io=F('<div role="button" tabindex="0"><div class="overlay-bounding-box svelte-fxk5n4"><button class="delete-btn svelte-fxk5n4" aria-label="Delete overlay"><img src="/icons/icon-close.svg" alt="" class="delete-icon svelte-fxk5n4"/></button> <div><img alt="Overlay" class="overlay-image svelte-fxk5n4" draggable="false"/></div></div></div>'),zo=F('<!> <div class="canvas-container svelte-fxk5n4"><div class="design-canvas svelte-fxk5n4" role="button" tabindex="0"><!> <!> <!></div></div> <!> <div class="controls-panel svelte-fxk5n4"><!></div>',1),Ro=F('<div class="design-tab svelte-fxk5n4"><!></div>');function Bo(i,a){ze(a,!1);const e=()=>it(Ct,"$activeDesignMenu",r),t=()=>it(Qe,"$slideState",r),o=()=>it(aa,"$showTemplatePicker",r),[r,d]=Rt(),s=N(),c=N();let v=N(),b=N(300),C=300,S=300,x,_=!1,R=0,l=0,w=0,D=0;Bt(()=>{n(v)&&(x=new ResizeObserver(([U])=>{const{width:W,height:Z}=U.contentRect;C=W,S=Z,z(b,Math.min(W,Z))}),x.observe(n(v)))}),oa(()=>{x&&x.disconnect()});const E=[{id:"size",label:"Size"},{id:"background",label:"Background"},{id:"text1",label:"Text 1"},{id:"text2",label:"Text 2"},{id:"quote",label:"Quote"},{id:"overlay",label:"Overlay"}];function T(U){U==="blank"&&Qe.reset(),aa.set(!1)}function M(U){Ct.set(e()===U?"none":U)}async function I(){}function k(){}function P(U){Qe.update(W=>({...W,canvasSize:U}))}function j(U){Qe.update(W=>({...W,background:U}))}function X(U,W){Qe.update(Z=>({...Z,[U]:W}))}function te(U,W){Qe.update(Z=>({...Z,[U]:W}))}function ue(U,W){Qe.update(Z=>({...Z,[U]:W}))}function le(U,W){if(U==="overlay"&&W){const Z=new Image;Z.onload=()=>{Qe.update(de=>({...de,overlay:W,overlayNaturalWidth:Z.naturalWidth,overlayNaturalHeight:Z.naturalHeight,overlayX:50,overlayY:50}))},Z.src=W}else Qe.update(Z=>({...Z,[U]:W}))}function $(){Qe.update(U=>({...U,overlay:null,overlayNaturalWidth:0,overlayNaturalHeight:0}))}function be(U){if(U.target.closest(".delete-btn"))return;U.preventDefault(),_=!0;const W=U.touches?.[0]||U;R=W.clientX,l=W.clientY,w=t().overlayX,D=t().overlayY,window.addEventListener("mousemove",q),window.addEventListener("mouseup",H),window.addEventListener("touchmove",q,{passive:!1}),window.addEventListener("touchend",H)}function q(U){if(!_)return;U.preventDefault();const W=U.touches?.[0]||U,Z=W.clientX-R,de=W.clientY-l,he=Z/C*100,Pe=de/S*100,Be=Math.max(0,Math.min(100,w+he)),Fe=Math.max(0,Math.min(100,D+Pe));Qe.update(We=>({...We,overlayX:Be,overlayY:Fe}))}function H(){_=!1,window.removeEventListener("mousemove",q),window.removeEventListener("mouseup",H),window.removeEventListener("touchmove",q),window.removeEventListener("touchend",H)}function oe(U){const W=U.target;W.closest(".overlay-wrapper")?Ct.set("overlay"):W.closest(".text1-wrapper")?Ct.set("text1"):W.closest(".canvas-text.text2")?Ct.set("text2"):W.closest(".canvas-quote")&&Ct.set("quote")}function ge(U){if(!U.overlay||!U.overlayNaturalWidth)return null;const W=U.overlayNaturalWidth/U.overlayNaturalHeight,Z=U.overlaySize/100*100;let de,he;return W>=1?(de=Z,he=Z/W):(he=Z,de=Z*W),{width:de,height:he}}function Se(U,W){if(!U.overlayWrap||!U.overlay||!W)return"";const Z=8,de=U.overlayX-W.width/2,he=U.overlayX+W.width/2;return he>50?`padding-right: ${100-de+Z}%;`:de<50?`padding-left: ${he+Z}%;`:""}Ne(()=>t(),()=>{z(s,ge(t()))}),Ne(()=>(t(),n(s)),()=>{z(c,Se(t(),n(s)))}),mt(),Ee();var we=Ro(),Je=f(we);{var Ae=U=>{var W=yo(),Z=u(f(W),2),de=u(Z,2);dt(de,4,()=>[1,2,3,4,5,6],ct,(he,Pe)=>{var Be=_o(),Fe=f(Be),We=f(Fe);g(Fe),g(Be),K(()=>Ue(We,`Template ${Pe??""}`)),p("click",Be,()=>T(`template-${Pe}`)),L(he,Be)}),g(de),g(W),p("click",Z,()=>T("blank")),L(U,W)},He=U=>{var W=zo(),Z=Ge(W);{let ie=st(()=>(Le(Qe),m(()=>Qe.canUndo()))),fe=st(()=>(Le(Qe),m(()=>Qe.canRedo())));la(Z,{get canUndo(){return n(ie)},get canRedo(){return n(fe)},onUndo:()=>Qe.undo(),onRedo:()=>Qe.redo(),get onStartAgain(){return to},onCopy:I,onExport:k})}var de=u(Z,2),he=f(de),Pe=f(he);{var Be=ie=>{var fe=ko(),Xe=f(fe);{var Ye=ne=>{var Y=Co();K(()=>ye(Y,`
									font-family: ${t(),m(()=>t().text1QuoteStyle==="serif"?'"Playfair Display", serif':'"Alfa Slab One", cursive')??""};
									font-size: ${n(b),t(),m(()=>n(b)*.08*t().text1QuoteSize)??""}px;
									font-weight: ${t(),m(()=>t().text1QuoteStyle==="serif"?"bold":"normal")??""};
									color: ${t(),m(()=>t().text1Color)??""};
									--quote-gap: ${t(),m(()=>(1+t().text1LineSpacing*.1)*t().text1Size*.5*(t().text1QuoteStyle==="slab"?.35:.4))??""}em;
								`)),L(ne,Y)};ee(Xe,ne=>{t(),m(()=>t().text1QuoteStyle!=="none")&&ne(Ye)})}var B=u(Xe,2),V=f(B);fa(V,()=>(t(),m(()=>t().text1.replace(/==(.+?)==/g,`<span style="color: ${t().text1HighlightColor};">$1</span>`).replace(/\n/g,"<br>")))),g(B),g(fe),K(()=>{ye(fe,`top: ${t(),m(()=>t().text1YPosition*10)??""}%; ${n(c)??""}`),ye(B,`
								font-family: '${t(),m(()=>t().text1Font)??""}';
								font-size: ${t(),m(()=>t().text1Size*.5)??""}em;
								font-weight: ${t(),m(()=>t().text1IsBold?"bold":"normal")??""};
								color: ${t(),m(()=>t().text1Color)??""};
								text-align: ${t(),m(()=>t().text1Align)??""};
								line-height: ${t(),m(()=>1+t().text1LineSpacing*.1)??""};
							`)}),L(ie,fe)};ee(Pe,ie=>{t(),m(()=>t().text1)&&ie(Be)})}var Fe=u(Pe,2);{var We=ie=>{var fe=So(),Xe=f(fe);fa(Xe,()=>(t(),m(()=>t().text2.replace(/==(.+?)==/g,`<span style="color: ${t().text2LabelColor};">$1</span>`).replace(/\n/g,"<br>")))),g(fe),K(()=>ye(fe,`
							font-family: '${t(),m(()=>t().text2Font)??""}';
							font-size: ${t(),m(()=>t().text2Size*.5)??""}em;
							font-weight: ${t(),m(()=>t().text2IsBold?"bold":"normal")??""};
							color: ${t(),m(()=>t().text2Color)??""};
							text-align: ${t(),m(()=>t().text2Align)??""};
							top: ${t(),m(()=>t().text2YPosition*10)??""}%;
							line-height: ${t(),m(()=>1+t().text2LineSpacing*.1)??""};
							${n(c)??""}
						`)),L(ie,fe)};ee(Fe,ie=>{t(),m(()=>t().text2)&&ie(We)})}var ve=u(Fe,2);{var je=ie=>{var fe=Io();let Xe;var Ye=f(fe),B=f(Ye),V=u(B,2);let ne;var Y=f(V);g(V),g(Ye),g(fe),K(()=>{Xe=ce(fe,1,"overlay-wrapper svelte-fxk5n4",null,Xe,{active:e()==="overlay"}),ye(fe,`
							left: ${t(),m(()=>t().overlayX)??""}%;
							top: ${t(),m(()=>t().overlayY)??""}%;
							width: ${n(s),m(()=>n(s).width)??""}%;
							opacity: ${t(),m(()=>t().overlayOpacity/100)??""};
						`),ye(Ye,`
								border-width: ${t(),m(()=>t().overlayBorderWidth*2)??""}px;
								border-color: ${t(),m(()=>t().overlayBorderColor)??""};
							`),ne=ce(V,1,"overlay-image-container svelte-fxk5n4",null,ne,{"mask-rounded":t().overlayMask==="rounded","mask-circle":t().overlayMask==="circle"}),Ce(Y,"src",(t(),m(()=>t().overlay)))}),p("click",B,$),p("mousedown",fe,be),p("touchstart",fe,be),L(ie,fe)};ee(ve,ie=>{t(),n(s),m(()=>t().overlay&&n(s))&&ie(je)})}g(he),ht(he,ie=>z(v,ie),()=>n(v)),g(de);var O=u(de,2);sa(O,{get tabs(){return E},get activeTab(){return e()},onTabChange:M});var qe=u(O,2),nt=f(qe);{var Oe=ie=>{Qi(ie,{get canvasSize(){return t(),m(()=>t().canvasSize)},onSizeChange:P})},Te=ie=>{var fe=ut(),Xe=Ge(fe);{var Ye=V=>{io(V,{get background(){return t(),m(()=>t().background)},onBackgroundChange:j})},B=V=>{var ne=ut(),Y=Ge(ne);{var me=ae=>{so(ae,{get text1(){return t(),m(()=>t().text1)},get text1Font(){return t(),m(()=>t().text1Font)},get text1Size(){return t(),m(()=>t().text1Size)},get text1YPosition(){return t(),m(()=>t().text1YPosition)},get text1LineSpacing(){return t(),m(()=>t().text1LineSpacing)},get text1Color(){return t(),m(()=>t().text1Color)},get text1HighlightColor(){return t(),m(()=>t().text1HighlightColor)},get text1IsBold(){return t(),m(()=>t().text1IsBold)},get text1Align(){return t(),m(()=>t().text1Align)},onChange:X})},De=ae=>{var y=ut(),A=Ge(y);{var J=G=>{go(G,{get text2(){return t(),m(()=>t().text2)},get text2Font(){return t(),m(()=>t().text2Font)},get text2Size(){return t(),m(()=>t().text2Size)},get text2YPosition(){return t(),m(()=>t().text2YPosition)},get text2LineSpacing(){return t(),m(()=>t().text2LineSpacing)},get text2Color(){return t(),m(()=>t().text2Color)},get text2LabelColor(){return t(),m(()=>t().text2LabelColor)},get text2IsBold(){return t(),m(()=>t().text2IsBold)},get text2Align(){return t(),m(()=>t().text2Align)},onChange:te})},re=G=>{var xe=ut(),ke=Ge(xe);{var Me=_e=>{bo(_e,{get quoteStyle(){return t(),m(()=>t().text1QuoteStyle)},get quoteSize(){return t(),m(()=>t().text1QuoteSize)},onChange:ue})},Ie=_e=>{var ot=ut(),Ze=Ge(ot);{var pt=$e=>{xo($e,{get overlay(){return t(),m(()=>t().overlay)},get overlaySize(){return t(),m(()=>t().overlaySize)},get overlayOpacity(){return t(),m(()=>t().overlayOpacity)},get overlayMask(){return t(),m(()=>t().overlayMask)},get overlayWrap(){return t(),m(()=>t().overlayWrap)},get overlayBorderWidth(){return t(),m(()=>t().overlayBorderWidth)},get overlayBorderColor(){return t(),m(()=>t().overlayBorderColor)},onChange:le,onDelete:$})};ee(Ze,$e=>{e()==="overlay"&&$e(pt)},!0)}L(_e,ot)};ee(ke,_e=>{e()==="quote"?_e(Me):_e(Ie,!1)},!0)}L(G,xe)};ee(A,G=>{e()==="text2"?G(J):G(re,!1)},!0)}L(ae,y)};ee(Y,ae=>{e()==="text1"?ae(me):ae(De,!1)},!0)}L(V,ne)};ee(Xe,V=>{e()==="background"?V(Ye):V(B,!1)},!0)}L(ie,fe)};ee(nt,ie=>{e()==="size"?ie(Oe):ie(Te,!1)})}g(qe),K(()=>ye(he,`
					aspect-ratio: ${t(),m(()=>t().canvasSize)??""};
					background: ${t(),m(()=>(t().background.type==="solid",t().background.value))??""};
				`)),p("click",he,oe),p("keydown",he,ie=>ie.key==="Enter"&&oe(ie)),L(U,W)};ee(Je,U=>{o()?U(Ae):U(He,!1)})}g(we),L(i,we),Re(),d()}const Qt=ft("crop");var Eo=F('<!> <main class="main svelte-1uha8ag"><!></main> <!>',1);function qo(i,a){ze(a,!1);const e=()=>it(Qt,"$activeTab",o),t=()=>it(se,"$cropState",o),[o,r]=Rt();let d=N(!1),s=null;function c(E){if(e()==="crop"&&t().cropPending&&E!=="crop"){s=E,z(d,!0);return}Qt.set(E)}async function v(){z(d,!1);const E=t();if(E.currentImage&&E.cropPending){const T=await Ma(E.currentImage,E.cropBox,E.imageWidth,E.imageHeight),M=await Ht(T);se.set({...E,currentImage:T,imageWidth:M.width,imageHeight:M.height,cropBox:{x:0,y:0,width:100,height:100},cropPending:!1,isCropping:!1})}s&&(Qt.set(s),s=null)}function b(){z(d,!1),s=null}Ee();var C=Eo(),S=Ge(C);Sn(S,{get activeTab(){return e()},onTabChange:c});var x=u(S,2),_=f(x);{var R=E=>{pi(E,{})},l=E=>{var T=ut(),M=Ge(T);{var I=P=>{Xi(P,{})},k=P=>{var j=ut(),X=Ge(j);{var te=ue=>{Bo(ue,{})};ee(X,ue=>{e()==="design"&&ue(te)},!0)}L(P,j)};ee(M,P=>{e()==="ai"?P(I):P(k,!1)},!0)}L(E,T)};ee(_,E=>{e()==="crop"?E(R):E(l,!1)})}g(x);var w=u(x,2);{var D=E=>{ta(E,{message:"Save changes?",confirmText:"Yes",cancelText:"Cancel",onConfirm:v,onCancel:b})};ee(w,E=>{n(d)&&E(D)})}L(i,C),Re(),r()}export{qo as component};
